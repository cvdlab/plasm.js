/*Domain*/

var domain1 = INTERVALS(1)(35);
var domain2 = DOMAIN([[0,1],[0,1]])([35,35]);
var domain3 = DOMAIN([[0,1],[0,1],[0,1]])([15,15,1]);
var domainCircle = DOMAIN([[0,1],[0,2*PI]])([15,15]);
var domain1S = INTERVALS(1)(5);


/*Color*/

var mattLightYellow = [255/255, 215/255, 0,1]; 
var mattGold = [218/255, 165/255, 32/255,1];
var mattBurgundy = [139/255, 0, 0, 1];
var mattCoralRed = [240/255,128/255, 128/255, 1];
var mattIndianRed = [205/255, 92/255, 92/255, 1];
var mattOrange = [255/255, 165/255, 0, 1];
var mattDarkOrange = [255/255, 140/255, 0, 1];
var mattForestGreen = [34/255, 139/255, 34/255, 1];
var mattLimeGreen = [50/255, 205/255, 50/255, 1];
var mattAquamarine = [127/255, 255/255, 212/255,1]; 
var mattLightSeaGreen = [32/255, 178/255, 170/255,1];
var mattDarkOrchid = [153/255, 50/255, 204/255, 1];
var mattDarkSeaGreen =[143/255, 188/255, 143/255, 0.8];
var mattLightSeaGreen = [32/255, 178/255, 170/255,1];
var mattSteelBlue = [70/255,130/255, 180/255,1];
var mattSkyBlue =[135/255, 206/255, 235/255,1];
var mattBurlywood = [255/255, 218/255, 185/255, 1];
var mattBisque = [255/255, 218/255, 185/255, 1];

/* This function creates an array of knots used by the function nubs. The function takes as input an array of control points. It returns an array of knots. 

   INPUT - An array of points

   OUTPUT - An array of knots.

*/

function knots (point) {
  var k = 2; 
  var m =point.length;
  var n = (m + k + 1);
  var first = 1;
  var last = n - 3;

  var knots = [];

  for (var i = 0; i < 3; i++) {
     knots[i] = 0;
    };

  for (var i = 3; i < last; i++,first++) {
     knots[i] = first;

    };

  for (var i = last; i < n; i++) {
     knots[i] = first;
    };

  return knots;
};

/* This function creates a curve with the function Nubs. The function takes as input an array of control points. It returns to the curve. 

   INPUT - An array of points
   
   OUTPUT - A curve built with the function NUBS

*/

function createNubs (point) {
  
  var knots1 = knots(point);
  var c1 = NUBS(S0)(2)(knots1)(point);
  //var c1Map = MAP(c1)(domain1)
  //DRAW(c1Map)
    return c1;
}

/* This function creates a Bezier curve. The function takes as input an array of curves. It returns to the Bezier curve. 

   INPUT - An array of curves

   OUTPUT - A Bezier curve

*/

function createBezierS1(curves) {
  var b1 = BEZIER(S1)(curves);
  //var b1Map = MAP(b1)(domain2);
  //DRAW(b1Map)
  return b1;
}

/* This function creates a Bezier curve. The function takes as input an array of curves and a color. It returns to the drawing of curves. 

   INPUT - An array of curves and a color

*/

function createBezierS2 (curves, color) {
  var b1 = BEZIER(S2)(curves);
  var b1Map = MAP(b1)(domain3);
  return DRAW(COLOR(color)(b1Map));
}

/* This function takes an array as input and reverses it. It returns the reversed array. */

function reverseR(array) {
  var arrayReturn = [];
  var j = 0;
  for(var i = array.length-1; i>=0; i--) {
        
        arrayReturn[j] = array[i];
        j++;
  }
  return arrayReturn;
}

/* This function modifies the third element in an array. It takes in input an array of points and a quantity z. It returns to the modified array. 
 
   INPUT - An array of control points and a quatity z.

   OUTPUT - A modified array. 

*/

function modifyZ(points, z) {
  var pointsNew = [];
  pointsNew[0]=points[0];
  pointsNew[1] = points[1];
  pointsNew[2] = points[2]+z;
  return pointsNew;
}

/* This function creates a new array of control points that are modified. It takes in input and array of control points and a breadth. It returns the modified array.
 
   INPUT - An array of control points and a breadth.

   OUTPUT - A modified array. 

*/

function createControls(controls, breadth) {
  var controlsRet = [];
    controlsRet[0] = controls[0];
    controlsRet[1] = modifyZ(controls[1], breadth)
    controlsRet[2] = modifyZ(controls[2], breadth)
    controlsRet[3] = controls[3];
    return controlsRet; 
}

/* This function creates a Bezier curve. It takes in input an initial point, a final point and an array of points. It returns the Bezier curve. 
 
   INPUT - An initial point, a final point and an array of points.

   OUTPUT - A Bezier curve. 

*/

function createCurveSurface(pointStart, pointFinal, points) {
  var nubs = [];
  nubs.push(pointStart);
  var j = 1;
  for(var i=0; i<points.length; i++) {
      nubs[j] = createNubs(points[i]);
      DRAW(nubs[j]);
      j++;
  }
  nubs.push(pointFinal);

  return createBezierS1(nubs);
    }

/* This function creates a Bezier curve. It takes in input a final point and an array of points. It returns the Bezier curve. 
 
   INPUT - A final point and an array of points.

   OUTPUT - A Bezier curve. 

*/

  function createCurveSurface2(pointFinal, points) {
  var nubs = [];
 
  var j = 0;
  for(var i=0; i<points.length; i++) {
      nubs[j] = createNubs(points[i]);
      DRAW(nubs[j]);
      j++;
  }
  nubs.push(pointFinal);
  return createBezierS1(nubs);
    }

/* This function reverses the order of an array of points. It takes in input an array of control points. It returns to the modified array. 
 
   INPUT - An array of control points.

   OUTPUT - A modified array. 

*/

function reticulumTransformation(controls) {
  var arr = [];
    for(var i=0; i<controls.length; i++) {
    for(var j=0; j<3; j++) {
        var arr2 = [];
        arr2[j+2] = -(controls[i][j]);
        arr2[j+1] = controls[i][j+1];
        arr2[j] = controls[i][j+2];
        j+=3;
        arr.push(arr2);
       
    }
     
  }
  return arr;
}


/* This function translates an array of points. It takes in input an array of control points and three breadths for each coordinate of the Cartesian Plane. It returns to the modified array. 
 
   INPUT - An array of control points and three breadths.

   OUTPUT - A modified array. 

*/

function controlsPointTranslation(controls, dx, dy, dz) {
  var arr = [];
    for(var i=0; i<controls.length; i++) {
    for(var j=0; j<3; j++) {
        var arr2 = [];
        arr2[j] = controls[i][j]+dx;
        arr2[j+1] = controls[i][j+1]+dy;
        arr2[j+2] = controls[i][j+2]+dz;
        j+=3;
        arr.push(arr2);
       
    }
     
  }
  return arr;
}

/* This function modifies an array of points. It takes in input an array of control points. It returns to the modified array. 
 
   INPUT - An array of control points.

   OUTPUT - A modified array. 

*/

function controlsPointTransformation(controls) {
  var arr = [];
    for(var i=0; i<controls.length; i++) {
    for(var j=0; j<3; j++) {
        var arr2 = [];
        arr2[j] = controls[i][j+2];
        arr2[j+1] = controls[i][j];
        arr2[j+2] = (-1)*controls[i][j+1];
        j+=3;
        arr.push(arr2);
       
    }
     
  }
  return arr;
}

/* This function creates a cylindrical surface. It takes as input two arrays one for the upper base one for the lower base of cylender  
 
   INPUT - Two arrays of control points.

   OUTPUT - ABezier curve. 

*/
function generateMicrotubule (pointSup,pointInf) {
  var c0 =createNubs(pointSup);
  var c1 =createNubs(pointInf);
 
  var b = BEZIER(S1)([c0,c1]);
  var b1 = MAP(b)(domain2);
  //DRAW (b1);
  return b;
};


    
/***********************************************************************BIG MITHOCONDRION*************************************************************************/

//Outer membrane volume ext
  //Control point
  var cp1 = [[78.42952728271484-9, 319.5246887207031, 0 ],[85.37791442871094-9, 319.78509521484375, -10 ],[94.61820983886719+5, 319.78509521484375, 0 ],[101.09173583984375+5, 320.6038513183594, 0 ]];
  var cp2 = [[70.4506607055664-9, 324.9661865234375, 0 ],[83.0360336303711-9, 325.6783142089844, -10 ],[95.24503326416016+5, 326.1571044921875, -10 ],[108.84198760986328+5, 327.59832763671875, 0 ]];
  var cp3 = [[59.70538330078125-9, 337.8841247558594, 0 ],[82.77519989013672-9, 337.3196716308594, -30 ],[96.58267974853516+5, 337.0151062011719, -30 ],[114.5835952758789+5, 336.41815185546875, 0 ]];
  var cp4 = [[54.21564865112305-9, 353.04376220703125, 0 ],[73.07366180419922-9, 352.80072021484375, -46 ],[102.5321273803711+5, 352.93585205078125, -46 ],[119.51473999023438+5, 353.0233459472656, 0 ]];
  var cp5 = [[52.94705581665039-9, 367.6966857910156, 0 ],[72.40585327148438-9, 367.2912902832031, -55 ],[102.26971435546875+5, 367.5615539550781, -55 ],[119.83668518066406+5, 367.9669494628906, 0 ]];
  var cp6 = [[53.209163665771484-9, 381.70257568359375, 0 ],[73.28105926513672-9, 381.5002746582031, -60 ],[102.77790069580078, 381.14056396484375, -60 ],[119.5047607421875, 381.8599853515625, 0 ]];
  var cp7 = [[52.59729766845703-9, 395.4254455566406, 0 ],[73.82296752929688-9, 395.231201171875, -59 ],[102.3516616821289, 395.231201171875, -59 ],[119.00186157226562, 395.94189453125, 0 ]];
  var cp8 = [[53.82242965698242-9, 409.6478576660156, 0 ],[73.21382141113281-9, 409.6478576660156, -60 ],[102.45319366455078, 409.1402282714844, -60 ],[119.91559600830078, 408.3280029296875, 0 ]];
  var cp9 = [[56.76667785644531-9, 423.7598876953125, 0 ],[74.03883361816406-9, 423.8822021484375, -55 ],[103.6324234008789+5, 423.20654296875, -55 ],[124.26261138916016+5, 422.7600402832031, 0 ]];
  var cp10 = [[60.256771087646484-9, 437.7486267089844, 0 ],[78.71070861816406-9, 437.9825439453125, -46 ],[103.78752899169922+5, 438.18560791015625, -46 ],[127.0368881225586+5, 438.49017333984375, 0 ]];
  var cp11 = [[67.03526306152344-9, 452.3992004394531, 0 ],[81.95952606201172-9, 452.29766845703125, -30 ],[112.01110076904297+5, 451.9930725097656, -30 ],[127.13841247558594+5, 451.28240966796875, 0 ]];
  var cp12 = [[73.93899536132812-9, 464.8868408203125, 0 ],[87.03579711914062-9, 466.0036315917969, -15 ],[110.38668060302734+5, 466.5112609863281, -15 ],[122.67127990722656+5, 466.5112609863281, 0 ]];
  var cp13 = [[87.44190216064453-9, 476.663818359375, 0 ],[95.97004699707031-9, 476.0546569824219, 0 ],[105.61498260498047+5, 475.2424621582031, 0 ],[116.47821807861328+5, 474.12567138671875, 0 ]];


  var volumeOut = createCurveSurface([88.50161743164062,318.9059753417969,0],[101.99493408203125,477.54669189453125,0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13]);
  DRAW(COLOR(mattBurgundy)(MAP(volumeOut)(domain2)));
 
//Outer membrane volume int
  //Control point
  var cp1 =  [[81.15792083740234-9, 322.9072265625, 0 ],[86.31511688232422-9, 322.76678466796875, 0 ],[89.73242950439453+5, 322.76678466796875, 0 ],[96.1335678100586+5, 322.9072265625, 0 ]];
  var cp2 =  [[69.0499496459961-9, 330.8730163574219, 0 ],[83.4823989868164-9, 330.447998046875, -9 ],[92.10050964355469+5, 330.447998046875, -9 ],[105.05523681640625+5, 330.55438232421875, 0 ]];
  var cp3 =  [[63.13407516479492-9, 341.22064208984375, 0 ],[78.6945571899414-9, 340.7418518066406, -28 ],[96.88835144042969+5, 340.5024719238281, -28 ],[111.49127197265625+5, 340.5024719238281, 0 ]];
  var cp4 =  [[58.825016021728516-9, 351.0357360839844, 0 ],[76.3006362915039-9, 350.79632568359375, -44 ],[99.76106262207031+5, 350.79632568359375, -44 ],[113.97689819335938+5, 350.3094787597656, 0 ]];
  var cp5 =  [[57.38866424560547-9, 364.4416809082031, 0 ],[73.9067153930664-9, 363.962890625, -53 ],[101.43680572509766+5, 364.4416809082031, -53 ],[115.32154083251953+5, 363.7235107421875, 0 ]];
  var cp6 =  [[56.941978454589844-9, 379.942138671875, 0 ],[73.42793273925781-9, 380.0021667480469, -58 ],[102.15497589111328, 380.48095703125, -58 ],[115.32154083251953, 380.959716796875, 0 ]];
  var cp7 =  [[57.89787292480469-9, 395.2364196777344, 0 ],[76.3006362915039-9, 394.844482421875, -53 ],[103.5913314819336, 394.6050720214844, -53 ],[115.57005310058594, 393.32464599609375, 0 ]];
  var cp8 =  [[59.49102783203125-9, 411.16796875, 0 ],[78.92750549316406-9, 411.16796875, -58 ],[101.91558837890625, 411.84130859375, -58 ],[116.75789642333984, 411.84130859375, 0 ]];
  var cp9 =  [[63.63322830200195-9, 428.6926574707031, 0 ],[84.91875457763672-9, 428.5987548828125, -53 ],[106.46403503417969+5, 428.3593444824219, -53 ],[121.06695556640625+5, 428.5987548828125, 0 ]];
  var cp10 =  [[70.32447814941406-9, 443.34967041015625, 0 ],[91.99137115478516-9, 443.6683044433594, -44 ],[108.85795593261719+5, 442.4834899902344, -44 ],[123.21719360351562+5, 442.7124328613281, 0 ]];
  var cp11 =  [[73.82941436767578-9, 455.1390380859375, 0 ],[93.536865234375-9, 455.6500549316406, -28 ],[106.94281768798828+5, 455.8894348144531, -28 ],[122.26390838623047+5, 455.8894348144531, 0 ]];
  var cp12 =  [[81.0884780883789-9, 465.2257385253906, 0 ],[97.08946228027344-9, 465.6538391113281, -12 ],[105.0276870727539+5, 465.70452880859375, -12 ],[119.71224975585938+5, 464.69793701171875, 0 ]];
  var cp13 =  [[89.94598388671875-9, 473.6044616699219, 0 ],[98.8034896850586-9, 473.8438415527344+3, 0 ],[104.78829193115234+3, 474.083251953125+5, 0 ],[109.81552886962890, 473.6044616699219+5, 0 ]];
  
  var volumeIn = createCurveSurface([88.4175796508789, 321.68878173828125, 0],[101.98870086669922, 474.3639221191406, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13]);
  //DRAW(volumeIn);

  var lisosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
  DRAW(COLOR(mattBurgundy)(lisosome3D));


//Inner membrane volume 

  //Inner membrane volume SX

    //Upper curve
      var point_Ext_InnerSX = [[88.66173553466797, 328.84747314453125, 0],[86.53084564208984, 328.41192626953125, 0],[84.29613494873047, 328.2383117675781, 0],[81.8595199584961, 328.13677978515625, 0],[79.52442932128906, 328.2383117675781, 0],[76.98628997802734, 328.6444091796875, 0],[75.4634017944336, 329.65966796875, 0],[74.0375747680664, 330.9335021972656, 0],[73.33136749267578, 332.7054443359375, 0],[73.53441619873047, 334.53289794921875, 0],[74.04204559326172, 336.56341552734375, 0],[75.36187744140625, 338.0863037109375, 0],[76.98628997802734, 339.60919189453125, 0],[78.10307312011719, 341.4366455078125, 0],[78.71222686767578, 343.0610656738281, 0],[79.2198486328125, 344.7869873046875, 0],[79.52442932128906, 346.7159729003906, 0],[79.52442932128906, 348.64495849609375, 0],[78.91527557373047, 350.67547607421875, 0],[76.98628997802734, 351.38616943359375, 0],[74.95577239990234, 351.38616943359375, 0],[73.63594055175781, 350.472412109375, 0],[72.41763305664062, 348.9495544433594, 0],[71.40238189697266, 347.1220703125, 0],[70.69170379638672, 345.59918212890625, 0],[69.27033996582031, 344.5839538574219, 0],[67.1383056640625, 344.482421875, 0],[65.41236877441406, 345.1930847167969, 0],[64.60016632080078, 346.7159729003906, 0],[63.99100875854492, 349.152587890625, 0],[63.4927978515625, 351.62188720703125, 0],[63.37818145751953, 353.9715270996094, 0],[63.37818145751953, 356.60772705078125, 0],[63.836647033691406, 359.1293029785156, 0],[64.9255142211914, 360.791259765625, 0],[66.123046875, 361.6402587890625, 0],[67.7474594116211, 361.74176025390625, 0],[69.51019287109375, 361.3070373535156, 0],[71.11483764648438, 360.4474182128906, 0],[72.77678680419922, 359.87432861328125, 0],[74.44815063476562, 360.3204040527344, 0],[75.56492614746094, 361.3356628417969, 0],[76.58018493652344, 363.2646484375, 0],[76.58018493652344, 365.1936340332031, 0],[75.97103118896484, 367.2241516113281, 0],[75.05730438232422, 368.9501037597656, 0],[73.83899688720703, 370.7775573730469, 0],[71.40238189697266, 371.6912841796875, 0],[69.16881561279297, 371.7928161621094, 0],[66.75938415527344, 371.3933410644531, 0],[64.69627380371094, 371.4506530761719, 0],[63.091636657714844, 372.4248962402344, 0],[62.00277328491211, 373.9149169921875, 0],[61.372379302978516, 375.6341857910156, 0],[61.6589241027832, 377.5253601074219, 0],[62.518558502197266, 378.9580383300781, 0],[64.00858306884766, 380.1615295410156, 0],[65.78514862060547, 381.30767822265625, 0],[67.90556335449219, 382.1673278808594, 0],[70.25521850585938, 383.6573486328125, 0],[72.31832122802734, 385.2046813964844, 0],[74.38143157958984, 386.52276611328125, 0],[76.32992553710938, 388.47125244140625, 0],[77.41878509521484, 390.0185852050781, 0],[77.41878509521484, 391.1074523925781, 0],[76.7310791015625, 391.56591796875, 0],[75.58491516113281, 391.50860595703125, 0],[73.92296600341797, 390.8209228515625, 0],[72.03178405761719, 389.44549560546875, 0],[70.08329010009766, 387.8981628417969, 0],[68.30672454833984, 386.52276611328125, 0],[66.35823059082031, 385.3765869140625, 0],[65.0401382446289, 385.3765869140625, 0],[63.550113677978516, 386.1216125488281, 0],[62.80509948730469, 387.3251037597656, 0],[62.34663391113281, 389.44549560546875, 0],[61.945472717285156, 392.1963195800781, 0],[61.71623992919922, 395.4629211425781, 0],[61.658931732177734, 399.0733337402344, 0],[61.83085632324219, 402.4545593261719, 0],[62.060089111328125, 406.1795959472656, 0],[62.86241149902344, 409.6754455566406, 0],[64.00858306884766, 412.5981750488281, 0],[65.61322021484375, 414.3174133300781, 0],[67.6190185546875, 415.06243896484375, 0],[70.14059448242188, 415.1197509765625, 0],[72.719482421875, 414.6039733886719, 0],[74.89720916748047, 414.3747253417969, 0],[76.67377471923828, 414.8905029296875, 0],[77.53340148925781, 415.86474609375, 0],[77.53340148925781, 416.89630126953125, 0],[76.50184631347656, 417.98516845703125, 0],[74.55335998535156, 418.5582580566406, 0],[72.20370483398438, 419.18865966796875, 0],[70.19790649414062, 419.990966796875, 0],[67.96287536621094, 421.3090515136719, 0],[66.3009262084961, 422.9136962890625, 0],[64.69628143310547, 424.80487060546875, 0],[63.49280548095703, 426.8106994628906, 0],[63.89396286010742, 428.4726257324219, 0],[65.2120590209961, 430.13458251953125, 0],[67.10324096679688, 431.10882568359375, 0],[68.99442291259766, 431.3953552246094, 0],[71.1148452758789, 430.7649841308594, 0],[73.6937255859375, 430.19189453125, 0],[75.81414794921875, 430.0772705078125, 0],[78.04917907714844, 430.0772705078125, 0],[80.16959381103516, 430.5930480957031, 0],[81.71692657470703, 431.4526672363281, 0],[82.4619369506836, 432.5988464355469, 0],[81.60231018066406, 433.9169616699219, 0],[80.3988265991211, 435.0631103515625, 0],[78.794189453125, 435.5788879394531, 0],[76.78839111328125, 435.4642639160156, 0],[74.72528076171875, 435.4069519042969, 0],[72.31832122802734, 435.2350158691406, 0],[70.3125228881836, 435.4642639160156, 0],[68.99442291259766, 436.2665710449219, 0],[68.42134094238281, 437.69927978515625, 0],[68.30671691894531, 439.3039245605469, 0],[68.47864532470703, 440.7366638183594, 0],[68.9371109008789, 442.6278381347656, 0],[69.73943328857422, 444.2897644042969, 0],[70.71367645263672, 445.8944091796875, 0],[71.57331085205078, 447.15521240234375, 0],[72.49024200439453, 448.3013916015625, 0],[73.46449279785156, 449.6767883300781, 0],[74.89720153808594, 451.1094970703125, 0],[76.04337310791016, 451.9691162109375, 0],[77.01761627197266, 452.3702697753906, 0],[78.39302062988281, 452.5995178222656, 0],[79.82573699951172, 452.4848937988281, 0],[81.0865249633789, 452.14105224609375, 0],[82.11808776855469, 450.994873046875, 0],[83.32156372070312, 449.6194763183594, 0],[84.29580688476562, 448.5879211425781, 0],[85.78583526611328, 447.3271484375, 0],[86.9320068359375, 446.23828125, 0],[88.59395599365234, 445.20672607421875, 0],[90.08396911621094, 444.920166015625, 0],[91.23014068603516, 445.3213195800781, 0],[91.68861389160156, 446.6394348144531, 0],[91.17283630371094, 448.12945556640625, 0],[90.1985855102539, 449.3902282714844, 0],[88.47933197021484, 450.7656555175781, 0],[86.98931121826172, 451.91180419921875, 0],[85.49928283691406, 453.172607421875, 0],[84.1238784790039, 454.891845703125, 0],[83.3215560913086, 456.7257385253906, 0],[82.74847412109375, 458.9034729003906, 0],[82.40462493896484, 460.966552734375, 0],[82.51924133300781, 462.8577575683594, 0],[82.97770690917969, 464.9781799316406, 0],[84.1238784790039, 466.0097351074219, 0],[85.2127456665039, 466.8693542480469, 0],[86.30160522460938, 467.3851318359375, 0],[87.50508117675781, 467.7862854003906, 0],[88.82318115234375, 467.6716613769531, 0],[90.31320190429688, 467.2705078125, 0],[91.40206909179688, 466.2962646484375, 0],[92.03246307373047, 464.9781799316406, 0],[93.17863464355469, 463.8893127441406, 0],[94.26749420166016, 463.0296630859375, 0],[95.52828216552734, 462.8004455566406, 0],[96.61714935302734, 462.7431335449219, 0]]; 
      var Su0SX =createNubs(point_Ext_InnerSX);
      //var curve0SX = MAP(Su0SX)(domain1);
      //DRAW(curve0SX);

    //Bottom curve
      var point_BottomSX = reverseR([[96.61714935302734+1, 462.7431335449219-0.5,-16],[91.44792175292969, 444.926513671875, -28], [88.10330200195312, 430.2937927246094, -36], [80.5779037475586, 406.0452880859375, -44], [79.74175262451172, 381.37872314453125, -36], [80.99598693847656, 353.7856140136719, -28], [88.66173553466797, 328.84747314453125+6,-16]]); //retta fondo
      var Su1SX =createNubs(point_BottomSX);
      
    //Laterals curves
      var point_LateralSX1 = [[88.66173553466797, 328.84747314453125,0], [78.33412170410156, 329.3287048339844,-10], [88.66173553466797, 328.84747314453125+6,-16]]; //retta profondità
      var Sv0SX = BEZIER(S1)(point_LateralSX1);
      //var curve2SX = MAP(BEZIER(S0)(point_LateralSX1))(domain1);
      //DRAW(curve2SX);

      var point_LateralSX2 = [[96.61714935302734, 462.7431335449219,0],[86.96328735351562, 462.3104248046875, -10],[96.61714935302734+1, 462.7431335449219-0.5,-16]]; // retta rofondità
      var Sv1SX = BEZIER(S1)(point_LateralSX2);
      //var curve3SX = MAP( BEZIER(S0)(point_LateralSX1))(domain1);
      //DRAW(curve3SX);

    //Volume generation
    var outDX = MAP(COONS_PATCH([Su0SX,Su1SX,Sv0SX,Sv1SX]))(domain2);
    //DRAW(outDX);

  //Inner membrane volume DX

    //Upper curve
      var point_Ext_InnerDX = reverseR( [[88.66173553466797, 328.84747314453125, 0],[90.07969665527344, 329.2727355957031, 0],[91.39779663085938, 329.78851318359375, 0],[92.77320098876953, 330.4762268066406, 0],[94.14860534667969, 331.2785339355469, 0],[95.40939331054688, 332.08087158203125, 0],[96.84210968017578, 332.997802734375, 0],[98.44674682617188, 334.2012939453125, 0],[99.70753479003906, 335.23284912109375, 0],[101.19756317138672, 336.3216857910156, 0],[102.6302719116211, 337.5824890136719, 0],[103.94837188720703, 338.7286682128906, 0],[105.20915985107422, 340.33331298828125, 0],[106.35533142089844, 341.8233337402344, 0],[107.15765380859375, 343.0841064453125, 0],[107.55880737304688, 344.6314392089844, 0],[107.67343139648438, 346.06414794921875, 0],[107.4441909790039, 347.2103271484375, 0],[107.100341796875, 348.35650634765625, 0],[106.18340301513672, 349.21612548828125, 0],[104.63607788085938, 349.5599670410156, 0],[103.03407287597656, 349.65802001953125, 0],[101.38426208496094, 349.59332275390625, 0],[99.66976165771484, 349.5285949707031, 0],[98.3321304321289, 349.5026550292969, 0],[97.11417388916016, 349.5609436035156, 0],[95.98194885253906, 349.59332275390625, 0],[94.8497314453125, 349.62567138671875, 0],[93.97630310058594, 350.11090087890625, 0],[93.6528091430664, 350.82257080078125, 0],[93.6204605102539, 351.5342712402344, 0],[93.6851577758789, 352.1812438964844, 0],[93.7822036743164, 353.0870056152344, 0],[94.17039489746094, 353.8310546875, 0],[95.1085205078125, 354.2515869140625, 0],[96.3701400756836, 354.3486328125, 0],[97.69645690917969, 354.154541015625, 0],[98.82868194580078, 353.7987060546875, 0],[100.15499877929688, 353.507568359375, 0],[101.44896697998047, 353.2811279296875, 0],[102.93702697753906, 353.2164306640625, 0],[104.36038970947266, 353.3458251953125, 0],[105.78223419189453, 353.5716552734375, 0],[107.55879974365234, 354.1447448730469, 0],[108.70497131347656, 354.8897399902344, 0],[109.85975646972656, 355.9337463378906, 0],[110.4420394897461, 357.2276916503906, 0],[110.92727661132812, 358.48931884765625, 0],[111.25077056884766, 360.1391296386719, 0],[111.41252136230469, 361.7242431640625, 0],[111.28311920166016, 363.4710998535156, 0],[110.86257934570312, 364.73272705078125, 0],[110.2479476928711, 365.67083740234375, 0],[109.30982208251953, 366.2531433105469, 0],[108.08055114746094, 366.6089782714844, 0],[106.52779388427734, 366.6089782714844, 0],[104.65154266357422, 366.6736755371094, 0],[103.1958236694336, 366.4148864746094, 0],[102.06360626220703, 366.1884460449219, 0],[101.19754791259766, 365.9502868652344, 0],[99.83151245117188, 365.73553466796875, 0],[98.44673919677734, 365.6064453125, 0],[96.89940643310547, 365.7210693359375, 0],[95.810546875, 366.1795349121094, 0],[95.12284088134766, 367.0964660644531, 0],[94.623291015625, 367.9676513671875, 0],[94.6556396484375, 369.099853515625, 0],[95.20557403564453, 370.1673889160156, 0],[96.30545043945312, 371.0408020019531, 0],[97.92290496826172, 371.52606201171875, 0],[99.37862396240234, 371.78485107421875, 0],[100.93138122558594, 371.94659423828125, 0],[102.80763244628906, 372.07598876953125, 0],[104.36039733886719, 372.17303466796875, 0],[106.13959503173828, 372.27008056640625, 0],[107.7894058227539, 372.69061279296875, 0],[108.986328125, 373.2082214355469, 0],[110.05384826660156, 374.1786804199219, 0],[110.76553344726562, 375.4403076171875, 0],[111.28311920166016, 376.9607238769531, 0],[111.50956726074219, 378.48114013671875, 0],[111.47721099853516, 380.1309509277344, 0],[111.50956726074219, 381.9425048828125, 0],[111.21842193603516, 383.3658447265625, 0],[110.79788208007812, 384.4333801269531, 0],[109.98998260498047, 385.2068176269531, 0],[108.90616607666016, 385.6321105957031, 0],[107.80863189697266, 385.71441650390625, 0],[106.69917297363281, 385.6644287109375, 0],[105.51752471923828, 385.28912353515625, 0],[104.36510467529297, 384.630615234375, 0],[103.10294342041016, 383.7937316894531, 0],[102.0602798461914, 383.02545166015625, 0],[101.11365509033203, 382.1474609375, 0],[99.93379974365234, 381.516357421875, 0],[98.80882263183594, 380.8852844238281, 0],[97.5466537475586, 380.61090087890625, 0],[96.60002899169922, 380.9950256347656, 0],[95.9415054321289, 381.7633056640625, 0],[95.63862609863281, 382.5124816894531, 0],[95.29476928710938, 383.77325439453125, 0],[95.52400207519531, 385.09136962890625, 0],[95.75324249267578, 386.06561279296875, 0],[96.31192779541016, 387.00408935546875, 0],[97.09391784667969, 388.0055847167969, 0],[97.93096160888672, 388.7017822265625, 0],[98.671630859375, 389.281494140625, 0],[99.71428680419922, 389.8165283203125, 0],[101.08293914794922, 390.3637390136719, 0],[102.33466339111328, 390.8180236816406, 0],[103.54195404052734, 391.0924072265625, 0],[104.69436645507812, 391.3805236816406, 0],[105.79190826416016, 391.545166015625, 0],[107.10033416748047, 391.6818542480469, 0],[108.13188934326172, 391.79644775390625, 0],[109.7430419921875, 392.0802307128906, 0],[111.11495971679688, 392.7936096191406, 0],[112.00074005126953, 393.94708251953125, 0],[112.38825225830078, 395.0665588378906, 0],[112.60195922851562, 396.7250061035156, 0],[112.21602630615234, 397.82220458984375, 0],[111.39847564697266, 398.7308044433594, 0],[110.25230407714844, 399.18927001953125, 0],[109.10613250732422, 399.5331115722656, 0],[107.55880737304688, 399.5904235839844, 0],[106.41263580322266, 399.5904235839844, 0],[104.7241439819336, 399.5875244140625, 0],[103.08873748779297, 399.7623291015625, 0],[101.54141235351562, 400.2207946777344, 0],[100.62447357177734, 401.0231018066406, 0],[99.9448471069336, 402.1709289550781, 0],[99.9448471069336, 403.67791748046875, 0],[100.80598449707031, 404.668212890625, 0],[102.22685241699219, 405.4001770019531, 0],[103.26021575927734, 405.8738098144531, 0],[104.9394302368164, 406.30438232421875, 0],[106.69918060302734, 406.86859130859375, 0],[108.59925842285156, 407.5530090332031, 0],[110.36692810058594, 408.3013000488281, 0],[112.08684539794922, 409.1891784667969, 0],[113.80912017822266, 410.7822570800781, 0],[114.55045318603516, 412.08367919921875, 0],[114.97164916992188, 413.4087219238281, 0],[115.2730484008789, 414.61431884765625, 0],[115.10082244873047, 415.9490966796875, 0],[114.45497131347656, 417.1116027832031, 0],[113.12020874023438, 418.1019287109375, 0],[111.3548812866211, 418.4033203125, 0],[109.63261413574219, 418.2310791015625, 0],[108.0745849609375, 417.81451416015625, 0],[106.6418685913086, 417.1268310546875, 0],[105.28387451171875, 416.4226989746094, 0],[103.71913146972656, 415.8087158203125, 0],[102.18379211425781, 415.2601623535156, 0],[100.2462387084961, 414.9587707519531, 0],[99.12676239013672, 415.38934326171875, 0],[98.78230285644531, 415.86297607421875, 0],[98.73925018310547, 416.853271484375, 0],[99.07714080810547, 417.81451416015625, 0],[100.20317840576172, 418.9200134277344, 0],[101.62405395507812, 419.953369140625, 0],[103.69078063964844, 420.8575439453125, 0],[105.67138671875, 421.41729736328125, 0],[107.60894012451172, 421.9770202636719, 0],[109.5034408569336, 422.708984375, 0],[111.22655487060547, 423.6600036621094, 0],[112.37272644042969, 424.3476867675781, 0],[113.40428161621094, 425.09271240234375, 0],[114.43583679199219, 426.0096435546875, 0],[115.48833465576172, 426.97161865234375, 0],[116.38432312011719, 428.2446594238281, 0],[117.29671478271484, 429.7272644042969, 0],[117.8995132446289, 431.1911926269531, 0],[118.20091247558594, 432.4828796386719, 0],[118.37313842773438, 434.4635009765625, 0],[118.37313842773438, 435.7552185058594, 0],[117.98562622070312, 437.3052673339844, 0],[117.12933349609375, 438.21636962890625, 0],[115.7539291381836, 438.6748352050781, 0],[113.8521728515625, 438.2955627441406, 0],[112.08684539794922, 437.26220703125, 0],[110.2784652709961, 436.185791015625, 0],[108.9437026977539, 435.02325439453125, 0],[107.90265655517578, 434.3766784667969, 0],[106.70475006103516, 434.1190490722656, 0],[105.62833404541016, 434.4635009765625, 0],[105.19776153564453, 435.5829772949219, 0],[105.58527374267578, 436.70245361328125, 0],[107.35060119628906, 438.0372314453125, 0],[109.11592864990234, 439.3719787597656, 0],[111.01042938232422, 440.6206359863281, 0],[112.54464721679688, 441.6548767089844, 0],[114.20659637451172, 442.6864318847656, 0],[116.21239471435547, 443.9472351074219, 0],[117.58779907226562, 444.978759765625, 0],[118.6314697265625, 446.1319274902344, 0],[119.2773208618164, 447.76806640625, 0],[119.57872009277344, 449.5764465332031, 0],[119.57872009277344, 450.78204345703125, 0],[119.23426818847656, 452.80572509765625, 0],[118.5047378540039, 453.7469787597656, 0],[117.33976745605469, 454.18353271484375, 0],[115.83277893066406, 454.0543518066406, 0],[114.54107666015625, 453.02099609375, 0],[113.12020874023438, 451.7723388671875, 0],[111.6562728881836, 450.7389831542969, 0],[110.23540496826172, 449.8348083496094, 0],[109.07286834716797, 449.1889343261719, 0],[107.78116607666016, 448.3708801269531, 0],[106.66168975830078, 447.8111267089844, 0],[105.61031341552734, 447.5003662109375, 0],[104.121337890625, 447.3374938964844, 0],[103.26020812988281, 447.68194580078125, 0],[102.65740966796875, 448.5430908203125, 0],[102.3990707397461, 449.5764465332031, 0],[102.44212341308594, 450.5667724609375, 0],[103.044921875, 451.55706787109375, 0],[104.29356384277344, 452.2890319824219, 0],[106.01583862304688, 453.02099609375, 0],[108.01727294921875, 453.8042907714844, 0],[110.53679656982422, 454.8293762207031, 0],[112.17295837402344, 455.86273193359375, 0],[113.55077362060547, 456.8099670410156, 0],[115.14387512207031, 458.01556396484375, 0],[116.04806518554688, 459.0489196777344, 0],[116.65086364746094, 460.2975769042969, 0],[116.82308959960938, 461.6753845214844, 0],[116.52169036865234, 463.2254333496094, 0],[115.8327865600586, 464.6893615722656, 0],[114.9285888671875, 465.9380187988281, 0],[113.63688659667969, 467.10052490234375, 0],[112.08684539794922, 468.1769714355469, 0],[110.36457061767578, 468.82281494140625, 0],[108.5992431640625, 468.95196533203125, 0],[107.32957458496094, 468.70452880859375, 0],[105.84361267089844, 468.1339111328125, 0],[104.72413635253906, 467.5310974121094, 0],[103.6045150756836, 466.69873046875, 0],[102.35601043701172, 465.72271728515625, 0],[101.10736846923828, 464.3018493652344, 0],[100.11705780029297, 463.3545837402344, 0],[99.19175720214844, 462.9736633300781, 0],[98.16020202636719, 462.74444580078125, 0],[97.47249603271484, 462.74444580078125, 0],[96.61714935302734, 462.7431335449219, 0]]); //curve
      var Su0DX =createNubs(point_Ext_InnerDX);
      //var curve0DX = MAP(Su0DX)(domain1);
      //DRAW(curve0DX);

     //Bottom curve
      var point_BottomDX = reverseR([[88.66173553466797, 328.84747314453125+6,-16],[90.99598693847656, 353.7856140136719, -28],[89.74175262451172, 381.37872314453125, -36],[90.5779037475586, 406.0452880859375, -44],[98.10330200195312, 430.2937927246094, -36],[101.44792175292969, 444.926513671875, -28],[96.61714935302734+1, 462.7431335449219-0.5,-16]]); //retta fondo
      var Su1DX =createNubs(point_BottomDX);
      //var curve1SX = MAP(Su1SX)(domain1);
      //DRAW(curve1SX);

     var point_Su1DXreverse = reverseR(point_BottomDX);
      var Su1DXrev =createNubs(point_Su1DXreverse); //useful to generate the bottom closure
      //var curve1DX = MAP(Su1DX)(domain1);
      //DRAW(curve1DX);

    //Laterals curves
      var point_LateralDX1 = [[96.61714935302734, 462.7431335449219,0],[106.96328735351562, 462.3104248046875, -10],[96.61714935302734+1, 462.7431335449219-0.5,-16]];//retta profondita
      var Sv0DX = BEZIER(S1)(point_LateralDX1);
      //var curve2DX = MAP(BEZIER(S0)(point_LateralDX1))(domain1);
      //DRAW(curve2DX);

      var point_LateralDX2 = [[88.66173553466797, 328.84747314453125,0],[98.33412170410156, 329.3287048339844,-10],[88.66173553466797, 328.84747314453125+6,-16]]; // retta rofondità
      var Sv1DX = BEZIER(S1)(point_LateralDX2);
      //var curve3DX = MAP( BEZIER(S0)(point_LateralDX2))(domain1);
      //DRAW(curve3DX);

    //Volume generation
      var outSX = MAP(COONS_PATCH([Su0DX,Su1DX,Sv0DX,Sv1DX]))(domain2);
    //DRAW(outSX);

  //Bottom closure
    var bottom = BEZIER(S1)([Su1DXrev,Su1SX]);
    var bottomMap = (MAP(bottom)(domain2));

  //Lateral closures

    var lateralClosure1=BEZIER(S2)([Sv1SX,[88.66173553466797, 328.84747314453125+6,-15],Sv0DX]);
    var lateralClosure2=BEZIER(S2)([Sv1DX,[96.61714935302734+1, 462.7431335449219-0.5,-16],Sv0SX]);
    var lc1Map = (MAP(lateralClosure1)(domain3));
    var lc2Map = (MAP(lateralClosure2)(domain3));
    DRAW (COLOR (mattCoralRed)(lc1Map));
    DRAW (COLOR (mattCoralRed)(lc2Map));

  //Volume assembly (DX+SX+bottom+lateral)
    var volume_inner = COLOR (mattCoralRed)(STRUCT ([bottomMap,outSX,outDX]));
    DRAW (volume_inner);

//Boundary of inner membrane with cristae

  //Internal
   var pointInt_InnerDX= reverseR([[88.75521087646484, 333.3511047363281, 0],[90.28076171875, 334.1138610839844, 0 ],[91.19609832763672, 334.571533203125, 0 ],[92.34026336669922, 335.1817626953125, 0 ],[93.40814971923828, 335.7156982421875, 0 ],[94.3997573852539, 336.4784851074219, 0 ],[95.23881530761719, 337.08868408203125, 0 ],[96.23042297363281, 337.8514709472656, 0 ],[97.22203826904297, 338.6142578125, 0 ],[98.28992462158203, 339.45330810546875, 0 ],[99.43408966064453, 340.4449157714844, 0 ],[100.57825469970703, 341.4365234375, 0 ],[101.56986236572266, 342.27557373046875, 0 ],[102.6466293334961, 343.15423583984375, 0 ],[103.42436981201172, 343.9805908203125, 0 ],[103.66741180419922, 344.78265380859375, 0 ],[103.67568969726562, 345.3428955078125, 0 ],[103.4973373413086, 345.809326171875, 0 ],[103.33271026611328, 346.11114501953125, 0 ],[103.0720443725586, 346.2895202636719, 0 ],[102.79766082763672, 346.3443908691406, 0 ],[102.1802978515625, 346.38555908203125, 0 ],[101.12513732910156, 346.4075927734375, 0 ],[99.60472106933594, 346.4722900390625, 0 ],[98.24605560302734, 346.43994140625, 0 ],[96.98443603515625, 346.43994140625, 0 ],[95.46402740478516, 346.4722900390625, 0 ],[93.74951934814453, 346.6016845703125, 0 ],[92.58494567871094, 347.3133850097656, 0 ],[91.51742553710938, 348.80145263671875, 0 ],[91.22628021240234, 350.3218688964844, 0 ],[91.19056701660156, 351.4920959472656, 0 ],[91.28660583496094, 352.31524658203125, 0 ],[91.39635467529297, 353.35791015625, 0 ],[91.98628234863281, 354.5377502441406, 0 ],[92.9395980834961, 355.63128662109375, 0 ],[94.40352630615234, 356.3201904296875, 0 ],[96.0827407836914, 356.40631103515625, 0 ],[97.76195526123047, 356.3632507324219, 0 ],[99.22588348388672, 356.2771301269531, 0 ],[100.51758575439453, 356.23406982421875, 0 ],[101.68012237548828, 356.1910095214844, 0 ],[102.71348571777344, 356.3201904296875, 0 ],[103.61478424072266, 356.6282043457031, 0 ],[104.61126708984375, 357.16290283203125, 0 ],[105.36470031738281, 357.62469482421875, 0 ],[106.26396942138672, 358.32952880859375, 0 ],[106.75005340576172, 359.2530822753906, 0 ],[107.14007568359375, 360.2435302734375, 0 ],[107.32267761230469, 361.3026123046875, 0 ],[107.19485473632812, 362.0695495605469, 0 ],[106.9757308959961, 362.61737060546875, 0 ],[106.61052703857422, 362.8912658691406, 0 ],[106.30010223388672, 363.037353515625, 0 ],[106.02619934082031, 363.1103820800781, 0 ],[105.60620880126953, 363.128662109375, 0 ],[104.8027572631836, 363.14691162109375, 0 ],[103.54280090332031, 363.1103820800781, 0 ],[102.62979125976562, 363.037353515625, 0 ],[101.7532958984375, 363.01910400390625, 0 ],[100.34725189208984, 362.946044921875, 0 ],[98.6125259399414, 362.8912658691406, 0 ],[98.6125259399414, 362.9095153808594, 0 ],[96.349365234375, 362.9974060058594, 0 ],[94.52653503417969, 363.5321044921875, 0 ],[92.89813995361328, 364.6501159667969, 0 ],[91.51278686523438, 366.71600341796875, 0 ],[91.26973724365234, 369.31658935546875, 0 ],[92.02317810058594, 371.358154296875, 0 ],[93.7730941772461, 373.25390625, 0 ],[96.5438003540039, 374.37188720703125, 0 ],[98.9256362915039, 374.61492919921875, 0 ],[100.74846649169922, 374.7364501953125, 0 ],[102.47408294677734, 374.80938720703125, 0 ],[103.90804290771484, 375.05242919921875, 0 ],[105.31769561767578, 375.2468566894531, 0 ],[106.6058349609375, 375.6600341796875, 0 ],[106.92179107666016, 375.95166015625, 0 ],[107.18914031982422, 376.31622314453125, 0 ],[107.31066131591797, 376.6321716308594, 0 ],[107.62661743164062, 377.409912109375, 0 ],[107.94258117675781, 378.5036315917969, 0 ],[108.30714416503906, 379.9618835449219, 0 ],[108.33145141601562, 381.1528015136719, 0 ],[108.18562316894531, 382.173583984375, 0 ],[107.96688079833984, 382.8055114746094, 0 ],[107.65092468261719, 383.0728454589844, 0 ],[107.26205444335938, 383.0485534667969, 0 ],[106.8974838256836, 383.02423095703125, 0 ],[106.43569946289062, 382.8055114746094, 0 ],[105.75518035888672, 382.4409484863281, 0 ],[104.95313262939453, 381.8576354980469, 0 ],[103.64069366455078, 380.88543701171875, 0 ],[102.37686157226562, 379.91326904296875, 0 ],[100.99150848388672, 378.96539306640625, 0 ],[99.53324890136719, 378.3091735839844, 0 ],[97.30909729003906, 377.9130859375, 0 ],[95.56224060058594, 378.236572265625, 0 ],[93.97712707519531, 379.142333984375, 0 ],[92.90960693359375, 380.8568420410156, 0 ],[92.35967254638672, 382.9919128417969, 0 ],[92.74786376953125, 385.25634765625, 0 ],[93.00665283203125, 386.4856262207031, 0 ],[93.45954132080078, 387.5531311035156, 0 ],[94.39766693115234, 388.87945556640625, 0 ],[94.39766693115234, 388.91180419921875, 0 ],[95.56224060058594, 389.9469909667969, 0 ],[96.27391815185547, 390.5292663574219, 0 ],[97.17970275878906, 391.0468444824219, 0 ],[98.50601196289062, 391.7261962890625, 0 ],[100.15582275390625, 392.21142578125, 0 ],[101.70858001708984, 392.6319580078125, 0 ],[103.09960174560547, 392.9554748535156, 0 ],[104.23181915283203, 393.3113098144531, 0 ],[105.39639282226562, 393.5700988769531, 0 ],[106.62566375732422, 393.7641906738281, 0 ],[107.69318389892578, 393.9582824707031, 0 ],[108.76070404052734, 394.1847229003906, 0 ],[109.01950073242188, 394.4435119628906, 0 ],[109.11654663085938, 394.83172607421875, 0 ],[109.11654663085938, 395.31695556640625, 0 ],[109.05184936523438, 395.89923095703125, 0 ],[108.92245483398438, 396.12567138671875, 0 ],[108.66365814208984, 396.25506591796875, 0 ],[108.46956634521484, 396.35211181640625, 0 ],[108.04902648925781, 396.4168395996094, 0 ],[107.43438720703125, 396.4168395996094, 0 ],[106.33451843261719, 396.4491882324219, 0 ],[104.71705627441406, 396.5138854980469, 0 ],[102.74375915527344, 396.9344177246094, 0 ],[100.80280303955078, 397.4843444824219, 0 ],[98.1501693725586, 398.843017578125, 0 ],[96.6297607421875, 400.6869201660156, 0 ],[96.04747772216797, 402.53082275390625, 0 ],[96.338623046875, 403.9541931152344, 0 ],[97.7943344116211, 405.60400390625, 0 ],[100.15582275390625, 406.7362365722656, 0 ],[101.96737670898438, 407.6096496582031, 0 ],[104.13477325439453, 408.0301818847656, 0 ],[106.04338073730469, 408.83892822265625, 0 ],[107.49909210205078, 409.58294677734375, 0 ],[108.56661224365234, 410.1652526855469, 0 ],[109.79588317871094, 411.0386657714844, 0 ],[110.44286346435547, 411.6209411621094, 0 ],[110.7340087890625, 412.1385498046875, 0 ],[110.8310546875, 412.753173828125, 0 ],[110.7987060546875, 413.2060546875, 0 ],[110.44286346435547, 413.5619201660156, 0 ],[110.08702850341797, 413.5942687988281, 0 ],[109.86058044433594, 413.529541015625, 0 ],[109.5047378540039, 413.4324951171875, 0 ],[108.85775756835938, 413.2384033203125, 0 ],[108.11372375488281, 412.9796142578125, 0 ],[107.14324951171875, 412.882568359375, 0 ],[105.94632720947266, 412.6561279296875, 0 ],[104.13477325439453, 412.2032470703125, 0 ],[102.71141052246094, 411.8150634765625, 0 ],[100.12347412109375, 411.0386657714844, 0 ],[98.21487426757812, 411.1033630371094, 0 ],[96.14452362060547, 412.623779296875, 0 ],[95.65928649902344, 414.8235168457031, 0 ],[95.85338592529297, 416.92620849609375, 0 ],[96.5650634765625, 419.1259765625, 0 ],[98.02079010009766, 420.8404541015625, 0 ],[100.15583801269531, 422.0697326660156, 0 ],[102.42028045654297, 423.49310302734375, 0 ],[104.68472290039062, 424.20477294921875, 0 ],[107.17560577392578, 425.2723083496094, 0 ],[108.8901138305664, 426.1133728027344, 0 ],[110.41053009033203, 426.9544677734375, 0 ],[111.6397933959961, 427.6337890625, 0 ],[112.51322937011719, 428.3131103515625, 0 ],[113.58074951171875, 429.1865539550781, 0 ],[114.35713195800781, 430.0923156738281, 0 ],[115.03646087646484, 431.28924560546875, 0 ],[115.39230346679688, 432.2273864746094, 0 ],[115.45700073242188, 433.3272399902344, 0 ],[115.42465209960938, 433.9418640136719, 0 ],[115.00411224365234, 434.1036376953125, 0 ],[114.58357238769531, 434.006591796875, 0 ],[114.32478332519531, 433.9095153808594, 0 ],[113.90424346923828, 433.6830749511719, 0 ],[112.83671569824219, 433.4242858886719, 0 ],[110.86341857910156, 432.5508728027344, 0 ],[109.31065368652344, 431.96856689453125, 0 ],[107.62850189208984, 431.28924560546875, 0 ],[105.00821685791016, 430.93341064453125, 0 ],[103.0672607421875, 431.45098876953125, 0 ],[102.35558319091797, 433.0684509277344, 0 ],[102.48497772216797, 436.2710266113281, 0 ],[103.61720275878906, 437.82379150390625, 0 ],[105.10526275634766, 439.5382995605469, 0 ],[106.65802001953125, 440.7351989746094, 0 ],[108.40487670898438, 441.867431640625, 0 ],[109.989990234375, 443.161376953125, 0 ],[111.57510375976562, 444.2612609863281, 0 ],[113.09551239013672, 445.3934631347656, 0 ],[113.83954620361328, 446.04046630859375, 0 ],[114.61592864990234, 446.88153076171875, 0 ],[115.13351440429688, 447.5608825683594, 0 ],[115.32760620117188, 448.6283874511719, 0 ],[115.19821166992188, 449.0165710449219, 0 ],[115.03646850585938, 449.3724365234375, 0 ],[114.68062591552734, 449.40478515625, 0 ],[114.26008605957031, 449.1136169433594, 0 ],[113.90424346923828, 448.7901306152344, 0 ],[113.35430908203125, 448.3372497558594, 0 ],[112.41618347167969, 447.7873229980469, 0 ],[110.89576721191406, 446.84918212890625, 0 ],[109.24596405029297, 446.13751220703125, 0 ],[108.04904174804688, 445.5875549316406, 0 ],[106.75507354736328, 444.9082336425781, 0 ],[104.58767700195312, 443.9701232910156, 0 ],[102.22618865966797, 444.325927734375, 0 ],[100.86752319335938, 445.78167724609375, 0 ],[100.02644348144531, 447.43145751953125, 0 ],[99.76764678955078, 449.1783142089844, 0 ],[100.22053527832031, 450.7957763671875, 0 ],[101.3204116821289, 452.3161926269531, 0 ],[102.45262908935547, 453.38372802734375, 0 ],[104.39358520507812, 454.6777038574219, 0 ],[106.52862548828125, 455.9716491699219, 0 ],[108.98716735839844, 457.1038818359375, 0 ],[110.34583282470703, 457.783203125, 0 ],[111.54275512695312, 458.4625244140625, 0 ],[112.38383483886719, 459.2712707519531, 0 ],[112.67497253417969, 459.6918029785156, 0 ],[112.80437469482422, 460.2417297363281, 0 ],[112.77202606201172, 460.9210510253906, 0 ],[112.64262390136719, 461.76214599609375, 0 ],[112.35148620605469, 462.53851318359375, 0 ],[111.89859771728516, 463.2178649902344, 0 ],[111.4133529663086, 463.8324890136719, 0 ],[110.63697814941406, 464.1236267089844, 0 ],[109.92529296875, 464.1883239746094, 0 ],[109.05186462402344, 464.0265808105469, 0 ],[107.85494232177734, 463.7030944824219, 0 ],[106.72272491455078, 463.3149108886719, 0 ],[105.71990203857422, 462.66790771484375, 0 ],[104.97586822509766, 462.24737548828125, 0 ],[103.90834045410156, 461.43865966796875, 0 ],[102.58203125, 460.5005187988281, 0 ],[101.2880630493164, 459.4006652832031, 0 ],[100.05879211425781, 459.012451171875, 0 ],[98.66777801513672, 458.68896484375, 0 ],[97.50320434570312, 458.624267578125, 0 ],[96.60772705078125, 458.2706604003906, 0]]); 
   var c0 =createNubs(pointInt_InnerDX);
  
   var pointInt_InnerSX= reverseR([[96.60772705078125, 458.2706604003906, 0],[95.28962707519531, 458.2133483886719, 0 ],[93.5130615234375, 459.0729675292969, 0 ],[92.19496154785156, 460.2764587402344, 0 ],[90.8195571899414, 461.7664794921875, 0 ],[90.36109161376953, 462.6260986328125, 0 ],[89.73069763183594, 463.2565002441406, 0 ],[88.92837524414062, 463.42840576171875, 0 ],[87.83951568603516, 463.42840576171875, 0 ],[87.26642608642578, 463.1991882324219, 0 ],[86.8079605102539, 462.8553466796875, 0 ],[86.52141571044922, 462.3395690917969, 0 ],[86.52141571044922, 461.5372314453125, 0 ],[86.57872772216797, 460.792236328125, 0 ],[86.75064849853516, 459.9898986816406, 0 ],[86.92257690429688, 459.47412109375, 0 ],[87.26642608642578, 457.8121643066406, 0 ],[87.66758728027344, 456.5513916015625, 0 ],[88.18336486816406, 455.5771484375, 0 ],[88.8710708618164, 454.7748107910156, 0 ],[90.36109161376953, 453.628662109375, 0 ],[90.41839599609375, 453.628662109375, 0 ],[91.9084243774414, 452.0813293457031, 0 ],[93.22651672363281, 450.30474853515625, 0 ],[93.8569107055664, 448.35626220703125, 0 ],[94.02883911132812, 446.7516174316406, 0 ],[93.74229431152344, 444.45928955078125, 0 ],[93.28382873535156, 443.7142639160156, 0 ],[91.22071838378906, 442.568115234375, 0 ],[88.69913482666016, 442.28155517578125, 0 ],[86.06294250488281, 443.25579833984375, 0 ],[84.6302261352539, 444.5165710449219, 0 ],[83.59867095947266, 445.5481262207031, 0 ],[82.45249938964844, 446.5796813964844, 0 ],[81.5928726196289, 447.38201904296875, 0 ],[80.9051742553711, 447.9551086425781, 0 ],[80.6186294555664, 448.12701416015625, 0 ],[79.70169067382812, 448.2989501953125, 0 ],[78.8420639038086, 448.35626220703125, 0 ],[77.69589233398438, 448.2989501953125, 0 ],[77.06549835205078, 448.12701416015625, 0 ],[76.4924087524414, 447.5539245605469, 0 ],[75.86201477050781, 446.9235534667969, 0 ],[75.28893280029297, 446.29315185546875, 0 ],[74.60122680664062, 445.6054382324219, 0 ],[73.91352844238281, 444.8031311035156, 0 ],[73.34043884277344, 443.4850158691406, 0 ],[72.7673568725586, 442.109619140625, 0 ],[72.4808120727539, 440.4476623535156, 0 ],[72.53812408447266, 440.4476623535156, 0 ],[72.4808120727539, 439.7026672363281, 0 ],[72.65274047851562, 439.301513671875, 0 ],[72.93927764892578, 439.01495361328125, 0 ],[73.34043884277344, 438.90032958984375, 0 ],[73.97083282470703, 438.9576416015625, 0 ],[74.88777160644531, 438.9576416015625, 0 ],[76.60702514648438, 438.9576416015625, 0 ],[78.61283111572266, 438.90032958984375, 0 ],[78.67013549804688, 438.90032958984375, 0 ],[82.05134582519531, 438.3272705078125, 0 ],[84.17176055908203, 437.29571533203125, 0 ],[85.8910140991211, 435.2898864746094, 0 ],[86.75064849853516, 432.3098449707031, 0 ],[86.23487091064453, 429.6736755371094, 0 ],[86.29217529296875, 429.6736755371094, 0 ],[84.34368896484375, 427.6105651855469, 0 ],[81.13440704345703, 427.152099609375, 0 ],[77.7531967163086, 427.0374755859375, 0 ],[74.48661041259766, 427.2093811035156, 0 ],[71.56387329101562, 427.6105651855469, 0 ],[70.58963012695312, 427.4959411621094, 0 ],[70.13116455078125, 427.0374755859375, 0 ],[69.95923614501953, 426.5216979980469, 0 ],[69.95923614501953, 426.4643859863281, 0 ],[69.95923614501953, 425.77667236328125, 0 ],[70.13116455078125, 425.0889892578125, 0 ],[70.87617492675781, 424.5158996582031, 0 ],[71.90773010253906, 423.71356201171875, 0 ],[72.99659729003906, 422.7392883300781, 0 ],[74.37200164794922, 421.9942932128906, 0 ],[74.37200164794922, 422.0516052246094, 0 ],[75.86202239990234, 421.8223571777344, 0 ],[78.15436553955078, 421.0200500488281, 0 ],[81.07710266113281, 418.38385009765625, 0 ],[81.42095184326172, 415.2891845703125, 0 ],[79.300537109375, 412.0225830078125, 0 ],[75.69009399414062, 410.9337463378906, 0 ],[72.71005249023438, 411.10565185546875, 0 ],[70.07386016845703, 411.22027587890625, 0 ],[68.69844818115234, 411.04833984375, 0 ],[68.69844818115234, 410.9910583496094, 0 ],[68.18267059326172, 410.5898742675781, 0 ],[67.60958862304688, 409.04254150390625, 0 ],[67.55227661132812, 408.9852294921875, 0 ],[66.5207290649414, 405.8905944824219, 0 ],[65.66109466552734, 402.2801513671875, 0 ],[65.03070068359375, 398.95623779296875, 0 ],[65.03070068359375, 395.9761962890625, 0 ],[65.20262908935547, 392.7096252441406, 0 ],[65.48917388916016, 390.70379638671875, 0 ],[65.66109466552734, 389.95880126953125, 0 ],[65.94763946533203, 389.5003356933594, 0 ],[66.00495147705078, 389.5003356933594, 0 ],[66.57803344726562, 389.2710876464844, 0 ],[67.151123046875, 389.2710876464844, 0 ],[67.89613342285156, 389.84417724609375, 0 ],[69.27153778076172, 390.6465148925781, 0 ],[70.41770935058594, 391.7353515625, 0 ],[70.47501373291016, 391.7353515625, 0 ],[72.25157928466797, 393.053466796875, 0 ],[75.40355682373047, 394.6581115722656, 0 ],[78.03974914550781, 395.6323547363281, 0 ],[80.50401306152344, 395.6323547363281, 0 ],[81.53556823730469, 393.97039794921875, 0 ],[81.07710266113281, 391.2195739746094, 0 ],[80.21747589111328, 389.2137756347656, 0 ],[79.12860870361328, 386.978759765625, 0 ],[76.72164916992188, 384.3425598144531, 0 ],[74.71585083007812, 382.79522705078125, 0 ],[72.5954360961914, 381.13330078125, 0 ],[69.84461975097656, 379.75787353515625, 0 ],[68.1253662109375, 378.8409423828125, 0 ],[67.26573944091797, 378.2105407714844, 0 ],[66.92188262939453, 377.5801696777344, 0 ],[66.74996185302734, 377.007080078125, 0 ],[66.6926498413086, 376.09014892578125, 0 ],[66.97919464111328, 375.4597473144531, 0 ],[67.20842742919922, 375.1731872558594, 0 ],[67.95343780517578, 375.11590576171875, 0 ],[68.69844818115234, 375.11590576171875, 0 ],[70.0738525390625, 374.88665771484375, 0 ],[71.96504211425781, 374.7147216796875, 0 ],[75.28893280029297, 374.1416320800781, 0 ],[79.18592071533203, 371.2762145996094, 0 ],[80.10285186767578, 368.2388610839844, 0 ],[80.2747802734375, 365.946533203125, 0 ],[80.2747802734375, 365.88922119140625, 0 ],[80.10285186767578, 362.9664611816406, 0 ],[78.72744750976562, 360.2729797363281, 0 ],[76.54972076416016, 358.0952453613281, 0 ],[73.225830078125, 356.77716064453125, 0 ],[70.24578094482422, 357.1210021972656, 0 ],[69.4434585571289, 357.2356262207031, 0 ],[68.81306457519531, 357.2929382324219, 0 ],[67.7815170288086, 357.1210021972656, 0 ],[67.4949722290039, 356.77716064453125, 0 ],[67.32304382324219, 356.3759765625, 0 ],[67.32304382324219, 355.74560546875, 0 ],[67.32304382324219, 353.6824951171875, 0 ],[67.26573944091797, 351.96319580078125, 0 ],[67.26573944091797, 350.4731750488281, 0 ],[67.4949722290039, 349.38433837890625, 0 ],[68.01074981689453, 349.0977783203125, 0 ],[68.58383178710938, 348.92584228515625, 0 ],[69.21422576904297, 348.92584228515625, 0 ],[69.95923614501953, 349.38433837890625, 0 ],[70.36039733886719, 350.5877990722656, 0 ],[70.99079132080078, 351.7912902832031, 0 ],[74.08545684814453, 353.6824645996094, 0 ],[77.92513275146484, 354.14093017578125, 0 ],[81.3636474609375, 352.9947509765625, 0 ],[82.9682846069336, 349.15509033203125, 0 ],[83.02559661865234, 346.5188903808594, 0 ],[82.337890625, 344.28387451171875, 0 ],[81.65018463134766, 342.4499816894531, 0 ],[80.7332534790039, 340.7880554199219, 0 ],[79.70169830322266, 338.8968505859375, 0 ],[78.49821472167969, 337.2922058105469, 0 ],[77.98243713378906, 336.2606506347656, 0 ],[77.46665954589844, 334.71331787109375, 0 ],[77.46665954589844, 333.6817932128906, 0 ],[77.8678207397461, 332.70751953125, 0 ],[78.3262939453125, 332.2490539550781, 0 ],[78.72744750976562, 332.01983642578125, 0 ],[79.70169830322266, 331.79058837890625, 0 ],[81.47826385498047, 331.3321228027344, 0 ],[83.82791137695312, 331.1029052734375, 0 ],[85.7190933227539, 331.4467468261719, 0 ],[88.75521087646484, 333.3511047363281, 0 ]]);  
   var c1 =createNubs(pointInt_InnerSX);
  
  //Filling the boundary
    var b = BEZIER(S1)([c1,Su0SX]);
    var b1 = COLOR (mattIndianRed)(MAP(b)(domain2));
    DRAW (b1);

    var b = BEZIER(S1)([c0,Su0DX]);
    var b1 = COLOR (mattIndianRed)(MAP(b)(domain2));
    DRAW (b1);


/*********************************************************************************CENTRIOLE*******************************************************************/

//Microtubule triplet A

//Microtubule  A1 ext
var point_supA1ext =  [[66.66948699951172, 229.05184936523438, 0],[65.73657989501953, 229.60061645507812, 0],[65.21524810791016, 230.43748474121094, 0],[65.06433868408203, 231.32923889160156, 0],[65.311279296875, 232.09751892089844, 0],[65.81889343261719, 232.74232482910156, 0],[66.60089111328125, 233.12644958496094, 0],[67.87677764892578, 233.16761779785156, 0],[68.7410888671875, 232.632568359375, 0],[69.33100891113281, 231.85057067871094, 0],[69.48192596435547, 231.08229064941406, 0],[69.23497772216797, 230.27285766601562, 0],[68.86455535888672, 229.49085998535156, 0],[67.7944564819336, 229.0106964111328, 0],[66.66948699951172, 229.05184936523438, 0]] ;
var point_infA1ext = [[66.66948699951172, 229.05184936523438, -36],[65.73657989501953, 229.60061645507812, -36],[65.21524810791016, 230.43748474121094, -36],[65.06433868408203, 231.32923889160156, -36],[65.311279296875, 232.09751892089844, -36],[65.81889343261719, 232.74232482910156, -36],[66.60089111328125, 233.12644958496094, -36],[67.87677764892578, 233.16761779785156, -36],[68.7410888671875, 232.632568359375, -36],[69.33100891113281, 231.85057067871094, -36],[69.48192596435547, 231.08229064941406, -36],[69.23497772216797, 230.27285766601562, -36],[68.86455535888672, 229.49085998535156, -36],[67.7944564819336, 229.0106964111328, -36],[66.66948699951172, 229.05184936523438, -36]];
var micA1ext = generateMicrotubule(point_supA1ext,point_infA1ext);

//Microtubule  A1 int
var point_supA1int = [[66.83411407470703, 229.6280517578125, 0],[66.09327697753906, 229.97103881835938, 0],[65.7777328491211, 230.5472412109375, 0],[65.64054107666016, 231.2880859375, 0],[65.83261108398438, 231.9466094970703, 0],[66.13443756103516, 232.23471069335938, 0],[66.6969223022461, 232.59140014648438, 0],[67.71214294433594, 232.6188507080078, 0],[68.43926239013672, 232.207275390625, 0],[68.68621063232422, 231.6584930419922, 0],[68.85083770751953, 231.0411376953125, 0],[68.75480651855469, 230.39633178710938, 0],[68.4529800415039, 229.90243530273438, 0],[67.72586059570312, 229.55946350097656, 0],[66.83411407470703, 229.6417694091797, 0],[66.83411407470703, 229.6280517578125, 0]] ;
var point_infA1int = [[66.83411407470703, 229.6280517578125, -36],[66.09327697753906, 229.97103881835938, -36],[65.7777328491211, 230.5472412109375, -36],[65.64054107666016, 231.2880859375, -36],[65.83261108398438, 231.9466094970703, -36],[66.13443756103516, 232.23471069335938, -36],[66.6969223022461, 232.59140014648438, -36],[67.71214294433594, 232.6188507080078, -36],[68.43926239013672, 232.207275390625, -36],[68.68621063232422, 231.6584930419922, -36],[68.85083770751953, 231.0411376953125, -36],[68.75480651855469, 230.39633178710938, -36],[68.4529800415039, 229.90243530273438, -36],[67.72586059570312, 229.55946350097656, -36],[66.83411407470703, 229.6417694091797, -36],[66.83411407470703, 229.6280517578125, -30]];
var micA1int = generateMicrotubule(point_supA1int,point_infA1int);

var volume = BEZIER (S2)([micA1ext,micA1int]);
var volumeMap_microtubeA1 =  COLOR(mattAquamarine)(MAP(volume)(domain3));
DRAW (volumeMap_microtubeA1);

//Microtubule  A2
var volumeMap_microtubeA2 = T([0,1])([3.8,-2])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeA2);
//Microtubule  A3
var volumeMap_microtubeA3 = T([0,1])([7.8,-3.2])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeA3);

//Microtubule triplet B

//Microtubule  b1
var volumeMap_microtubeB1 = T([0,1])([16.2,-8])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeB1);
//Microtubule B2
var volumeMap_microtubeB2 = T([0,1])([18,-11.8])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeB2);
//Microtubule B3
var volumeMap_microtubeB3 = T([0,1])([19,-15.8])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeB3);

//Microtubule triplet C

//Microtubule  C1
var volumeMap_microtubeC1 = T([0,1])([22,-22])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeC1);
//Microtubule C2
var volumeMap_microtubeC2 = T([0,1])([19.9,-25])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeC2);
//Microtubule C3
var volumeMap_microtubeC3 = T([0,1])([17.8,-28])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeC3);


//Microtubule triplet D

//Microtubule D1
var volumeMap_microtubeD1 = T([0,1])([17.5,-36])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeD1);
//Microtubule D2
var volumeMap_microtubeD2 = T([0,1])([13.9,-38])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeD2);
//Microtubule D3
var volumeMap_microtubeD3 = T([0,1])([10.5,-40])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeD3);


//Microtubule triplet E

//Microtubule E1
var volumeMap_microtubeE1 = T([0,1])([4,-48])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeE1);
//Microtubule E2
var volumeMap_microtubeE2 = T([0,1])([0.5,-47])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeE2);
//Microtubule E3
var volumeMap_microtubeE3 = T([0,1])([-3.5,-46])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeE3);

//Microtubule triplet F

//Microtubule F1
var volumeMap_microtubeF1 = T([0,1])([-15,-44])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeF1);
//Microtubule F2
var volumeMap_microtubeF2 = T([0,1])([-17,-41])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeF2);
//Microtubule F3
var volumeMap_microtubeF3 = T([0,1])([-18.5,-38])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeF3);

//Microtubule triplet G

//Microtubule G1
var volumeMap_microtubeG1 = T([0,1])([-26,-33])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeG1);
//Microtubule G2
var volumeMap_microtubeG2 = T([0,1])([-25,-29])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeG2);
//Microtubule G3
var volumeMap_microtubeG3 = T([0,1])([-24,-25])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeG3);

//Microtubule triplet H
//Microtubule H1
var volumeMap_microtubeH1 = T([0,1])([-25,-17])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeH1);
//Microtubule H2
var volumeMap_microtubeH2 = T([0,1])([-22,-14])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeH2);
//Microtubule H3
var volumeMap_microtubeH3 = T([0,1])([-19,-11])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeH3);

//Microtubule triplet I
//Microtubule I1
var volumeMap_microtubeI1 = T([0,1])([-15,-5])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeI1);
//Microtubule I2
var volumeMap_microtubeI2 = T([0,1])([-11,-4])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeI2);
//Microtubule I3
var volumeMap_microtubeI3 = T([0,1])([-7,-3])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeI3);


/* This function generates and draws a set of parallel lines. It takes in input an array of control points.  
 
   INPUT - An array of control points.

*/
function replicaPoly(p1){
  
var p2 = p1.map(function (p) {return [p[0], p[1], p[2]-4]});
var p3 = p2.map(function (p) {return [p[0], p[1], p[2]-4]});
var p4 = p3.map(function (p) {return [p[0], p[1], p[2]-4]});
var p5 = p4.map(function (p) {return [p[0], p[1], p[2]-4]});
var p6 = p5.map(function (p) {return [p[0], p[1], p[2]-4]});
var p7 = p6.map(function (p) {return [p[0], p[1], p[2]-4]});
var p8 = p7.map(function (p) {return [p[0], p[1], p[2]-4]});

var poly1 = POLYLINE(p1);
var poly2 = POLYLINE(p2);
var poly3 = POLYLINE(p3);
var poly4 = POLYLINE(p4);
var poly5 = POLYLINE(p5);
var poly6 = POLYLINE(p6);
var poly7 = POLYLINE(p7);
var poly8 = POLYLINE(p8);
var str_poly =STRUCT([poly1,poly2,poly3,poly4,poly5,poly6,poly7,poly8]);
DRAW(str_poly);
}

//Protein arms I-A
var p1 = [[61.995713806152344, 228.00794982910156, -4],[65.21707000732422, 231.3988037109375, -4]];
replicaPoly(p1);
//Protein arms A-B
var p1 =[[81.97642364501953,224.37355041503906, -4],[76.81997680664062,227.64761352539062,-4]];
replicaPoly(p1);
// Protein arms B-C
var p1 = [[88.78474426269531, 210.5489959716797, -4],[86.69847106933594, 213.36883544921875, -4]];
replicaPoly(p1);
//Protein arms C-D
var p1 = [[83.73897552490234, 202.5671691894531, -4],[86.25423431396484, 196.0900573730469, -4]];
replicaPoly(p1);
//Protein arms D-E
var p1 = [[73.15452194213867, 183.1868591308594, -4],[75.99959945678711, 190.78076171875, -4]];
replicaPoly(p1);
//Protein arms E-F
var p1 = [[62.15452194213867, 185.1868591308594, -4],[53.49959945678711, 185.78076171875, -4]];
replicaPoly(p1);
//Protein arms F-G
var p1 = [[47.03483200073242, 193.01904296875, -4],[43.19974136352539, 196.81597900390625, -4]];
replicaPoly(p1);
//Protein arms G-H
var p1 = [[42.184486389160156, 212.1962890625, -4],[43.076856994628906, 207.9810302734375, -4]];
replicaPoly(p1);
//Protein arms H-I
var p1 = [[50.682125091552734, 225.60711669921875, -4],[49.39280700683594, 220.9674530029297, -4]];
replicaPoly(p1);

/*************************************************************LYSOSOME TO THE LEFT OF THE PAIR OF MITHOCONDRIA**********************************************/

//Outer Control point 
  var cp1 =  [[162.1141815185547, 103.88532257080078, 0],[166.30323791503906, 103.75019073486328, 0],[172.2489776611328, 103.75019073486328, 0],[177.24880981445312, 103.75019073486328, 0]];
  var cp2 =  [[154.4117431640625, 107.93923950195312, 0],[164.00601196289062, 107.80410766601562, -9],[175.2218475341797, 107.80410766601562, -9],[184.14047241210938, 108.07437133789062, 0]];
  var cp3 =  [[149.9524383544922, 111.85802459716797, 0],[162.1141815185547, 111.99315643310547, -16],[176.7082977294922, 111.85802459716797, -16],[189.0051727294922, 112.26341247558594, 0]];
  var cp4 =  [[146.5741729736328, 116.99298858642578, 0],[159.9521026611328, 117.26324462890625, -19],[178.87037658691406, 116.85785675048828, -19],[192.38343811035156, 116.99298858642578, 0]];
  var cp5 =  [[144.27694702148438, 122.80360412597656, 0],[158.60079956054688, 123.07386016845703, -20],[181.302734375, 123.34412384033203, -20],[195.35630798339844, 123.47925567626953, 0]];
  var cp6 =  [[144.27694702148438, 130.77630615234375, 0],[158.46566772460938, 130.64117431640625, -20],[181.302734375, 130.91143798828125, -20],[195.49143981933594, 131.45196533203125, 0]];
  var cp7 =  [[146.7093048095703, 136.9923095703125, 0],[160.49261474609375, 137.2625732421875, -19],[179.00550842285156, 137.938232421875, -19],[192.92396545410156, 139.01927185058594, 0]];
  var cp8 =  [[149.5470428466797, 143.61370849609375, 0],[163.1952362060547, 143.61370849609375, -16],[176.5731658935547, 143.61370849609375, -16],[189.1403045654297, 144.9650115966797, 0]];
  var cp9 =  [[154.276611328125, 147.80276489257812, 0],[165.35731506347656, 148.07302856445312, -9],[173.87054443359375, 148.07302856445312, -9],[184.95126342773438, 148.74867248535156, 0]];
  var cp10 =  [[162.5195770263672, 152.66746520996094, 0],[167.38427734375, 152.66746520996094, 0],[172.7895050048828, 152.53233337402344, 0],[177.24880981445312, 152.26206970214844, 0]];

var volumeOut = createCurveSurface([169.41123962402344, 103.88532257080078, 0],[169.95176696777344, 152.66746520996094, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10]);
DRAW(COLOR(mattGold)(MAP(volumeOut)(domain2)));

 //Inner Control point 

  var cp1 =  [[162.5195770263672, 106.45279693603516, 0],[167.5194091796875, 106.45279693603516, 0],[171.84359741210938, 106.58792877197266, 0],[176.97854614257812, 106.58792877197266, 0]];
  var cp2 =  [[154.817138671875, 111.99315643310547, 0],[162.1141815185547, 111.99315643310547, -7],[176.7082977294922, 111.85802459716797, -7],[184.95126342773438, 111.99315643310547, 0]];
  var cp3 =  [[150.3578338623047, 117.39837646484375, 0],[159.9521026611328, 117.26324462890625, -15],[179.54603576660156, 117.53350830078125, -15],[190.08621215820312, 117.80377197265625, 0]];
  var cp4 =  [[147.92547607421875, 123.34412384033203, 0],[159.1413116455078, 123.74951934814453, -18],[181.1676025390625, 124.1549072265625, -18],[192.38343811035156, 124.019775390625, 0]];
  var cp5 =  [[147.92547607421875, 130.91143798828125, 0],[158.46566772460938, 130.64117431640625, -18],[181.302734375, 130.91143798828125, -18],[192.11317443847656, 131.04656982421875, 0]];
  var cp6 =  [[150.0875701904297, 136.7220458984375, 0],[160.49261474609375, 137.2625732421875, -16],[179.00550842285156, 137.938232421875, -16],[189.6808319091797, 138.34361267089844, 0]];
  var cp7 =  [[154.1414794921875, 143.61370849609375, 0],[163.73574829101562, 144.15423583984375, -7],[175.7623748779297, 144.42449951171875, -7],[185.08639526367188, 144.69476318359375, 0]];
  var cp8 =  [[163.0601043701172, 149.28919982910156, 0],[167.2491455078125, 149.42433166503906, 0],[171.9787139892578, 149.42433166503906, 0],[176.1677703857422, 149.42433166503906, 0]];
  
var volumeIn = createCurveSurface([169.81663513183594, 106.45279693603516, 0],[169.54637145996094, 149.28919982910156, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8]);
//DRAW(volumeIn);

var lysosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
DRAW(COLOR(mattLightYellow)(lysosome3D));

/******************************************************************PAIR OF LYSOSOMES ABOVE THE CENTRIOLE*****************************************************/
//Outer Control point 
  var cp1 =  [[78.77911376953125, 153.96864318847656, 0],[82.96263885498047, 153.9113311767578, 0],[86.5157699584961, 153.85401916503906, 0],[90.98583221435547, 153.85401916503906, 0]];
  var cp2 =  [[74.13711547851562, 156.9486846923828, 0],[81.07145690917969, 156.8340606689453, -8],[88.52156829833984, 156.66213989257812, -8],[94.88282012939453, 156.37559509277344, 0]];
  var cp3 =  [[71.50092315673828, 159.69949340820312, 0],[78.7218017578125, 159.4702606201172, -14],[90.58467864990234, 159.35565185546875, -14],[97.46170043945312, 159.1837158203125, 0]];
  var cp4 =  [[69.89628601074219, 163.0233917236328, 0],[77.1171646118164, 162.96607971191406, -18],[92.36124420166016, 162.5076141357422, -18],[99.52481079101562, 162.45030212402344, 0]];
  var cp5 =  [[69.20858001708984, 166.6338348388672, 0],[76.20022583007812, 166.28997802734375, -20],[93.79395294189453, 166.00343322753906, -20],[100.6136703491211, 165.94613647460938, 0]];
  var cp6 =  [[69.2658920288086, 170.35888671875, 0],[76.14291381835938, 170.1869659423828, -20],[93.73664855957031, 169.78579711914062, -20],[100.7282943725586, 169.5565643310547, 0]];
  var cp7 =  [[70.60904693603516, 174.27346801757812, 0],[77.2890853881836, 174.25587463378906, -18],[92.53316497802734, 173.74009704589844, -18],[99.69673919677734, 173.45355224609375, 0]];
  var cp8 =  [[72.24593353271484, 177.5224609375, 0],[78.60718536376953, 177.57977294921875, -14],[90.8712158203125, 177.4078369140625, -14],[97.86286163330078, 177.12130737304688, 0]];
  var cp9 =  [[74.710205078125, 180.559814453125, 0],[81.01414489746094, 180.6744384765625, -8],[88.57887268066406, 180.559814453125, -8],[94.88282012939453, 180.559814453125, 0]];
  var cp10 =  [[78.95103454589844, 183.4825439453125, 0],[83.07725524902344, 183.53985595703125, 0],[86.34384155273438, 183.59716796875, 0],[90.92852783203125, 183.53985595703125, 0],];

var volumeOut = createCurveSurface([84.84607696533203, 153.96864318847656, 0],[84.74455261230469, 183.4825439453125, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10]);
var volumeOutMap=(COLOR(mattGold)(MAP(volumeOut)(domain2)));
DRAW(volumeOutMap);

 //Inner Control point 

  var cp1 =  [[80.1759033203125, 156.49356079101562, 0],[83.32319641113281, 156.49356079101562, 0],[86.77506256103516, 156.49356079101562, 0],[90.83609008789062, 156.49356079101562, 0]];
  var cp2 =  [[76.21640014648438, 160.53933715820312, 0],[81.69878387451172, 160.23475646972656, -6],[87.48574829101562, 160.1332244873047, -6],[93.272705078125, 160.93017578125, 0]];
  var cp3 =  [[73.67826080322266, 162.88967895507812, 0],[80.1759033203125, 162.68663024902344, -10],[89.00862884521484, 162.48358154296875, -10],[96.21694946289062, 162.1790008544922, 0]];
  var cp4 =  [[73.06910705566406, 166.24002075195312, 0],[78.95759582519531, 166.03697204589844, -14],[90.02388763427734, 165.83392333984375, -14],[97.13067626953125, 165.73239135742188, 0]];
  var cp5 =  [[72.96758270263672, 170.09799194335938, 0],[78.95759582519531, 170.09799194335938, -14],[89.92235565185547, 169.79342651367188, -14],[97.53678131103516, 169.8949432373047, 0]];
  var cp6 =  [[74.49046325683594, 174.0574951171875, 0],[80.1759033203125, 173.8544464111328, -10],[88.9071044921875, 173.44834899902344, -10],[96.623046875, 173.54986572265625, 0]];
  var cp7 =  [[76.82555389404297, 177.50936889648438, 0],[82.00336456298828, 177.2047882080078, -6],[87.79032135009766, 177.2047882080078, -6],[93.78033447265625, 177.103271484375, 0]];
  var cp8 =  [[78.7545394897461, 179.53988647460938, 0],[83.62776947021484, 179.6414031982422, 0],[86.87659454345703, 179.6414031982422, 0],[90.32846069335938, 179.4383544921875, 0]];
  
var volumeIn = createCurveSurface([85.04913330078125, 156.49356079101562, 0],[85.35370635986328, 179.53988647460938, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8]);
//DRAW(volumeIn);

var lysosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
var lysosome3Dmap=(COLOR(mattLightYellow)(lysosome3D));
DRAW (lysosome3Dmap);

var lysosome3Dstructure = STRUCT ([volumeOutMap,lysosome3Dmap,]);
var lysosome3DstructureT =  T([0,1])([45,23])(lysosome3Dstructure);
DRAW(lysosome3DstructureT);

/********************************************************************LYSOSOME SMALLER ABOVE THE CENTRIOLE******************************************************/
//Outer Control point 
  var cp1 =  [[55.283721923828125, 185.0208282470703, 0],[58.72223663330078, 184.9062042236328, 0],[60.49879837036133, 184.84889221191406, 0],[64.39578247070312, 184.9062042236328, 0]];
  var cp2 =  [[51.44404602050781, 187.31317138671875-1, 0],[56.48720169067383, 187.02662658691406-1, -8],[62.73383331298828, 186.91200256347656-1, -8],[67.71968078613281, 187.02662658691406-1, 0]];
  var cp3 =  [[49.14259719848633, 191.255126953125, 0],[53.33523178100586, 191.21014404296875, -13],[65.54195404052734, 191.2674560546875, -13],[70.52780151367188, 191.2674560546875, 0]];
  var cp4 =  [[48.4640007019043, 194.87789916992188, 0],[52.360984802246094, 194.82058715820312, -14],[67.37582397460938, 194.5913543701172, -14],[70.81433868408203, 194.5913543701172, 0]];
  var cp5 =  [[49.15170669555664, 198.94680786132812, 0],[54.53871154785156, 198.83218383789062, -13],[65.4846420288086, 198.7175750732422, -13],[70.35587310791016, 198.77487182617188, 0]];
  var cp6 =  [[51.673282623291016, 202.84378051757812, 0],[56.716434478759766, 202.90109252929688, -8],[63.13499450683594, 202.90109252929688, -8],[68.6366195678711, 202.84378051757812, 0]];
  var cp7 =  [[56.20065689086914, 205.7665252685547, 0],[59.23801040649414, 205.7665252685547, 0],[60.61341857910156, 205.82383728027344, 0],[63.30691909790039, 205.7665252685547, 0]];
  
var volumeOut = createCurveSurface([59.663516998291016, 183.93405151367188+0.5, 0],[59.93377685546875, 206.635986328125-1, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7]);
//DRAW(COLOR(mattGold)(MAP(volumeOut)(domain2)));

 //Inner Control point 

  var cp1 =  [[56.15011978149414, 187.98797607421875, 0],[58.17707824707031, 187.98797607421875, 0],[60.87969207763672, 187.98797607421875, 0],[63.04178237915039, 187.98797607421875, 0]];
  var cp2 =  [[53.042118072509766, 190.96084594726562, 0],[56.28525161743164, 190.82571411132812, -9],[62.636390686035156, 190.69058227539062, -9],[66.55517578125, 190.69058227539062, 0]];
  var cp3 =  [[51.96107482910156, 194.4742431640625, 0],[55.33933639526367, 194.4742431640625, -11],[63.312042236328125, 194.06884765625, -11],[67.90647888183594, 193.9337158203125, 0]];
  var cp4 =  [[52.50159454345703, 198.5281524658203+2, 0],[57.77168655395508, 198.12277221679688+2, -9],[62.09586715698242, 198.12277221679688+2, -9],[67.36595916748047, 198.12277221679688+2, 0]];
  var cp5 =  [[55.60960006713867, 201.23077392578125+2, 0],[58.98786544799805, 201.36590576171875+2, 0],[61.01482391357422, 201.36590576171875+2, 0],[64.3930892944336, 201.23077392578125+2, 0]];
  
var volumeIn = createCurveSurface([59.663516998291016, 187.17718505859375+0.5, 0],[60.06890869140625, 202.1766815185547-1, 0],[cp1,cp2,cp3,cp4]);
//DRAW(volumeIn);

var lysosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
var Tlysosome3D = T ([1])([+80])(lysosome3D);
DRAW(COLOR(mattLightYellow)(Tlysosome3D));

/******************************************************************LYSOSOME UNDER BIG MITHOCONDRION***********************************************************/
 //Outer Control point 
  var cp1 =  [[117.40863800048828,  481.0681457519531-1,  0],[120.78690338134766,  481.9330139160156-1,  0],[124.03003692626953,  481.933013916015-1,  0],[127.6785659790039,  481.7978820800781-1,  0]];
  var cp2 =  [[112.67906951904297,  484.1761474609375,  0],[119.43560028076172,  483.50048828125,  -10],[126.05699920654297,  483.50048828125,  -10],[132.4081268310547,  483.230224609375,  0]];
  var cp3 =  [[110.38185119628906,  486.6084899902344,  0],[117.27350616455078,  486.4733581542969,  -11],[127.81369018554688,  486.3382263183594,  -11],[134.97561645507812,  485.9328308105469,  0]];
  var cp4 =  [[108.08462524414062,  490.12188720703125,  0],[115.78707122802734,  490.12188720703125,  -15],[129.7055206298828,  489.31109619140625,  -15],[136.73231506347656,  489.04083251953125,  0]];
  var cp5 =  [[107.27384185791016,  493.7704162597656,  0],[115.11141967773438,  493.2298889160156,  -16],[130.5163116455078,  492.5542297363281,  -16],[138.0836181640625,  492.2839660644531,  0]];
  var cp6 =  [[107.27871765136719,  497.689208984375,  0],[115.24655151367188,  497.5540771484375,  -16],[130.1109161376953,  497.148681640625,  -16],[138.6241455078125,  497.0135498046875,  0]];
  var cp7 =  [[108.08950103759766,  501.7431335449219,  0],[116.32759094238281,  501.7431335449219,  -15],[129.5703887939453,  501.6080017089844,  -15],[137.13771057128906,  502.55389404296875,  0]];
  var cp8 =  [[110.24671936035156,  505.2565002441406,  0],[117.40863800048828,  505.6618957519531,  -11],[128.21908569335938,  505.5267639160156,  -11],[135.38101196289062,  505.6618957519531,  0]];
  var cp9 =  [[112.67958923339844,  508.905029296875,  0],[119.16533660888672,  509.0401611328125,  -10],[126.46238708496094,  508.905029296875,  -10],[132.8135223388672,  509.0401611328125,  0]];
  var cp10 =  [[117.67890167236328,  510.796875,  0],[120.78690338134766,  510.796875,  0],[124.16516876220703,  510.796875,  0],[128.08395385742188,  510.6617431640625,  0]];

var volumeOut = createCurveSurface([122.5436019897461, 480.8519592285156+0.5, 0],[122.6787338256836, 511.148193359375-0.5, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10]);
DRAW(COLOR(mattGold)(MAP(volumeOut)(domain2)));

 //Inner Control point 

  var cp1 =  [[117.70804595947266,  483.8537902832031+0.5,  0],[120.68287658691406,  483.7774963378906+1,  0],[124.42047882080078,  483.70123291015625+1,  0],[127.70042419433594,  483.70123291015625+1,  0]];
  var cp2 =  [[113.9704360961914,  486.52349853515625,  0],[118.9284896850586,  486.44720458984375,  -8],[126.17487335205078,  486.1421203613281,  -8],[130.8278045654297,  486.0658264160156,  0]];
  var cp3 =  [[111.30072021484375,  490.1085510253906,  0],[117.25038146972656,  489.87969970703125,  -13],[127.92926025390625,  489.42205810546875,  -13],[134.18402099609375,  489.42205810546875,  0]];
  var cp4 =  [[110.38538360595703,  493.38848876953125,  0],[115.11141967773438,  493.2298889160156,  -14],[129.83619689941406,  492.85455322265625,  -14],[135.63330078125,  492.77825927734375,  0]];
  var cp5 =  [[110.38538360595703,  497.5837707519531,  0],[115.24655151367188,  497.5540771484375,  -14],[129.83619689941406,  496.9735412597656,  -14],[135.32818603515625,  496.8972473144531,  0]];
  var cp6 =  [[112.36860656738281,  501.62646484375,  0],[117.63176727294922,  501.47393798828125,  -13],[128.31063842773438,  501.2450866699219,  -13],[133.87892150878906,  501.092529296875,  0]];
  var cp7 =  [[114.80949401855469,  504.90643310546875,  0],[119.15731811523438,  505.13525390625,  -8],[126.70881652832031,  505.13525390625,  -8],[130.75152587890625,  504.9826965332031,  0]];
  var cp8 =  [[118.4708251953125,  507.4998474121094,  0],[121.29309844970703,  507.4998474121094,  0],[124.6493148803711,  507.3473205566406,  0],[128.08181762695312,  507.19476318359375,  0]];
  
var volumeIn = createCurveSurface([122.5898208618164,  483.1672668457031+0.5,  0],[123.0474853515625,  508.0338134765625-0.5,  0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8]);
//DRAW(volumeIn);

var lisosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
DRAW(COLOR(mattLightYellow)(lisosome3D));

/****************************************************************************LYSOSOME ABOVE BIG MITHOCONDRION******************************************/

 //Outer Control point 
  var cp1 =  [[31.58462142944336, 302.5011901855469-1, 0],[34.16350555419922, 302.5011901855469-1, 0],[36.22661590576172, 302.5011901855469-1, 0],[39.14935302734375, 302.3865661621094-1,  0]];
  var cp2 =  [[28.08880043029785, 304.4496765136719, 0],[32.90271759033203, 304.4496765136719, -8],[37.37278747558594, 304.27777099609375, -8],[42.53055953979492, 304.6216125488281,  0]];
  var cp3 =  [[25.28067970275879, 307.08587646484375, 0],[31.12615394592285, 307.1431884765625, -9],[38.86280822753906, 306.97125244140625, -9],[45.3959846496582, 307.20050048828125,  0]];
  var cp4 =  [[23.160263061523438, 310.23785400390625, 0],[29.979982376098633, 309.89398193359375, -12],[40.12359619140625, 309.5501403808594, -12],[47.11524200439453,  309.9512939453125,  0]];
  var cp5 =  [[22.300634384155273, 313.5044250488281, 0],[28.719194412231445, 313.16058349609375, -13],[41.556312561035156, 312.8740539550781, -13],[48.03218078613281,  313.103271484375,  0]];
  var cp6 =  [[22.47256088256836, 316.7710266113281, 0],[28.661884307861328, 316.4844665527344, -13],[41.49900436401367, 315.9114074707031, -13],[48.37602996826172, 315.9114074707031,  0]];
  var cp7 =  [[23.618730545043945, 319.9230041503906, 0],[29.979982376098633, 319.6364440917969, -12],[40.238216400146484, 319.00604248046875, -12],[47.97487258911133,  318.6622009277344,  0]];
  var cp8 =  [[25.395296096801758, 322.38726806640625, 0],[31.47000503540039, 322.15802001953125, -9],[38.80550003051758, 321.8714904785156, -9],[46.82870101928711, 321.6995544433594,  0]];
  var cp9 =  [[27.74494743347168, 324.9088439941406, 0],[33.2465705871582, 324.7942199707031, -8],[37.143550872802734, 324.6795959472656, -8],[43.39018630981445, 324.45037841796875,  0]];
  var cp10 =  [[31.35538673400879, 327.0865783691406, 0],[34.27812576293945, 327.0292663574219, 0],[36.34123229980469, 327.0292663574219, 0],[38.748191833496094, 326.9719543457031,  0]];

var volumeOut = createCurveSurface([35.19506072998047,  301.9281005859375+0.1,  0],[35.36698532104492,  327.5450439453125-0.5,  0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10]);
DRAW(COLOR(mattGold)(MAP(volumeOut)(domain2)));

 //Inner Control point 

  var cp1 =  [[31.97028923034668, 305.44268798828125, 0],[34.09070587158203, 305.3853759765625, 0],[36.612281799316406, 305.32806396484375, 0],[39.42040252685547, 305.21343994140625,  0]];
  var cp2 =  [[29.448713302612305, 307.3338623046875, 0],[32.42875671386719, 307.0473327636719, -5],[38.04499816894531, 307.0473327636719, -5],[42.11390686035156, 307.1046447753906,  0]];
  var cp3 =  [[27.21367835998535, 310.0273742675781, 0],[31.339895248413086, 310.0846862792969, -10],[40.05079650878906, 309.56890869140625, -10],[44.005088806152344, 309.45428466796875,  0]];
  var cp4 =  [[26.525976181030273, 313.2366638183594, 0],[29.620637893676758, 313.2366638183594, -11],[41.556312561035156, 312.8740539550781, -11],[45.781654357910156, 312.8927917480469,  0]];
  var cp5 =  [[26.583284378051758, 316.1593933105469, 0],[29.563329696655273, 316.1020812988281, -11],[41.48351287841797, 315.700927734375, -11],[45.6097297668457, 315.64361572265625,  0]];
  var cp6 =  [[27.500221252441406, 318.6236572265625, 0],[30.365650177001953, 318.68096923828125, -10],[40.91042709350586, 318.45172119140625,-10],[45.15126037597656, 318.2225036621094,  0]];
  var cp7 =  [[29.39140510559082, 320.9159851074219, 0],[32.829917907714844, 321.0879211425781, -5],[39.19116973876953, 321.0306091308594, -5],[43.317386627197266, 320.85870361328125,  0]];
  var cp8 =  [[31.74105453491211, 322.9790954589844, 0],[34.721099853515625, 323.0937194824219, 0],[37.58652877807617, 323.0937194824219, 0],[40.56657409667969, 322.9790954589844,  0]];
  
var volumeIn = createCurveSurface([35.294185638427734, 304.9842224121094+0.5, 0],[36.211124420166016, 323.55218505859375-0.5, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8]);
//DRAW(volumeIn);

var lysosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
DRAW(COLOR(mattLightYellow)(lysosome3D)); 

/************************************************************************ VACUOLE **********************************************************/
//Outer Control point 
  var cp1 =  [[151.8223114013672, 372.81591796875, 0],[154.36044311523438, 372.81591796875, 0],[156.59400939941406, 372.81591796875, 0],[158.82757568359375, 372.81591796875, 0]];
  var cp2 =  [[147.5582275390625, 376.36932373046875, 0],[151.4162139892578, 376.36932373046875, -10],[156.1879119873047, 376.36932373046875, -10],[161.26419067382812, 376.36932373046875, 0]];
  var cp3 =  [[145.22314453125, 380.02423095703125, 0],[149.89332580566406, 379.71966552734375, -14],[156.1879119873047, 379.6181335449219, -14],[161.6702880859375, 379.3135681152344, 0]];
  var cp4 =  [[143.0911102294922, 384.1867980957031, 0],[148.06585693359375, 383.7806701660156, -15],[156.39096069335938, 383.4761047363281, -15],[160.3504638671875, 383.4761047363281, 0]];
  var cp5 =  [[141.16212463378906, 388.8569641113281, 0],[146.13687133789062, 388.45086669921875, -19],[155.27418518066406, 387.9432373046875, -19],[159.03062438964844, 387.9432373046875, 0]];
  var cp6 =  [[140.75601196289062, 392.9179992675781, 0],[145.62924194335938, 392.81646728515625, -20],[154.66502380371094, 392.4103698730469, -20],[158.92910766601562, 392.2073059082031, 0]];
  var cp7 =  [[141.0605926513672, 397.8927307128906, 0],[146.74603271484375, 397.48663330078125, -19],[156.1879119873047, 396.97900390625, -19],[161.5687713623047, 396.5729064941406, 0]];
  var cp8 =  [[142.0758514404297, 402.2583312988281, 0],[147.65975952148438, 401.750732421875, -15],[158.01536560058594, 401.4461364746094, -15],[163.80233764648438, 401.3446044921875, 0]];
  var cp9 =  [[143.39569091796875, 406.3193664550781, 0],[149.69027709960938, 406.0148010253906, -14],[157.71080017089844, 405.5071716308594, -14],[163.7008056640625, 404.89801025390625, 0]];
  var cp10 =  [[146.74603271484375, 409.56817626953125, 0],[152.32994079589844, 409.4666748046875, -10],[156.49249267578125, 409.3651428222656, -10],[162.27944946289062, 409.060546875, 0]];
  var cp11 =  [[149.89332580566406, 412.2078552246094, 0],[153.44671630859375, 412.2078552246094, 0],[155.88333129882812, 412.1063232421875, 0],[159.03062438964844, 412.0047912597656, 0]];

var volumeOut = createCurveSurface([155.57875061035156, 372.00372314453125+0.5, 0],[154.66502380371094, 413.32464599609375-1, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp11]);
DRAW(COLOR(mattDarkOrange)(MAP(volumeOut)(domain2)));

 //Inner Control point 
  var cp0 = [[153.1421356201172,374.846435546875,0],[154.66502380371094,375.0494689941406,0],[155.7818145751953,375.1510009765625,0],[157.0001220703125,375.2525329589844,0]]
  var cp1 =  [[151.11163330078125, 376.876953125, 0],[153.04061889648438, 376.97845458984375, -8],[155.1726531982422, 377.0799865722656, -8],[158.01536560058594, 377.38458251953125, 0]];
  var cp2 =  [[148.3704376220703, 380.227294921875, 0],[151.923828125, 379.71966552734375, -9],[154.66502380371094, 379.8211975097656, -9],[158.5229949951172, 379.71966552734375, 0]];
  var cp3 =  [[147.253662109375, 383.57763671875, 0],[150.19790649414062, 383.57763671875, -15],[154.56350708007812, 383.57763671875, -15],[158.3199462890625, 383.57763671875, 0]];
  var cp4 =  [[145.12161254882812, 388.45086669921875, 0],[148.3704376220703, 388.45086669921875, -16],[155.27418518066406, 387.9432373046875, -16],[157.91384887695312, 388.0447692871094, 0]];
  var cp5 =  [[144.0048370361328, 392.9179992675781, 0],[145.62924194335938, 392.81646728515625, -16],[154.66502380371094, 392.4103698730469, -16],[157.91384887695312, 392.2073059082031, 0]];
  var cp6 =  [[144.2078857421875, 397.689697265625, 0],[146.74603271484375, 397.48663330078125, -15],[156.1879119873047, 396.97900390625, -15],[158.72605895996094, 396.87750244140625, 0]];
  var cp7 =  [[144.51246643066406, 401.85223388671875, 0],[147.65975952148438, 401.750732421875, -9],[158.01536560058594, 401.4461364746094, -9],[161.06114196777344, 401.24310302734375, 0]];
  var cp8 =  [[145.62924194335938, 406.1163330078125, 0],[149.69027709960938, 406.0148010253906, -8],[157.71080017089844, 405.5071716308594, -8],[161.4672393798828, 405.20257568359375, 0]];
  var cp9 =  [[148.87806701660156, 409.56817626953125, 0],[152.32994079589844, 409.4666748046875, 0],[156.49249267578125, 409.3651428222656, 0],[160.1474151611328, 409.26361083984375, 0]];

var volumeIn = createCurveSurface([155.1726531982422-1,374.4403381347656+1.5,0],[154.66502380371094, 410.27886962890625, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9]);
//DRAW(volumeIn);

var vacuole3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
DRAW(COLOR(mattOrange)(vacuole3D));



/********************************************************************* NUCLEOLUS ******************************************************************/

var nucleolus = BEZIER(S0)([[0,0,0],[30,0,0],[30,0,45],[0,0,45]]);

//var curve0 = MAP(nucleolus)(domain1);
var mapping = ROTATIONAL_SURFACE(nucleolus);
var nucleolusMap = COLOR(mattLightSeaGreen) (T([0,1,2])([280,297,-25]) ((MAP(mapping)(domainCircle))));
DRAW (nucleolusMap)


/********************************************************************* NUCLEUS ******************************************************************/

var nucleus = BEZIER(S0)([[0,0,0],[65,0,0],[65,0,97.5],[0,0,97.5]]);

//var curve0 = MAP(nucleus)(domain1);
var mapping = ROTATIONAL_SURFACE(nucleus);
var nucleusMap = COLOR(mattDarkSeaGreen) (T([0,1,2])([280,297,-60]) ((MAP(mapping)(domainCircle))));
 DRAW (nucleusMap)


 //---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 1 DX-----------------------------------------------------------------------


var controlsUpper = [[187.6236114501953, 248.28280639648438, 0],[187.6236114501953, 248.28280639648438, 0],[190.86106872558594, 249.18209838867188, 0],[194.81796264648438, 248.46266174316406, 0],[198.055419921875, 246.12449645996094, 0],[200.75331115722656, 243.78634643554688, 0],[204.35047912597656, 240.00930786132812, 0],[206.6886444091797, 237.31141662597656, 0],[208.84695434570312, 234.97325134277344, 0],[211.90455627441406, 233.71424865722656, 0],[213.88299560546875, 235.1531219482422, 0],[211.90455627441406, 237.8509979248047, 0],[207.2282257080078, 241.62803649902344, 0],[202.01231384277344, 245.76478576660156, 0],[200.93316650390625, 249.7216796875, 0],[202.55189514160156, 253.1389923095703, 0],[206.3289337158203, 255.6570281982422, 0],[212.08441162109375, 256.0167236328125, 0],[215.32186889648438, 254.93759155273438, 0],[218.19961547851562, 253.49871826171875, 0],[220.89749145507812, 251.3404083251953, 0],[223.41551208496094, 249.7216796875, 0],[225.76597595214844, 247.8705596923828, 0],[227.37240600585938, 246.48422241210938, 0],[229.52243041992188, 244.41868591308594, 0],[231.68902587890625, 242.52732849121094, 0],[233.84732055664062, 240.3690185546875, 0],[237.4445037841797, 237.13156127929688, 0],[239.57347106933594, 234.976806640625, 0],[243.0253448486328, 232.43865966796875, 0],[248.2360382080078, 229.2177734375, 0],[255.43038940429688, 226.5198974609375, 0],[262.21368408203125, 224.11355590820312, 0],[269.99896240234375, 222.92271423339844, 0],[274.49542236328125, 222.20327758789062, 0],[280.79046630859375, 222.20327758789062, 0],[286.9056701660156, 222.3831329345703, 0],[292.4812927246094, 223.28244018554688, 0],[298.9562072753906, 223.64215087890625, 0],[303.9922790527344, 223.64215087890625, 0],[307.9002380371094, 223.19981384277344, 0],[310.03228759765625, 221.06777954101562, 0],[309.8292236328125, 218.52964782714844, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[246.97702026367188, 266.8082580566406, -50],[248.4158935546875, 265.9089660644531, -50],[249.1353302001953, 265.0096740722656, -50],[249.85476684570312, 263.75067138671875, -50],[251.47349548339844, 262.85137939453125, -50],[252.37278747558594, 261.772216796875, -50],[254.17137145996094, 261.05279541015625, -50],[255.79010009765625, 260.69305419921875, -50],[256.68939208984375, 261.2326354980469, -50],[256.8692626953125, 262.1319274902344, -50],[255.79010009765625, 263.3909606933594, -50],[254.53109741210938, 264.829833984375, -50],[253.45193481445312, 266.44854736328125, -50],[253.45193481445312, 267.34783935546875, -50],[253.45193481445312, 268.24713134765625, -50],[253.6317901611328, 268.7867126464844, -50],[254.53109741210938, 268.9665832519531, -50],[256.5095520019531, 268.24713134765625, -50],[258.48797607421875, 266.8082580566406, -50],[260.28656005859375, 266.2686767578125, -50],[261.36572265625, 265.0096740722656, -50],[262.9844665527344, 263.9305114746094, -50],[264.6031799316406, 262.85137939453125, -50],[265.8621826171875, 261.772216796875, -50],[267.3010559082031, 260.69305419921875, -50],[269.4593811035156, 259.25421142578125, -50],[271.9773864746094, 258.5347595214844, -50],[274.8551330566406, 257.4555969238281, -50],[277.19329833984375, 257.2757568359375, -50],[280.4307556152344, 256.9160461425781, -50],[282.7689208984375, 256.9160461425781, -50],[284.5675048828125, 256.9160461425781, -50],[286.3660888671875, 256.9160461425781, -50],[287.9848327636719, 256.7361755371094, -50],[289.4237060546875, 256.0167236328125, -50],[289.9632873535156, 255.29730224609375, -50],[289.7834167480469, 253.67857360839844, -50],[289.6035461425781, 253.31886291503906, -50],[289.0639953613281, 252.95913696289062, -50],[288.1647033691406, 252.59942626953125, -50]];
var nubsUnder = createNubs(controlsUnder);
var Dx1 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[187.6236114501953, 248.28280639648438, 0],[217,249,-40],[247,251,-48],[246.97702026367188, 266.8082580566406, -50]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[309.8292236328125, 218.52964782714844, 0],[300,230,-40],[295,240,-48],[288.1647033691406, 252.59942626953125, -50]];
var bLateral2 = BEZIER(S1)(pointsLateral2);
var bL1Dx = bLateral1;
var bL2Dx = bLateral2;
//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));

//Boundary 

var controlsIntDx = [[188.94554138183594, 246.1443328857422, 0],[191.82327270507812, 246.1443328857422, 0],[194.16143798828125, 245.42489624023438, 0],[195.9600372314453, 243.98602294921875, 0],[197.9384765625, 242.18743896484375, 0],[200.27664184570312, 240.38885498046875, 0],[202.07522583007812, 238.410400390625, 0],[204.59324645996094, 236.25210571289062, 0],[206.75155639648438, 233.55421447753906, 0],[209.0897216796875, 232.2952117919922, 0],[212.5070343017578, 230.85633850097656, 0],[215.56463623046875, 231.03619384765625, 0],[217.3632354736328, 233.73406982421875, 0],[217.3632354736328, 235.7125244140625, 0],[215.20492553710938, 238.410400390625, 0],[212.14732360839844, 240.74856567382812, 0],[209.2695770263672, 242.72702026367188, 0],[206.93141174316406, 244.70545959472656, 0],[204.23353576660156, 247.22348022460938, 0],[203.8738250732422, 249.92137145996094, 0],[206.2119903564453, 251.71995544433594, 0],[208.55014038085938, 251.89981079101562, 0],[211.96746826171875, 252.07968139648438, 0],[216.10421752929688, 250.10122680664062, 0],[219.1618194580078, 248.662353515625, 0],[222.7589874267578, 244.88531494140625, 0],[226.1763153076172, 242.36729431152344, 0],[230.3130645751953, 238.94998168945312, 0],[233.0109405517578, 236.61181640625, 0],[238.58656311035156, 232.47506713867188, 0],[243.62261962890625, 229.0577392578125, 0],[247.03993225097656, 226.89944458007812, 0],[252.0759735107422, 225.10084533691406, 0],[257.2919006347656, 222.9425506591797, 0],[263.5869445800781, 221.50367736816406, 0],[268.9826965332031, 220.06480407714844, 0],[273.47918701171875, 219.5252227783203, 0],[278.155517578125, 219.34536743164062, 0],[284.0908508300781, 219.88494873046875, 0],[287.6880187988281, 220.24465942382812, 0],[292.18450927734375, 220.60438537597656, 0],[297.58026123046875, 221.14395141601562, 0],[302.256591796875, 221.14395141601562, 0],[306.3933410644531, 219.88494873046875, 0]];
var nubsIntDx = createNubs(controlsIntDx);
var boundaryDx = BEZIER(S1)([nubsUpper,nubsIntDx]);
var boundaryDxMap= MAP (boundaryDx)(domain2);
DRAW (COLOR(mattLightYellow)(boundaryDxMap));

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 1 SX-----------------------------------------------------------------------



var controlsUpper = [[187.6236114501953, 248.28280639648438, 0],[185.10195922851562, 246.90902709960938, 0],[184.02279663085938, 244.03128051757812, 0],[185.461669921875, 241.33340454101562, 0],[186.54083251953125, 239.1750946044922, 0],[189.23870849609375, 237.1966552734375, 0],[191.03729248046875, 235.75778198242188, 0],[193.55531311035156, 233.77932739257812, 0],[193.7351837158203, 231.441162109375, 0],[191.93658447265625, 231.08145141601562, 0],[188.51927185058594, 231.80088806152344, 0],[185.461669921875, 233.41961669921875, 0],[181.32492065429688, 234.49876403808594, 0],[178.62704467773438, 233.23976135253906, 0],[175.74929809570312, 232.1605987548828, 0],[173.05142211914062, 229.28286743164062, 0],[171.97225952148438, 226.2252655029297, 0],[172.5118408203125, 223.16766357421875, 0],[174.67015075683594, 221.0093536376953, 0],[177.7277374267578, 219.5704803466797, 0],[180.60548400878906, 219.03091430664062, 0],[182.9436492919922, 218.85105895996094, 0],[187.44012451171875, 219.5704803466797, 0],[190.13800048828125, 220.64964294433594, 0],[192.65602111816406, 221.72879028320312, 0],[194.8143310546875, 223.88710021972656, 0],[197.15249633789062, 225.86553955078125, 0],[199.49066162109375, 227.30441284179688, 0],[202.5482635498047, 228.7432861328125, 0],[205.0662841796875, 228.9231414794922, 0],[206.8648681640625, 227.30441284179688, 0],[205.0662841796875, 224.24681091308594, 0],[201.6489715576172, 222.08851623535156, 0],[202.18853759765625, 218.13162231445312, 0],[204.8864288330078, 215.9733123779297, 0],[209.02317810058594, 214.1747283935547, 0],[213.87936401367188, 212.19627380371094, 0],[217.8362579345703, 211.83656311035156, 0],[221.07371520996094, 212.01641845703125, 0],[223.7716064453125, 214.1747283935547, 0],[225.21046447753906, 216.6927490234375, 0],[223.41188049316406, 219.93020629882812, 0],[222.33273315429688, 222.80795288085938, 0],[221.97300720214844, 225.68568420410156, 0],[223.59173583984375, 226.58497619628906, 0],[226.2896270751953, 226.40512084960938, 0],[228.44793701171875, 224.06695556640625, 0],[231.68539428710938, 221.54893493652344, 0],[234.38327026367188, 219.5704803466797, 0],[235.6422882080078, 217.23233032226562, 0],[237.26101684570312, 213.81500244140625, 0],[238.6998748779297, 211.6566925048828, 0],[239.95889282226562, 209.49839782714844, 0],[242.11720275878906, 206.6206512451172, 0],[246.0740966796875, 203.20333862304688, 0],[249.31155395507812, 201.22488403320312, 0],[253.62815856933594, 198.88671875, 0],[258.1246337890625, 196.9082794189453, 0],[262.62109375, 196.1888427734375, 0],[267.1175842285156, 197.2679901123047, 0],[269.09600830078125, 199.7860107421875, 0],[268.9161682128906, 202.66375732421875, 0],[267.1175842285156, 206.08106994628906, 0],[263.880126953125, 208.2393798828125, 0],[259.5635070800781, 210.21783447265625, 0],[255.78646850585938, 211.83656311035156, 0],[252.00942993164062, 214.1747283935547, 0],[248.5921173095703, 216.33302307128906, 0],[247.51296997070312, 218.4913330078125, 0],[249.4914093017578, 218.6711883544922, 0],[252.00942993164062, 218.6711883544922, 0],[255.96632385253906, 217.23233032226562, 0],[259.7433776855469, 214.8941650390625, 0],[262.2613830566406, 213.45529174804688, 0],[266.2182922363281, 211.6566925048828, 0],[269.09600830078125, 210.21783447265625, 0],[272.6932067871094, 209.31854248046875, 0],[275.5709533691406, 208.59910583496094, 0],[279.8875427246094, 208.4192352294922, 0],[284.5638732910156, 208.9588165283203, 0],[287.981201171875, 209.49839782714844, 0],[292.65753173828125, 209.67825317382812, 0],[295.175537109375, 210.21783447265625, 0],[298.05328369140625, 211.29698181152344, 0],[300.9310302734375, 212.19627380371094, 0],[305.0677795410156, 213.63514709472656, 0],[307.40594482421875, 214.71429443359375, 0],[308.8448181152344, 217.7718963623047, 0],[309.8292236328125, 218.52964782714844, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[246.97702026367188, 266.8082580566406, -60],[245.63967895507812, 266.973876953125, -60],[245.10009765625, 266.6141662597656, -60],[244.74037170410156, 265.8947448730469, -60],[244.9202423095703, 265.17529296875, -60],[245.10009765625, 264.9954528808594, -60],[245.9993896484375, 264.2760009765625, -60],[247.43826293945312, 263.55657958984375, -60],[247.9778289794922, 263.0169982910156, -60],[248.87713623046875, 262.29754638671875, -60],[249.4167022705078, 260.8586730957031, -60],[249.4167022705078, 260.3191223144531, -60],[248.697265625, 260.1392517089844, -60],[247.25840759277344, 260.3191223144531, -60],[245.8195343017578, 261.39825439453125, -60],[245.10009765625, 262.1177062988281, -60],[244.56051635742188, 262.8371276855469, -60],[244.2008056640625, 263.7364196777344, -60],[243.12164306640625, 264.6357116699219, -60],[241.6827850341797, 264.9954528808594, -60],[241.32305908203125, 264.2760009765625, -60],[241.50291442871094, 262.65728759765625, -60],[242.5820770263672, 260.8586730957031, -60],[243.301513671875, 259.779541015625, -60],[244.2008056640625, 259.2399597167969, -60],[244.74037170410156, 258.3406677246094, -60],[244.74037170410156, 257.4413757324219, -60],[243.4813690185547, 256.721923828125, -60],[240.24391174316406, 256.721923828125, -60],[238.98489379882812, 256.721923828125, -60],[237.72589111328125, 256.3622131347656, -60],[237.18630981445312, 255.46292114257812, -60],[237.72589111328125, 254.2039031982422, -60],[238.2654571533203, 253.48446655273438, -60],[239.52447509765625, 253.3046112060547, -60],[241.86264038085938, 253.3046112060547, -60],[243.84107971191406, 254.2039031982422, -60],[244.74037170410156, 255.10321044921875, -60],[245.8195343017578, 256.00250244140625, -60],[247.0785369873047, 256.1823425292969, -60],[247.6181182861328, 256.90179443359375, -60],[249.4167022705078, 256.00250244140625, -60],[249.59657287597656, 255.10321044921875, -60],[249.59657287597656, 253.3046112060547, -60],[249.59657287597656, 251.68588256835938, -60],[250.3159942626953, 249.52757263183594, -60],[251.75486755371094, 248.8081512451172, -60],[253.37359619140625, 248.62828063964844, -60],[254.6326141357422, 248.98800659179688, -60],[254.99232482910156, 250.78659057617188, -60],[253.91317749023438, 252.2254638671875, -60],[253.553466796875, 253.8441925048828, -60],[253.7333221435547, 254.92333984375, -60],[255.89161682128906, 254.7434844970703, -60],[257.33050537109375, 253.66433715820312, -60],[259.4888000488281, 252.2254638671875, -60],[261.4672546386719, 251.1463165283203, -60],[263.4457092285156, 250.06715393066406, -60],[265.0644226074219, 248.98800659179688, -60],[266.5032958984375, 247.90884399414062, -60],[268.3018798828125, 246.82969665527344, -60],[269.7407531738281, 245.93040466308594, -60],[271.8990478515625, 245.3908233642578, -60],[273.5177917480469, 245.03111267089844, -60],[274.5969543457031, 245.03111267089844, -60],[275.3163757324219, 245.03111267089844, -60],[275.3163757324219, 246.2901153564453, -60],[273.6976318359375, 248.8081512451172, -60],[271.5393371582031, 250.06715393066406, -60],[268.3018798828125, 252.0456085205078, -60],[267.22271728515625, 253.48446655273438, -60],[268.6615905761719, 254.38377380371094, -60],[270.999755859375, 253.48446655273438, -60],[273.5177917480469, 252.4053192138672, -60],[275.4962463378906, 251.86573791503906, -60],[277.83441162109375, 251.326171875, -60],[280.1725769042969, 250.78659057617188, -60],[282.33087158203125, 250.78659057617188, -60],[283.5898742675781, 250.78659057617188, -60],[285.2086181640625, 250.78659057617188, -60],[286.2877502441406, 251.1463165283203, -60],[287.1870422363281, 251.86573791503906, -60],[288.1647033691406, 252.59942626953125, -60]];
var nubsUnder = createNubs(controlsUnder);
var Sx1 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[187.6236114501953, 248.28280639648438, 0],[217,249,-48],[247,251,-57,8],[246.97702026367188, 266.8082580566406, -60]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[309.8292236328125, 218.52964782714844, 0],[300,230,-48],[295,240,-57,8],[288.1647033691406, 252.59942626953125, -60]];
var bLateral2 = BEZIER(S1)(pointsLateral2);
var bL1Sx = bLateral1;
var bL2Sx = bLateral2;

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));


//Boundary 

var controlsIntSx = [[188.94554138183594, 246.05392456054688, 0],[187.7293701171875, 245.51341247558594, 0],[187.323974609375, 243.7567138671875, 0],[187.99961853027344, 242.13514709472656, 0],[189.89144897460938, 240.91896057128906, 0],[190.97250366210938, 239.56765747070312, 0],[192.99945068359375, 238.2163543701172, 0],[194.6210174560547, 236.72991943359375, 0],[195.2966766357422, 234.9732208251953, 0],[195.8372039794922, 233.35165405273438, 0],[195.9723358154297, 231.18955993652344, 0],[194.8912811279297, 229.432861328125, 0],[193.53997802734375, 228.89234924316406, 0],[191.7832794189453, 228.89234924316406, 0],[189.08065795898438, 230.10850524902344, 0],[186.6483154296875, 230.64903259277344, 0],[184.21595764160156, 231.18955993652344, 0],[181.7836151123047, 231.73007202148438, 0],[179.21612548828125, 231.45982360839844, 0],[176.78378295898438, 230.51390075683594, 0],[175.83786010742188, 229.16259765625, 0],[174.75682067871094, 227.13563537597656, 0],[175.02708435058594, 225.37893676757812, 0],[175.56759643554688, 223.4871063232422, 0],[178.1350860595703, 222.27093505859375, 0],[181.2430877685547, 221.4601593017578, 0],[184.62135314941406, 221.4601593017578, 0],[187.45909118652344, 222.67633056640625, 0],[190.5670928955078, 223.8925018310547, 0],[193.13458251953125, 224.97354125976562, 0],[195.70205688476562, 226.86537170410156, 0],[198.40467834472656, 228.892333984375, 0],[200.97215270996094, 230.64903259277344, 0],[203.5396270751953, 231.59494018554688, 0],[207.4584197998047, 230.64903259277344, 0],[208.94485473632812, 228.2166748046875, 0],[208.53945922851562, 224.7032928466797, 0],[206.9178924560547, 222.81146240234375, 0],[205.29632568359375, 221.3250274658203, 0],[205.70172119140625, 219.16293334960938, 0],[207.8638153076172, 217.40623474121094, 0],[210.83668518066406, 215.6495361328125, 0],[213.67442321777344, 214.83876037597656, 0],[217.0526885986328, 214.56849670410156, 0],[219.48504638671875, 215.1090087890625, 0],[221.6471405029297, 216.73057556152344, 0],[221.78225708007812, 219.29806518554688, 0],[219.89044189453125, 222.13580322265625, 0],[219.07965087890625, 224.8384246826172, 0],[219.21478271484375, 227.54103088378906, 0],[220.8363494873047, 229.16259765625, 0],[223.67408752441406, 229.432861328125, 0],[226.2415771484375, 229.2977294921875, 0],[229.48471069335938, 228.351806640625, 0],[232.18731689453125, 225.64920043945312, 0],[235.02505493164062, 222.54119873046875, 0],[237.45741271972656, 219.70346069335938, 0],[239.214111328125, 216.59544372558594, 0],[241.37620544433594, 213.08206176757812, 0],[243.6734161376953, 209.9740447998047, 0],[247.1868133544922, 206.19039916992188, 0],[251.10560607910156, 203.6229248046875, 0],[254.48387145996094, 201.73109436035156, 0],[258.80804443359375, 199.83926391601562, 0],[263.9430236816406, 199.43386840820312, 0],[265.969970703125, 201.19056701660156, 0],[265.429443359375, 204.02830505371094, 0],[261.9160461425781, 206.7309112548828, 0],[257.1864929199219, 209.02813720703125, 0],[252.4569091796875, 212.0010223388672, 0],[246.10577392578125, 215.24415588378906, 0],[243.53829956054688, 219.29806518554688, 0],[245.56524658203125, 222.54119873046875, 0],[248.2678680419922, 222.81146240234375, 0],[252.7271728515625, 221.1898956298828, 0],[257.1864929199219, 219.16293334960938, 0],[262.0511779785156, 217.135986328125, 0],[265.69970703125, 215.514404296875, 0],[270.1590270996094, 213.48745727539062, 0],[275.6993713378906, 211.4604949951172, 0],[280.8343505859375, 211.4604949951172, 0],[287.18548583984375, 212.0010223388672, 0],[292.0501708984375, 212.67666625976562, 0],[297.1851501464844, 213.62258911132812, 0],[301.6444396972656, 214.97389221191406, 0],[305.83349609375, 217.135986328125, 0],[306.3740234375, 219.97372436523438, 0]];
var nubsIntSx = createNubs(controlsIntSx);
var boundarySx = BEZIER(S1)([nubsUpper,nubsIntSx]);
var boundarySxMap= MAP (boundarySx)(domain2);
DRAW (COLOR(mattLightYellow)(boundarySxMap));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);


//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 3 DX-----------------------------------------------------------------------


var controlsUpper = [[301.860107421875, 199.86654663085938, 0],[301.679931640625, 202.7663116455078, 0],[303.29644775390625, 205.1331787109375, 0],[304.493408203125, 206.56951904296875, 0],[307.4668884277344, 208.3502197265625, 0],[310.23883056640625, 209.44223022460938, 0],[312.1539611816406, 210.160400390625, 0],[315.3858947753906, 211.5990447998047, 0],[319.7514953613281, 212.91888427734375, 0],[323.4053955078125, 213.03311157226562, 0],[326.5174865722656, 213.03311157226562, 0],[328.4326171875, 211.5967559814453, 0],[328.9114074707031, 209.44223022460938, 0],[328.9114074707031, 206.56951904296875, 0],[329.62957763671875, 203.45742797851562, 0],[331.0659484863281, 201.06350708007812, 0],[333.6992492675781, 200.584716796875, 0],[336.3325500488281, 200.584716796875, 0],[339.4446716308594, 201.78167724609375, 0],[342.8993225097656, 204.08615112304688, 0],[346.38702392578125, 206.56951904296875, 0],[350.2173156738281, 209.9210205078125, 0],[352.8488464355469, 212.30972290039062, 0],[355.96270751953125, 214.7088623046875, 0],[359.5535888671875, 217.82095336914062, 0],[363.3838806152344, 220.4542694091797, 0],[366.0171813964844, 222.36940002441406, 0],[369.1292724609375, 222.60879516601562, 0],[371.2838134765625, 221.65122985839844, 0],[373.677734375, 219.01791381835938, 0]];
var nubsUpper = createNubs(controlsUpper);
var Dx3 =nubsUnder;
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[289.5251159667969, 265.2079772949219, -70],[290.7220764160156, 267.3625183105469, -70],[292.63720703125, 268.7988586425781, -70],[294.791748046875, 269.51702880859375, -70],[296.9462585449219, 270.2352294921875, -70],[299.3401794433594, 270.474609375, -70],[301.4947204589844, 270.9533996582031, -70],[304.367431640625, 270.7139892578125, -70],[306.2825622558594, 269.9958190917969, -70],[308.4371032714844, 269.7564392089844, -70],[309.6340637207031, 269.51702880859375, -70],[310.8310241699219, 268.7988586425781, -70],[311.0704040527344, 267.6018981933594, -70],[309.3946533203125, 266.4049377441406, -70],[308.6764831542969, 264.72918701171875, -70],[309.6340637207031, 263.2928466796875, -70],[310.35223388671875, 262.09588623046875, -70],[312.2673645019531, 261.85650634765625, -70],[313.4643249511719, 262.5746765136719, -70],[315.14007568359375, 263.7716369628906, -70],[316.3370361328125, 264.72918701171875, -70],[317.0552062988281, 266.1655578613281, -70],[318.2521667480469, 267.6018981933594, -70],[319.4491271972656, 269.7564392089844, -70],[320.8854675292969, 270.7139892578125, -70],[322.80059814453125, 271.67156982421875, -70],[325.19451904296875, 272.629150390625, -70],[327.58843994140625, 273.82611083984375, -70],[329.50360107421875, 274.5442810058594, -70],[330.93994140625, 274.7836608886719, -70],[332.8550720214844, 274.7836608886719, -70]];
var nubsUnder = createNubs(controlsUnder);
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[301.860107421875, 199.86654663085938, 0],[297,221,-60],[293,243,-68],[289.5251159667969, 265.2079772949219, -70]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[373.677734375, 219.01791381835938, 0],[360,237,-60],[347,255,-68],[332.8550720214844, 274.7836608886719, -70]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));

var bL1Dx = bLateral1;
var bL2Dx = bLateral2;


//Boundary 

var controlsIntDx = reverseR([[369.8474426269531, 216.86338806152344, 0],[368.889892578125, 218.19821166992188, 0],[367.8746337890625, 218.70584106445312, 0],[365.03192138671875, 218.09669494628906, 0],[362.189208984375, 216.16770935058594, 0],[358.2297058105469, 213.426513671875, 0],[355.7930908203125, 211.2944793701172, 0],[353.0518798828125, 208.55328369140625, 0],[348.7878112792969, 205.10140991210938, 0],[344.52374267578125, 202.15716552734375, 0],[341.47796630859375, 200.1266632080078, 0],[336.7062683105469, 198.5022430419922, 0],[333.3559265136719, 198.09613037109375, 0],[330.5132141113281, 198.90834045410156, 0],[328.68572998046875, 200.22817993164062, 0],[327.36590576171875, 202.664794921875, 0],[326.8582763671875, 205.91360473632812, 0],[327.06134033203125, 208.2487030029297, 0],[326.5537109375, 209.46701049804688, 0],[325.1323547363281, 210.1776885986328, 0],[322.69573974609375, 210.27920532226562, 0],[319.64996337890625, 209.97463989257812, 0],[316.0965576171875, 209.2639617919922, 0],[313.6599426269531, 208.1471710205078, 0],[311.22332763671875, 207.1319122314453, 0],[308.380615234375, 205.71055603027344, 0],[307.1623229980469, 204.7968292236328, 0],[306.0455322265625, 203.7815704345703, 0],[305.7409362792969, 202.15716552734375, 0],[305.6394348144531, 200.8373260498047, 0]]);
var nubsIntDx = createNubs(controlsIntDx);
var boundaryDx = BEZIER(S1)([nubsUpper,nubsIntDx]);
var boundaryDxMap= MAP (boundaryDx)(domain2);
DRAW (COLOR(mattLightYellow)(boundaryDxMap));

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 3 SX-----------------------------------------------------------------------



var controlsUpper = [[301.860107421875, 199.86654663085938, 0],[302.51763916015625, 198.62460327148438, 0],[304.751220703125, 197.60934448242188, 0],[307.390869140625, 197.5078125, 0],[309.5229187011719, 197.81239318847656, 0],[311.0458068847656, 198.5230712890625, 0],[313.1778259277344, 199.538330078125, 0],[314.80224609375, 200.3505401611328, 0],[316.32513427734375, 201.46731567382812, 0],[318.2541198730469, 202.07647705078125, 0],[320.4876708984375, 201.97494506835938, 0],[321.5029296875, 200.6551055908203, 0],[321.6044616699219, 198.92918395996094, 0],[319.98004150390625, 197.5078125, 0],[318.66021728515625, 195.78189086914062, 0],[317.4419250488281, 193.85289001464844, 0],[317.8480224609375, 191.72085571289062, 0],[319.37091064453125, 190.70559692382812, 0],[321.40142822265625, 189.5888214111328, 0],[324.34564208984375, 189.08119201660156, 0],[326.274658203125, 189.08119201660156, 0],[330.234130859375, 189.6903533935547, 0],[332.0616149902344, 190.19796752929688, 0],[334.3966979980469, 191.0101776123047, 0],[335.9195861816406, 190.29949951171875, 0],[337.2394104003906, 189.28424072265625, 0],[336.5287170410156, 186.4415283203125, 0],[335.7165222167969, 184.51254272460938, 0],[334.7012634277344, 182.075927734375, 0],[334.49822998046875, 180.34999084472656, 0],[335.51348876953125, 179.33473205566406, 0],[338.2546691894531, 178.7255859375, 0],[340.6912841796875, 179.33473205566406, 0],[342.7218017578125, 180.75608825683594, 0],[344.24468994140625, 182.1774444580078, 0],[346.376708984375, 184.00491333007812, 0],[347.89959716796875, 185.32473754882812, 0],[349.72705078125, 187.35525512695312, 0],[350.94537353515625, 189.08119201660156, 0],[352.1636657714844, 191.0101776123047, 0],[352.8743591308594, 192.9391632080078, 0],[352.97589111328125, 195.07119750976562, 0],[352.1636657714844, 196.3910369873047, 0],[350.94537353515625, 197.3047637939453, 0],[349.5240173339844, 198.01544189453125, 0],[349.72705078125, 199.03070068359375, 0],[350.5392761230469, 200.14749145507812, 0],[353.28045654296875, 201.26426696777344, 0],[356.0216369628906, 201.26426696777344, 0],[358.5597839355469, 201.6703643798828, 0],[361.3009948730469, 202.07647705078125, 0],[363.6360778808594, 202.888671875, 0],[365.5650634765625, 204.00546264648438, 0],[366.9864196777344, 205.02072143554688, 0],[369.0169372558594, 206.64512634277344, 0],[370.5398254394531, 208.67564392089844, 0],[371.961181640625, 211.01072692871094, 0],[372.8749084472656, 213.34580993652344, 0],[373.6871032714844, 215.27479553222656, 0],[373.48406982421875, 219.03125, 0]];
var nubsUpper = createNubs(controlsUpper);
var Sx3 =nubsUnder;
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[289.466552734375, 264.0515441894531, -80],[290.3658447265625, 263.5119934082031, -80],[291.44500732421875, 263.3321228027344, -80],[292.7040100097656, 263.3321228027344, -80],[293.6033020019531, 263.3321228027344, -80],[294.14288330078125, 263.5119934082031, -80],[294.5025939941406, 263.8717041015625, -80],[295.2220458984375, 264.59112548828125, -80],[295.94146728515625, 265.1307067871094, -80],[297.2004699707031, 265.49041748046875, -80],[299.1789245605469, 265.6702880859375, -80],[299.718505859375, 265.49041748046875, -80],[299.53863525390625, 264.4112854003906, -80],[298.9990539550781, 263.8717041015625, -80],[298.0997619628906, 263.1522521972656, -80],[297.3803405761719, 262.4328308105469, -80],[296.660888671875, 261.5335388183594, -80],[296.3011779785156, 260.2745361328125, -80],[296.4810485839844, 259.3752136230469, -80],[297.0206298828125, 258.6557922363281, -80],[300.43792724609375, 258.1162109375, -80],[302.0566711425781, 258.1162109375, -80],[303.49554443359375, 258.1162109375, -80],[304.2149658203125, 258.29608154296875, -80],[305.8337097167969, 258.6557922363281, -80],[307.4524230957031, 259.3752136230469, -80],[308.5315856933594, 260.4543762207031, -80],[309.6107482910156, 261.173828125, -80],[310.1502990722656, 261.5335388183594, -80],[311.4093322753906, 261.5335388183594, -80],[312.3086242675781, 260.8140869140625, -80],[312.48846435546875, 259.914794921875, -80],[312.48846435546875, 258.4759216308594, -80],[312.1287536621094, 256.8572082519531, -80],[311.76904296875, 255.2384796142578, -80],[311.76904296875, 254.3391876220703, -80],[312.6683349609375, 252.720458984375, -80],[314.1072082519531, 252.54058837890625, -80],[315.0065002441406, 253.08016967773438, -80],[315.9057922363281, 254.3391876220703, -80],[316.44537353515625, 255.77804565429688, -80],[317.164794921875, 257.5766296386719, -80],[317.7043762207031, 258.6557922363281, -80],[318.0640869140625, 259.7349548339844, -80],[317.8842468261719, 261.3536682128906, -80],[317.8842468261719, 262.972412109375, -80],[317.8842468261719, 264.4112854003906, -80],[318.423828125, 265.6702880859375, -80],[320.04254150390625, 266.0299987792969, -80],[321.4814147949219, 265.6702880859375, -80],[323.10015869140625, 265.49041748046875, -80],[324.89874267578125, 265.3105773925781, -80],[327.0570373535156, 266.0299987792969, -80],[328.67578125, 267.1091613769531, -80],[329.9347839355469, 268.9077453613281, -80],[331.0139465332031, 270.34661865234375, -80],[331.5534973144531, 271.42578125, -80],[332.45281982421875, 271.96533203125, -80],[332.99237060546875, 273.04449462890625, -80],[333.1722412109375, 274.84307861328125, -80]];
var nubsUnder = createNubs(controlsUnder);
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[301.860107421875, 199.86654663085938, 0],[297,221,-68.8],[293,243,-77.7],[289.466552734375, 264.0515441894531, -80, -80]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[373.48406982421875, 219.03125, 0],[360,237,-68.8],[347,255,-77.7],[333.1722412109375, 274.84307861328125, -80]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));
var bL1Sx = bLateral1;
var bL2Sx = bLateral2;


//Boundary 

var controlsIntSx = reverseR([[369.8474426269531, 216.86338806152344, 0],[369.42303466796875, 214.97023010253906, 0],[369.219970703125, 213.34580993652344, 0],[368.5093078613281, 211.82293701171875, 0],[367.5955810546875, 210.90919494628906, 0],[366.1742248535156, 209.89395141601562, 0],[365.1589660644531, 209.18325805664062, 0],[363.02691650390625, 207.2542724609375, 0],[360.7933654785156, 205.62986755371094, 0],[358.2552185058594, 204.31002807617188, 0],[355.4125061035156, 203.8024139404297, 0],[353.28045654296875, 203.59934997558594, 0],[349.8285827636719, 202.6856231689453, 0],[345.9706115722656, 200.24900817871094, 0],[344.54925537109375, 197.10171508789062, 0],[345.3614501953125, 195.47731018066406, 0],[347.59503173828125, 195.57882690429688, 0],[349.21942138671875, 195.1727294921875, 0],[349.5240173339844, 193.9544219970703, 0],[349.0163879394531, 191.72085571289062, 0],[348.0011291503906, 190.19796752929688, 0],[346.1736755371094, 188.5735626220703, 0],[345.3614501953125, 187.2537384033203, 0],[343.83856201171875, 185.52780151367188, 0],[342.8233337402344, 184.6140594482422, 0],[341.0973815917969, 183.0911865234375, 0],[339.87908935546875, 182.58355712890625, 0],[338.7622985839844, 182.38050842285156, 0],[338.356201171875, 182.98965454101562, 0],[338.45770263671875, 183.70033264160156, 0],[338.6607666015625, 184.51254272460938, 0],[339.0668640136719, 185.6293182373047, 0],[339.7775573730469, 187.5583038330078, 0],[340.2851867675781, 189.48728942871094, 0],[340.7928161621094, 191.8223876953125, 0],[339.87908935546875, 193.85289001464844, 0],[338.15313720703125, 194.56358337402344, 0],[334.1936340332031, 193.54832458496094, 0],[332.1631164550781, 192.43153381347656, 0],[330.0310974121094, 192.12696838378906, 0],[326.07159423828125, 191.41627502441406, 0],[324.244140625, 191.51780700683594, 0],[322.9242858886719, 192.0254364013672, 0],[321.9090576171875, 192.63458251953125, 0],[321.6044616699219, 194.157470703125, 0],[321.9090576171875, 195.3757781982422, 0],[322.9242858886719, 196.69561767578125, 0],[323.73651123046875, 198.218505859375, 0],[324.4471740722656, 199.43679809570312, 0],[324.853271484375, 201.97494506835938, 0],[323.2288818359375, 203.7008819580078, 0],[319.2693786621094, 204.41156005859375, 0],[316.02056884765625, 203.49783325195312, 0],[314.0915832519531, 202.6856231689453, 0],[312.4671630859375, 201.8734130859375, 0],[310.3351135253906, 200.6551055908203, 0],[309.1168212890625, 200.3505401611328, 0],[307.6954650878906, 200.24900817871094, 0],[307.1878356933594, 200.14749145507812, 0],[306.78173828125, 200.24900817871094, 0],[305.6394348144531, 200.8373260498047, 0]]);
var nubsIntSx = createNubs(controlsIntSx);
var boundarySx = BEZIER(S1)([nubsUpper,nubsIntSx]);
var boundarySxMap= MAP (boundarySx)(domain2);
DRAW (COLOR(mattLightYellow)(boundarySxMap));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 5 DX-----------------------------------------------------------------------


var controlsUpper = [[399.37530517578125, 276.56707763671875, 0],[397.9389343261719, 277.5246276855469, 0],[397.46014404296875, 279.4397888183594, 0],[397.9389343261719, 282.3124694824219, 0],[399.37530517578125, 285.4245910644531, 0],[400.572265625, 289.4942321777344, 0],[401.5298156738281, 293.8033142089844, 0],[402.00860595703125, 297.15478515625, 0],[402.4873962402344, 300.74566650390625, 0],[401.76922607421875, 304.8153381347656, 0],[400.3328552246094, 307.4486389160156, 0],[397.9389343261719, 307.92742919921875, 0],[395.3056335449219, 306.2516784667969, 0],[393.8692626953125, 302.90020751953125, 0],[391.475341796875, 298.11236572265625, 0],[389.5602111816406, 293.0851135253906, 0],[388.3632507324219, 288.53668212890625, 0],[386.6875, 283.74884033203125, 0],[384.5329895019531, 278.7215881347656, 0],[381.899658203125, 273.215576171875, 0],[377.3512268066406, 267.7095642089844, 0],[373.28155517578125, 263.1611022949219, 0],[369.690673828125, 258.1338806152344, 0],[369.9300537109375, 254.064208984375, 0],[373.04217529296875, 251.90968322753906, 0],[377.11181640625, 252.14907836914062, 0],[380.9421081542969, 255.02178955078125, 0],[384.7723693847656, 258.1338806152344, 0],[387.88446044921875, 262.44293212890625, 0],[390.5177917480469, 261.9641418457031, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[318.9671325683594, 291.50848388671875, -70],[317.2913818359375, 290.5509338378906, -70],[315.85504150390625, 291.7478942871094, -70],[316.09442138671875, 293.42364501953125, -70],[316.3338317871094, 295.5781555175781, -70],[316.8126220703125, 297.4932861328125, -70],[317.5307922363281, 299.408447265625, -70],[317.5307922363281, 301.08416748046875, -70],[317.2913818359375, 302.99932861328125, -70],[317.052001953125, 304.9144592285156, -70],[316.5732116699219, 307.0689697265625, -70],[315.61566162109375, 309.462890625, -70],[312.9823303222656, 308.984130859375, -70],[311.5459899902344, 307.3083801269531, -70],[310.5884094238281, 304.4356689453125, -70],[310.109619140625, 301.5629577636719, -70],[309.630859375, 298.45086669921875, -70],[309.3914489746094, 295.099365234375, -70],[308.91265869140625, 291.50848388671875, -70],[307.476318359375, 288.1570129394531, -70],[306.03997802734375, 284.8055114746094, -70],[305.0823974609375, 281.69342041015625, -70],[306.7581481933594, 279.5389099121094, -70],[309.8702392578125, 279.5389099121094, -70],[312.0247802734375, 281.9328308105469, -70],[313.70050048828125, 284.3267517089844, -70],[315.3762512207031, 286.9600524902344, -70],[317.052001953125, 286.9600524902344, -70],[318.24896240234375, 285.7630920410156, -70]];
var nubsUnder = createNubs(controlsUnder);
var Dx5 =nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[399.37530517578125, 276.56707763671875, 0],[372,281,-60],[345,286,-68],[318.9671325683594, 291.50848388671875, -70]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[390.5177917480469, 261.9641418457031, 0],[366,269,-60],[342,278,-68],[318.24896240234375, 285.7630920410156, -70]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));
var bL1Dx = bLateral1;
var bL2Dx = bLateral2;


//Boundary 

var controlsIntDx = reverseR([[392.2210693359375, 264.69659423828125, 0],[389.8271484375, 266.8511047363281, 0],[386.7150573730469, 265.17535400390625, 0],[384.0817565917969, 262.0632629394531, 0],[380.25146484375, 257.9936218261719, 0],[377.6181640625, 255.36029052734375, 0],[374.7454528808594, 254.8815155029297, 0],[374.02728271484375, 257.0360412597656, 0],[375.2242431640625, 259.90875244140625, 0],[378.57574462890625, 264.2178039550781, 0],[383.60296630859375, 269.96319580078125, 0],[385.75750732421875, 275.2298278808594, 0],[389.5877685546875, 282.4115905761719, 0],[390.78472900390625, 287.4388427734375, 0],[391.981689453125, 292.466064453125, 0],[393.6574401855469, 297.4932861328125, 0],[395.57257080078125, 301.8023681640625, 0],[397.2483215332031, 303.7174987792969, 0],[399.1634521484375, 303.23870849609375, 0],[399.8816223144531, 300.3659973144531, 0],[398.924072265625, 296.7751159667969, 0],[397.96649169921875, 292.9448547363281, 0],[397.0089111328125, 289.11456298828125, 0],[396.2907409667969, 285.523681640625, 0],[394.8544006347656, 281.69342041015625, 0],[394.8544006347656, 278.8207092285156, 0],[395.0937805175781, 276.1874084472656, 0],[397.4877014160156, 273.7934875488281, 0]]);
var nubsIntDx = createNubs(controlsIntDx);
var boundaryDx = BEZIER(S1)([nubsUpper,nubsIntDx]);
var boundaryDxMap= MAP (boundaryDx)(domain2);
DRAW (COLOR(mattLightYellow)(boundaryDxMap));

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 5 SX-----------------------------------------------------------------------



var controlsUpper = [[399.37530517578125, 276.56707763671875, 0],[402.27557373046875, 277.3843688964844, 0],[405.1482849121094, 280.9752502441406, 0],[406.3452453613281, 285.2843017578125, 0],[406.8240051269531, 290.5509338378906, 0],[406.1058349609375, 297.0145263671875, 0],[405.3876647949219, 304.1962890625, 0],[405.3876647949219, 309.94171142578125, 0],[406.1058349609375, 316.6446838378906, 0],[408.499755859375, 320.71435546875, 0],[412.5694274902344, 322.15069580078125, 0],[416.1603088378906, 321.6719055175781, 0],[419.7511901855469, 319.2779846191406, 0],[421.42694091796875, 316.6446838378906, 0],[422.6239013671875, 312.57501220703125, 0],[422.86328125, 307.0690002441406, 0],[421.9057312011719, 298.21148681640625, 0],[420.22998046875, 290.0721435546875, 0],[417.5966491699219, 282.41162109375, 0],[413.28759765625, 273.7934875488281, 0],[409.2179260253906, 264.45721435546875, 0],[405.6270446777344, 258.7117919921875, 0],[401.3179931640625, 251.76942443847656, 0],[397.2483215332031, 245.0664520263672, 0],[394.13623046875, 239.5604248046875, 0],[388.8695983886719, 233.0968475341797, 0],[385.0393371582031, 228.78778076171875, 0],[380.2514953613281, 227.3514404296875, 0],[376.8999938964844, 230.22413635253906, 0],[376.6606140136719, 234.05441284179688, 0],[379.5333251953125, 240.2786102294922, 0],[382.4060363769531, 243.86949157714844, 0],[384.560546875, 247.93914794921875, 0],[386.715087890625, 252.2482147216797, 0],[388.8695983886719, 255.3603057861328, 0],[390.30596923828125, 259.1905822753906, 0],[390.5177917480469, 261.9641418457031, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[318.9671325683594, 291.50848388671875, -80],[323.28936767578125, 291.9063415527344, -80],[324.54840087890625, 294.96392822265625, -80],[325.8074035644531, 297.4819641113281, -80],[325.6275329589844, 300.1798400878906, -80],[324.3685302734375, 302.51800537109375, -80],[323.28936767578125, 306.1152038574219, -80],[323.28936767578125, 310.79150390625, -80],[325.44769287109375, 313.66925048828125, -80],[328.864990234375, 313.3095397949219, -80],[330.4837341308594, 311.5109558105469, -80],[331.74273681640625, 308.27349853515625, -80],[332.8218994140625, 304.4964599609375, -80],[333.3614807128906, 300, -80],[332.8218994140625, 295.8632507324219, -80],[331.922607421875, 291.0070495605469, -80],[330.6636047363281, 286.5105895996094, -80],[329.4045715332031, 283.27313232421875, -80],[328.325439453125, 279.31622314453125, -80],[327.1064453125, 275.2298583984375, -80],[326.1671142578125, 273.02117919921875, -80],[325.6275329589844, 270.3232727050781, -80],[324.7282409667969, 267.985107421875, -80],[323.8289489746094, 265.46710205078125, -80],[322.0303649902344, 263.1289367675781, -80],[320.2317810058594, 262.76922607421875, -80],[317.7137451171875, 263.8483581542969, -80],[317.89361572265625, 266.0066833496094, -80],[318.4331970214844, 268.3448486328125, -80],[319.69219970703125, 270.3232727050781, -80],[320.0519104003906, 272.3017272949219, -80],[320.4116516113281, 274.81976318359375, -80],[320.9512023925781, 276.7982177734375, -80],[320.9512023925781, 278.7766418457031, -80],[320.9512023925781, 281.11480712890625, -80],[320.59149169921875, 282.91339111328125, -80],[318.24896240234375, 285.7630920410156, -80]];
var nubsUnder = createNubs(controlsUnder);
var Sx5 =nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[399.37530517578125, 276.56707763671875, 0],[372,281,-68.6],[345,286,-77.7],[318.9671325683594, 291.50848388671875, -80]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[390.5177917480469, 261.9641418457031, 0],[366,269,-68.6],[342,278,-77.7],[318.24896240234375, 285.7630920410156, -80]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));
var bL1Sx = bLateral1;
var bL2Sx = bLateral2;


//Boundary 

var controlsIntSx = reverseR([[392.4604797363281, 263.739013671875, 0],[393.1786804199219, 260.14813232421875, 0],[391.9817199707031, 254.40274047851562, 0],[389.8271789550781, 251.76942443847656, 0],[387.1938781738281, 248.1785430908203, 0],[384.7999572753906, 243.3907012939453, 0],[381.92724609375, 239.79981994628906, 0],[379.5333251953125, 234.53318786621094, 0],[379.772705078125, 232.378662109375, 0],[380.4908752441406, 230.7029266357422, 0],[383.8423767089844, 230.7029266357422, 0],[386.2362976074219, 235.01197814941406, 0],[390.54534912109375, 240.5179901123047, 0],[394.3756408691406, 245.7846221923828, 0],[398.924072265625, 252.4875946044922, 0],[402.27557373046875, 259.1905822753906, 0],[406.5846252441406, 264.69659423828125, 0],[411.3724670410156, 274.27227783203125, 0],[415.2027282714844, 282.6510009765625, 0],[418.075439453125, 290.5509338378906, 0],[419.27239990234375, 298.6902770996094, 0],[419.7511901855469, 306.82958984375, 0],[419.7511901855469, 312.0962219238281, 0],[419.03302001953125, 314.2507629394531, 0],[417.8360595703125, 315.6871032714844, 0],[415.9209289550781, 317.36285400390625, 0],[412.5694274902344, 317.36285400390625, 0],[410.1755065917969, 316.8840637207031, 0],[408.7391662597656, 314.72955322265625, 0],[407.7815856933594, 310.42047119140625, 0],[407.5422058105469, 304.9144592285156, 0],[409.69671630859375, 297.7326965332031, 0],[409.45733642578125, 290.3115539550781, 0],[409.2179260253906, 284.3267517089844, 0],[407.5422058105469, 280.0177001953125, 0],[402.51495361328125, 274.7510681152344, 0],[397.9665222167969, 273.7934875488281, 0]]);
var nubsIntSx = createNubs(controlsIntSx);
var boundarySx = BEZIER(S1)([nubsUpper,nubsIntSx]);
var boundarySxMap= MAP (boundarySx)(domain2);
DRAW (COLOR(mattLightYellow)(boundarySxMap));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 7 DX-----------------------------------------------------------------------


var controlsUpper = [[240.6220245361328, 391.0994873046875, 0],[243.49473571777344, 388.2267761230469, 0],[249.24014282226562, 387.98736572265625, 0],[253.07041931152344, 389.4237365722656, 0],[257.14007568359375, 391.0994873046875, 0],[260.4915771484375, 391.5782470703125, 0],[264.08245849609375, 392.29644775390625, 0],[268.1521301269531, 393.0146179199219, 0],[271.50360107421875, 393.2539978027344, 0],[274.6156921386719, 393.0146179199219, 0],[274.8551025390625, 391.3388671875, 0],[272.7005615234375, 389.6631164550781, 0],[268.87030029296875, 388.9449462890625, 0],[264.5612487792969, 388.70556640625, 0],[260.9703674316406, 387.50860595703125, 0],[257.8582458496094, 385.59344482421875, 0],[254.50677490234375, 383.917724609375, 0],[252.5916290283203, 381.2843933105469, 0],[251.63406372070312, 376.7359619140625, 0],[253.07041931152344, 373.8632507324219, 0],[256.90069580078125, 372.6662902832031, 0],[262.1673278808594, 373.14508056640625, 0],[267.9127197265625, 373.38446044921875, 0],[273.4187316894531, 374.1026306152344, 0],[278.9247741699219, 374.1026306152344, 0],[285.3883361816406, 374.342041015625, 0],[291.1337585449219, 374.82080078125, 0],[296.400390625, 373.14508056640625, 0],[300.4700622558594, 373.14508056640625, 0],[305.7366638183594, 374.342041015625, 0],[309.3275451660156, 375.77838134765625, 0],[310.5245056152344, 378.6510925292969, 0],[310.0457458496094, 381.0450134277344, 0],[307.8912048339844, 384.396484375, 0],[300.4700622558594, 386.3116455078125, 0],[293.04888916015625, 387.0298156738281, 0],[288.02166748046875, 387.98736572265625, 0],[285.1489562988281, 389.4237365722656, 0],[284.670166015625, 391.5782470703125, 0],[288.02166748046875, 393.0146179199219, 0],[293.7670593261719, 393.0146179199219, 0],[302.8639831542969, 393.7327880859375, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[264.7491455078125, 324.7549133300781, -50],[266.1855163574219, 322.1216125488281, -50],[268.5794372558594, 322.1216125488281, -50],[270.2551574707031, 323.07916259765625, -50],[271.6915283203125, 324.276123046875, -50],[274.5642395019531, 325.7124938964844, -50],[276.9581604003906, 326.4306640625, -50],[279.3520812988281, 327.3882141113281, -50],[282.9429626464844, 327.86700439453125, -50],[283.9005126953125, 326.6700439453125, -50],[283.4217224121094, 324.276123046875, -50],[281.0278015136719, 323.5579528808594, -50],[278.1551208496094, 323.3185729980469, -50],[274.3248291015625, 321.8822021484375, -50],[271.4521179199219, 320.44586181640625, -50],[269.5369873046875, 318.29132080078125, -50],[269.5369873046875, 315.89739990234375, -50],[271.930908203125, 314.9398498535156, -50],[274.8036193847656, 315.1792297363281, -50],[278.873291015625, 315.65802001953125, -50],[281.506591796875, 315.65802001953125, -50],[286.0550537109375, 315.65802001953125, -50],[290.3641052246094, 316.1368103027344, -50],[293.4761962890625, 316.1368103027344, -50],[296.5882873535156, 316.1368103027344, -50],[299.46099853515625, 316.3761901855469, -50],[302.09429931640625, 316.85498046875, -50],[303.5306701660156, 318.5307312011719, -50],[302.3337097167969, 320.2064514160156, -50],[299.46099853515625, 322.1216125488281, -50],[295.8701171875, 323.07916259765625, -50],[292.7580261230469, 324.0367431640625, -50],[290.8428955078125, 324.0367431640625, -50],[289.4065246582031, 325.9518737792969, -50],[290.3641052246094, 327.3882141113281, -50],[294.1943664550781, 327.62762451171875, -50],[296.82769775390625, 327.3882141113281, -50],[299.22161865234375, 326.4306640625, -50],[301.85491943359375, 325.47308349609375, -50],[304.48822021484375, 324.0367431640625, -50],[305.9245910644531, 324.0367431640625, -50],[307.600341796875, 325.47308349609375, -50],[307.600341796875, 327.1488342285156, -50],[307.600341796875, 328.5851745605469, -50]];
var nubsUnder = createNubs(controlsUnder);
var Dx7 =nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[240.6220245361328, 391.0994873046875, 0],[248,368,-40],[256,346,-48],[264.7491455078125, 324.7549133300781, -50]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[302.8639831542969, 393.7327880859375, 0],[303.5,370,-40],[305.5,349,-48],[307.600341796875, 328.5851745605469, -50]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));
var bL1Dx = bLateral1;
var bL2Dx = bLateral2;


//Boundary 

var controlsIntDx = reverseR([[305.97607421875, 395.8873291015625, 0],[308.609375, 398.28125, 0],[305.4972839355469, 399.47821044921875, 0],[303.5821533203125, 397.32366943359375, 0],[301.6670227050781, 397.08428955078125, 0],[294.7246398925781, 396.3660888671875, 0],[288.26104736328125, 396.126708984375, 0],[282.7550354003906, 393.97216796875, 0],[280.6004943847656, 390.6206970214844, 0],[282.036865234375, 387.2691955566406, 0],[286.82470703125, 385.59344482421875, 0],[291.8519287109375, 384.8752746582031, 0],[298.5549011230469, 383.4389343261719, 0],[304.5397033691406, 382.0025634765625, 0],[305.4972839355469, 379.3692626953125, 0],[304.5397033691406, 378.17230224609375, 0],[302.38519287109375, 377.4541320800781, 0],[297.59735107421875, 377.6935119628906, 0],[292.5700988769531, 377.93292236328125, 0],[285.1489562988281, 377.6935119628906, 0],[278.68536376953125, 377.6935119628906, 0],[273.65814208984375, 377.2147216796875, 0],[266.9551696777344, 376.7359619140625, 0],[262.4067077636719, 376.2571716308594, 0],[259.29461669921875, 377.2147216796875, 0],[258.09765625, 378.17230224609375, 0],[257.8582458496094, 380.56622314453125, 0],[261.2097473144531, 382.72076416015625, 0],[263.6036682128906, 383.917724609375, 0],[266.47637939453125, 384.6358947753906, 0],[270.5460510253906, 386.3116455078125, 0],[273.4187316894531, 386.7904052734375, 0],[276.05206298828125, 388.2267761230469, 0],[277.0096130371094, 390.38128662109375, 0],[277.7278137207031, 393.493408203125, 0],[276.05206298828125, 395.8873291015625, 0],[273.89752197265625, 396.8448791503906, 0],[270.306640625, 396.8448791503906, 0],[266.9551696777344, 396.6054992675781, 0],[264.5612487792969, 395.6479187011719, 0],[260.4915771484375, 394.4509582519531, 0],[256.6612854003906, 393.493408203125, 0],[252.3522491455078, 391.5782470703125, 0],[249.4795379638672, 390.38128662109375, 0],[245.64926147460938, 390.8600769042969, 0],[243.97352600097656, 392.53582763671875, 0]]);
var nubsIntDx = createNubs(controlsIntDx);
var boundaryDx = BEZIER(S1)([nubsUpper,nubsIntDx]);
var boundaryDxMap= MAP (boundaryDx)(domain2);
DRAW (COLOR(mattLightYellow)(boundaryDxMap));

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 7 SX-----------------------------------------------------------------------



var controlsUpper = [[240.6220245361328, 391.0994873046875, 0],[241.5281219482422, 394.4179992675781, 0],[242.9644775390625, 397.53009033203125, 0],[245.5977783203125, 400.1634216308594, 0],[249.18865966796875, 401.1209716796875, 0],[252.06137084960938, 401.83917236328125, 0],[255.1734619140625, 402.5573425292969, 0],[259.0037536621094, 403.2755126953125, 0],[261.6370544433594, 403.2755126953125, 0],[264.0309753417969, 403.2755126953125, 0],[266.1855163574219, 403.7543029785156, 0],[267.3824768066406, 405.4300537109375, 0],[265.94610595703125, 406.86639404296875, 0],[262.1158447265625, 408.0633544921875, 0],[257.8067932128906, 407.823974609375, 0],[254.69468688964844, 407.823974609375, 0],[253.01893615722656, 409.02093505859375, 0],[251.34320068359375, 410.2178955078125, 0],[250.62501525878906, 412.8511962890625, 0],[251.58258056640625, 416.9208679199219, 0],[253.97650146484375, 419.7935791015625, 0],[257.8067932128906, 421.46929931640625, 0],[261.3976745605469, 421.9480895996094, 0],[264.2703552246094, 421.7087097167969, 0],[267.14306640625, 420.2723388671875, 0],[269.5369873046875, 418.59661865234375, 0],[271.6915283203125, 417.6390380859375, 0],[273.3672790527344, 415.9632873535156, 0],[275.7611999511719, 415.0057373046875, 0],[279.8308410644531, 416.68145751953125, 0],[282.70355224609375, 418.59661865234375, 0],[285.3368835449219, 420.7511291503906, 0],[288.6883544921875, 422.4268798828125, 0],[292.7580261230469, 423.62384033203125, 0],[297.06707763671875, 424.5814208984375, 0],[301.3761291503906, 424.82080078125, 0],[304.48822021484375, 423.38446044921875, 0],[307.8397216796875, 420.5117492675781, 0],[308.0791015625, 417.399658203125, 0],[306.40338134765625, 413.3299865722656, 0],[302.3337097167969, 411.65423583984375, 0],[297.5458679199219, 410.457275390625, 0],[291.8004455566406, 409.9784851074219, 0],[287.49139404296875, 408.302734375, 0],[285.3368835449219, 406.3876037597656, 0],[287.49139404296875, 404.23309326171875, 0],[293.4761962890625, 404.23309326171875, 0],[298.2640380859375, 404.71185302734375, 0],[302.8639831542969, 393.7327880859375, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[264.7491455078125, 324.7549133300781, -60],[264.6896057128906, 325.3401794433594,  -60],[265.47686767578125, 327.1882629394531,  -60],[266.604736328125, 328.4522705078125,  -60],[268.5198974609375, 329.64923095703125,  -60],[269.95623779296875, 330.3674011230469,  -60],[271.8713684082031, 330.6068115234375,  -60],[274.665771484375, 331.2421875,  -60],[277.0981140136719, 331.78271484375,  -60],[278.71966552734375, 332.593505859375,  -60],[279.53192138671875, 334.67645263671875,  -60],[278.5743408203125, 337.07037353515625,  -60],[276.180419921875, 337.07037353515625,  -60],[273.0683288574219, 337.78857421875,  -60],[271.1531982421875, 337.78857421875,  -60],[269.4774475097656, 339.22491455078125,  -60],[269.2380676269531, 340.6612548828125,  -60],[269.2380676269531, 342.0976257324219,  -60],[271.392578125, 343.77337646484375,  -60],[273.0683288574219, 344.25213623046875,  -60],[277.13800048828125, 344.01275634765625,  -60],[279.53192138671875, 343.2945861816406,  -60],[281.2076721191406, 341.85821533203125,  -60],[283.3621826171875, 341.1400451660156,  -60],[285.0379333496094, 340.1824951171875,  -60],[287.91064453125, 339.9430847167969,  -60],[290.065185546875, 339.9430847167969,  -60],[291.9803161621094, 340.6612548828125,  -60],[293.65606689453125, 342.0976257324219,  -60],[295.8105773925781, 343.2945861816406,  -60],[298.68328857421875, 344.01275634765625,  -60],[300.83782958984375, 343.77337646484375,  -60],[303.47113037109375, 342.3370056152344,  -60],[304.4287109375, 341.61883544921875,  -60],[305.86505126953125, 340.1824951171875,  -60],[306.10443115234375, 338.267333984375,  -60],[303.9499206542969, 337.5491638183594,  -60],[301.07720947265625, 337.07037353515625,  -60],[298.5838623046875, 337.05279541015625,  -60],[296.6920471191406, 336.51226806640625,  -60],[294.8002014160156, 336.1069030761719,  -60],[293.31378173828125, 334.3501892089844,  -60],[295.0704650878906, 333.1340026855469,  -60],[297.2325744628906, 332.3232421875,  -60],[299.800048828125, 331.3773193359375,  -60],[301.5567321777344, 330.5665283203125,  -60],[303.1783142089844, 330.431396484375,  -60],[305.07012939453125, 330.0260009765625,  -60],[306.96197509765625, 328.9449768066406,  -60],[307.600341796875, 328.5851745605469, -60]];
var nubsUnder = createNubs(controlsUnder);
var Sx7 =nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[240.6220245361328, 391.0994873046875, 0],[248,368,-48],[256,346,-57.8],[264.7491455078125, 324.7549133300781, -60]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[302.8639831542969, 393.7327880859375, 0],[303.5,370,-48],[305.5,349,-57,8],[307.600341796875, 328.5851745605469, -60]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));
var bL1Sx = bLateral1;
var bL2Sx = bLateral2;


//Boundary 

var controlsIntSx = reverseR([[305.44580078125, 399.44525146484375, 0],[305.44580078125, 400.1634216308594, 0],[304.48822021484375, 401.1209716796875, 0],[303.5306701660156, 401.3603820800781, 0],[298.9822082519531, 401.3603820800781, 0],[293.9549865722656, 401.83917236328125, 0],[287.0126037597656, 401.5997619628906, 0],[282.70355224609375, 403.2755126953125, 0],[282.2247619628906, 405.66943359375, 0],[283.1823425292969, 409.02093505859375, 0],[286.5338134765625, 410.457275390625, 0],[290.6034851074219, 411.41485595703125, 0],[296.82769775390625, 412.8511962890625, 0],[300.8973388671875, 414.5269470214844, 0],[303.7700500488281, 415.4844970703125, 0],[304.9670104980469, 417.6390380859375, 0],[303.7700500488281, 419.7935791015625, 0],[300.8973388671875, 420.5117492675781, 0],[297.30645751953125, 420.7511291503906, 0],[294.67315673828125, 420.7511291503906, 0],[291.5610656738281, 419.7935791015625, 0],[288.2095642089844, 417.399658203125, 0],[284.85809326171875, 415.9632873535156, 0],[282.70355224609375, 414.04815673828125, 0],[277.67633056640625, 411.65423583984375, 0],[273.8460388183594, 411.65423583984375, 0],[271.6915283203125, 413.5693664550781, 0],[269.297607421875, 415.7239074707031, 0],[267.14306640625, 416.68145751953125, 0],[263.55218505859375, 418.1178283691406, 0],[259.2431335449219, 418.1178283691406, 0],[255.65225219726562, 417.1602478027344, 0],[253.97650146484375, 414.7663269042969, 0],[253.97650146484375, 411.89361572265625, 0],[256.13104248046875, 410.6966552734375, 0],[260.4400939941406, 410.457275390625, 0],[264.509765625, 410.2178955078125, 0],[269.7763977050781, 407.823974609375, 0],[271.4521179199219, 404.9512634277344, 0],[269.7763977050781, 401.3603820800781, 0],[264.509765625, 400.4028015136719, 0],[259.0037536621094, 400.1634216308594, 0],[252.06137084960938, 399.68463134765625, 0],[247.51292419433594, 397.7695007324219, 0],[246.3159637451172, 396.09375, 0],[245.3583984375, 393.46044921875, 0],[245.3583984375, 391.7846984863281, 0]]);
var nubsIntSx = createNubs(controlsIntSx);
var boundarySx = BEZIER(S1)([nubsUpper,nubsIntSx]);
var boundarySxMap= MAP (boundarySx)(domain2);
DRAW (COLOR(mattLightYellow)(boundarySxMap));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);

var point = BEZIER(S1)([[285, 297, -79]]);
var closure1 = createBezierS2([Dx1,point], mattDarkOrchid);
var closure2 = createBezierS2([Sx1, point], mattDarkOrchid);
var closure2 = createBezierS2([Dx3, point], mattDarkOrchid);
var closure2 = createBezierS2([Dx5, point], mattDarkOrchid);
var closure2 = createBezierS2([Dx7, point], mattDarkOrchid);
var closure2 = createBezierS2([Sx3, point], mattDarkOrchid);
var closure2 = createBezierS2([Sx5, point], mattDarkOrchid);
var closure2 = createBezierS2([Sx7, point], mattDarkOrchid);

/********************************************SMOOTH ENDOPLASMIC RETICULUM ****************************************/
//________________________________________________________________________________PART 1_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[218.7066192626953, 418.1972961425781, 0],[220.50521850585938, 414.77996826171875, 0],[223.74267578125, 412.6216735839844, 0],[228.59886169433594, 411.18280029296875, 0],[232.196044921875, 410.6432189941406, 0],[237.23208618164062, 410.1036376953125, 0],[242.6278533935547, 410.8230895996094, 0],[246.58474731445312, 412.4418029785156, 0],[249.4624786376953, 415.3195495605469, 0],[250.90135192871094, 418.0174255371094, 0],[250.3617706298828, 420.7153015136719, 0]]);
var n2 = createNubs([[215.82888793945312, 417.8375549316406, -10],[217.98719787597656, 413.5209655761719, -10],[221.76422119140625, 409.5640563964844, -10],[228.41900634765625, 408.3050537109375, -10],[231.65646362304688, 407.5856018066406, -10],[237.05223083496094, 406.8661804199219, -10],[242.98756408691406, 407.5856018066406, -10],[248.38333129882812, 409.38421630859375, -10],[252.8798065185547, 413.88067626953125, -10],[253.7790985107422, 418.0174255371094, -10],[252.52008056640625, 421.0750427246094, -10]]);
var n3 = createNubs([[212.7712860107422, 417.2980041503906, -20],[213.85043334960938, 414.4202575683594, -20],[215.289306640625, 412.08209228515625, -20],[221.40451049804688, 407.40576171875, -20],[228.59886169433594, 405.42730712890625, -20],[231.83631896972656, 404.8877258300781, -20],[237.23208618164062, 404.7078857421875, -20],[243.16741943359375, 406.32659912109375, -20],[247.84375, 410.4633483886719, -20],[251.80064392089844, 414.77996826171875, -20],[252.34022521972656, 418.0174255371094, -20],[251.62078857421875, 421.0750427246094, -20]]);
var n4 = createNubs([[217.44761657714844, 422.33404541015625, -30],[221.40451049804688, 418.0174255371094, -30],[224.10238647460938, 416.0389709472656, -30],[225.3614044189453, 415.3195495605469, -30],[228.23915100097656, 413.88067626953125, -30],[232.73561096191406, 413.5209655761719, -30],[237.05223083496094, 413.5209655761719, -30],[242.44798278808594, 413.7008056640625, -30],[245.3257293701172, 415.3195495605469, -30],[246.58474731445312, 416.9382629394531, -30],[247.30418395996094, 418.37713623046875, -30],[247.48403930664062, 420.3555908203125, -30]]);
var n5 = createNubs([[225.00167846679688, 421.0750427246094, -40],[225.541259765625, 419.8160095214844, -40],[226.4405517578125, 418.73687744140625, -40],[229.13844299316406, 418.0174255371094, -40],[232.3759002685547, 417.8375549316406, -40],[237.23208618164062, 418.73687744140625, -40],[240.64939880371094, 419.8160095214844, -40],[241.18898010253906, 420.8951721191406, -40],[241.7285614013672, 421.9743347167969, -40],[241.7285614013672, 423.053466796875, -40],[241.7285614013672, 424.13262939453125, -40]]);
var n6 = createNubs([[226.80027770996094, 423.4131774902344, -50],[226.98013305664062, 422.33404541015625, -50],[229.13844299316406, 421.2548828125, -50],[230.75717163085938, 421.0750427246094, -50],[233.0953369140625, 421.6145935058594, -50],[234.8939208984375, 422.33404541015625, -50],[235.793212890625, 423.5930480957031, -50],[236.15293884277344, 424.4923400878906, -50],[236.33279418945312, 425.2117919921875, -50],[236.33279418945312, 425.93121337890625, -50],[227.51971435546875, 426.6506652832031, -50]]);
var nRac1Dx = createNubs([[229.49815368652344+30, 426.83050537109375, -60],[230.93702697753906+30, 426.83050537109375, -60],[232.01617431640625+30, 426.83050537109375+1, -57],[232.73561096191406+30, 426.83050537109375+2, -56.5],[233.27519226074223+30, 427.0103759765625+3, -56],[233.8147735595703+30, 427.0103759765625+4, -56.5],[234.8939208984375+30, 427.3700866699219+5, -57],[235.9730682373047+30, 427.3700866699219+6, -60],[236.6925048828125+30, 427.3700866699219+6, -60]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,n5,n6,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var cPBoundDx =[[223.10598754882812,417.7926025390625,0 ],[223.91677856445312,415.9007568359375,0 ],[225.94374084472656,414.4143371582031,0 ],[229.32199096679688,413.3332824707031,0 ],[232.70025634765625,412.6576232910156,0 ],[235.94338989257812,412.2522277832031,0 ],[239.05140686035156,412.6576232910156,0 ],[242.02427673339844,413.7386779785156,0 ],[244.7268829345703,415.22509765625,0 ],[246.61871337890625,416.9818115234375,0 ],[247.5646209716797,419.2790222167969,0 ]];
var nBoundDx= createNubs(cPBoundDx);
var surBoundDx = createBezierS1([nBoundDx,n1])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

//Link Rought Reticulum
var nRet8 = createNubs([[221.47772216796875,401.8037109375-6,-20],[223.0006103515625,402.31134033203125-9,-20],[225.1326446533203,403.02203369140625-10,-20],[226.4524688720703,403.4281311035156-10,-20],[228.17840576171875,403.7326965332031-9,-20],[229.7012939453125,403.834228515625-9,-20],[231.52874755859375,403.7326965332031-6,-20]]);
var volumeSx = createBezierS1([n1,n2,n3,nRet8])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

 //Sx Control curves 

var n1 = createNubs([[218.7066192626953, 418.1972961425781, 0],[219.39688110351562, 420.3992614746094, 0 ],[220.7167205810547, 422.2267150878906, 0 ],[222.8487548828125, 423.6481018066406, 0 ],[227.21435546875, 423.7496032714844, 0 ],[231.98605346679688, 423.343505859375, 0 ],[237.7730255126953, 424.2572326660156, 0 ],[242.3416748046875, 425.4755554199219, 0 ],[246.60574340820312, 425.6785888671875, 0 ],[249.0423583984375, 424.05419921875, 0 ],[250.3617706298828, 420.7153015136719, 0]]);
var n2 = createNubs([[215.82888793945312, 417.8375549316406, -10],[219.06634521484375, 419.63616943359375, -10],[222.48365783691406, 422.5138854980469, -10],[225.541259765625, 423.9527587890625, -10],[229.31829833984375, 425.03192138671875, -10],[231.65646362304688, 425.3916320800781, -10],[235.793212890625, 426.111083984375, -10],[237.95152282714844, 426.2909240722656, -10],[241.7285614013672, 426.2909240722656, -10],[247.30418395996094, 423.9527587890625, -10],[252.52008056640625, 421.0750427246094, -10]]);
var n3 = createNubs([[212.7712860107422, 417.2980041503906, -20],[213.3108673095703, 421.7944641113281, -20],[216.1885986328125, 425.2117919921875, -20],[219.78578186035156, 427.5499572753906, -20],[229.67800903320312, 429.708251953125, -20],[235.25363159179688, 429.708251953125, -20],[241.54869079589844, 429.3485412597656, -20],[246.7646026611328, 427.5499572753906, -20],[249.28262329101562, 424.85205078125, -20],[251.62078857421875, 421.0750427246094, -20]]);
var n4 = createNubs([[217.44761657714844, 422.33404541015625, -30],[220.14549255371094, 424.3125, -30],[222.66351318359375, 424.85205078125, -30],[226.6204071044922, 425.5715026855469, -30],[229.49815368652344, 425.5715026855469, -30],[233.2751922607422, 425.5715026855469, -30],[236.6925048828125, 425.5715026855469, -30],[241.7285614013672, 425.7513427734375, -30],[245.50558471679688, 424.85205078125, -30],[247.48403930664062, 420.3555908203125, -30]]);
var n5 = createNubs([[225.00167846679688, 421.0750427246094, -40],[226.08084106445312, 423.23333740234375, -40],[226.08084106445312, 423.23333740234375, -40],[227.87942504882812, 423.9527587890625, -40],[230.57730102539062, 424.4923400878906, -40],[232.01617431640625, 424.4923400878906, -40],[233.45504760742188, 424.13262939453125, -40],[234.53419494628906, 423.7729187011719, -40],[235.793212890625, 423.7729187011719, -40],[237.591796875, 423.7729187011719, -40],[241.7285614013672, 424.13262939453125, -40]]);
var n6 = createNubs([[226.80027770996094, 423.4131774902344, -50],[227.69956970214844, 426.111083984375, -50],[229.67800903320312, 426.6506652832031, -50],[230.21759033203125, 426.83050537109375, -50],[232.01617431640625, 427.0103759765625, -50],[233.8147735595703, 427.0103759765625, -50],[234.1744842529297, 426.83050537109375, -50],[234.53419494628906, 426.6506652832031, -50],[235.25363159179688, 426.2909240722656, -50],[236.5126495361328, 425.93121337890625, -50],[227.51971435546875, 426.6506652832031, -50]]);
var nRac1Sx = createNubs([[229.49815368652344+30, 426.83050537109375, -60],[230.93702697753906+30, 426.83050537109375, -60],[232.01617431640625+30, 426.83050537109375+1, -63],[232.73561096191406+30, 426.83050537109375+2, -63.5],[233.27519226074223+30, 427.0103759765625+3, -64],[233.8147735595703+30, 427.0103759765625+4, -63.5],[234.8939208984375+30, 427.3700866699219+5, -63],[235.9730682373047+30, 427.3700866699219+6, -60],[236.6925048828125+30, 427.3700866699219+6, -60]]);

var volumeSx = createBezierS1([n1,n2,n3,n4,n5,n6,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var nBoundSx= createNubs([[223.10598754882812,417.7926025390625,0 ],[223.51138305664062,419.2790222167969,0 ],[224.45729064941406,420.9006042480469,0 ],[226.619384765625,421.4411315917969,0 ],[230.26791381835938,421.4411315917969,0 ],[233.51104736328125,421.1708679199219,0 ],[236.48391723632812,421.5762634277344,0 ],[239.72705078125,422.79241943359375,0 ],[243.37557983398438,423.87347412109375,0 ],[245.94305419921875,423.06268310546875,0 ],[247.42950439453125,421.7113952636719,0 ],[247.5646209716797,419.1438903808594,0 ]]);
var surBoundSx = createBezierS1([nBoundSx,n1])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));

//Link Rought Reticulum
var nRet9 = createNubs([[221.47772216796875,401.8037109375-6,-20],[223.0006103515625,402.31134033203125-9,-20],[225.1326446533203,403.02203369140625-10,-20],[226.4524688720703,403.4281311035156-10,-20],[228.17840576171875,403.7326965332031-9,-20],[229.7012939453125,403.834228515625-9,-20],[231.52874755859375,403.7326965332031-6,-20]]);
var volumeSx = createBezierS1([n1,n2,n3,nRet9])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Closure
var linkSx = createBezierS1([nRac1Dx, nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(linkSx)(domain2)));

//________________________________________________________________________________PART 6_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[227.43763732910156,438.0393371582031,0],[226.16311645507812,434.21575927734375,0],[227.7562713623047,431.34808349609375,0],[230.94256591796875,429.11767578125,0],[237.315185546875,428.48040771484375,0],[241.77601623535156,429.11767578125,0],[246.87411499023438,431.9853515625,0],[250.6976776123047,437.720703125,0]]);
var n2 = createNubs([[230.30531311035156,437.4020690917969,-20],[229.34942626953125,434.85302734375,-20],[229.98667907714844,432.94122314453125,-20],[232.5357208251953,431.6667175292969,-20],[236.6779327392578,431.6667175292969,-20],[240.50149536132812,432.6225891113281,-20],[243.05055236816406,433.8971252441406,-20],[246.55548095703125,436.7648010253906,-20]]);
var n3 = createNubs([[232.85435485839844,437.4020690917969,-40],[231.89846801757812,436.1275329589844,-40],[232.21710205078125,434.21575927734375,-40],[234.12887573242188,434.21575927734375,-40],[237.95245361328125,434.21575927734375,-40],[239.86424255371094,435.4902648925781,-40],[240.82012939453125,436.4461669921875,-40],[241.77601623535156,436.7648010253906,-40]]);

var volumeDx = createBezierS1([n1,n2,n3,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[230.30531311035156,437.4020690917969,0],[229.34942626953125,434.85302734375,0],[229.98667907714844,432.94122314453125,0],[232.5357208251953,431.6667175292969,0],[236.6779327392578,431.6667175292969,0],[240.50149536132812,432.6225891113281,0],[243.05055236816406,433.8971252441406,0],[246.55548095703125,436.7648010253906,0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs([[227.43763732910156,438.0393371582031,0],[229.76995849609375,442.181884765625,0],[232.63539123535156,444.30230712890625,0],[237.22007751464844,446.48004150390625,0],[241.9766845703125,447.39697265625,0],[246.21751403808594,447.11041259765625,0],[249.1975555419922,445.04730224609375,0],[250.8022003173828,441.15032958984375,0],[250.6976776123047,437.720703125,0]]);
var n2 = createNubs([[230.30531311035156,437.4020690917969,-20],[232.40614318847656,440.8638000488281,-20],[234.18270874023438,442.0672607421875,-20],[237.62123107910156,444.13037109375,-20],[241.74745178222656,444.5315246582031,-20],[244.8994140625,444.18768310546875,-20],[246.61866760253906,443.44268798828125,-20],[247.47830200195312,441.03570556640625,-20],[246.55548095703125,436.7648010253906,-20]]);
var n3 = createNubs([[232.85435485839844,437.4020690917969,-40],[234.698486328125,439.94683837890625,-40],[235.5008087158203,440.7491760253906,-40],[238.19432067871094,442.0672607421875,-40],[241.5755157470703,442.46844482421875,-40],[244.0970916748047,441.8380432128906,-40],[244.84210205078125,440.9783935546875,-40],[241.77601623535156,436.7648010253906,-40]]);

var volumeSx = createBezierS1([n1,n2,n3,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up =createNubs([[230.30531311035156,437.4020690917969,0],[232.40614318847656,440.8638000488281,0],[234.18270874023438,442.0672607421875,0],[237.62123107910156,444.13037109375,0],[241.74745178222656,444.5315246582031,0],[244.8994140625,444.18768310546875,0],[246.61866760253906,443.44268798828125,0],[247.47830200195312,441.03570556640625,0],[246.55548095703125,436.7648010253906,0]]);
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));


//________________________________________________________________________________PART 8_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[185.27728271484375,451.5130310058594,0],[186.71363830566406,447.2039794921875,0],[188.62876892089844,444.5706787109375,0],[191.74085998535156,442.1767578125,0],[195.3317413330078,440.7403869628906,0],[200.8377685546875,438.58587646484375,0],[205.14682006835938,437.388916015625,0],[210.4134521484375,435.4737854003906,0],[214.96189880371094,435.4737854003906,0],[218.79217529296875,438.3464660644531,0],[221.90426635742188,451.5130310058594,0]]);
var n2 = createNubs([[190.06512451171875,451.5130310058594,-12],[192.2196502685547,449.1191101074219,-12],[195.3317413330078,446.00701904296875,-12],[198.20445251464844,443.8525085449219,-12],[202.03472900390625,441.4585876464844,-12],[205.38621520996094,440.5010070800781,-12],[209.21649169921875,439.3040466308594,-12],[212.807373046875,439.3040466308594,-12],[217.11642456054688,440.7403869628906,-12],[218.79217529296875,443.61309814453125,-12],[218.5527801513672,450.79486083984375,-12]]);
var n3 = createNubs([[187.67120361328125,443.8525085449219,-24],[187.19241333007812,439.0646667480469,-24],[188.8681640625,434.9949951171875,-24],[191.74085998535156,431.1647033691406,-24],[195.0923614501953,428.77081298828125,-24],[198.44384765625,427.0950622558594,-24],[202.2741241455078,426.85565185546875,-24],[205.14682006835938,426.1374816894531,-24],[208.73770141601562,426.37689208984375,-24],[213.52554321289062,428.2920227050781,-24],[217.11642456054688,430.2071533203125,-24],[218.79217529296875,434.5162048339844,-24],[219.03155517578125,434.5162048339844,-24]]);
var n4 = createNubs([[195.57113647460938,436.6707458496094,-36],[196.52870178222656,434.9949951171875,-36],[200.8377685546875,432.3616638183594,-36],[208.01953125,430.9253234863281,-36],[212.807373046875,430.446533203125,-36],[216.1588592529297,431.64349365234375,-36],[219.2709503173828,432.60107421875,-36],[220.46791076660156,434.5162048339844,-36],[221.6648712158203,435.9525451660156,-36],[222.6224365234375,438.3464660644531,-36],[223.3406219482422,440.022216796875,-36],[224.53758239746094,442.8949279785156,-36]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[190.06512451171875,451.5130310058594,0],[192.2196502685547,449.1191101074219,0],[195.3317413330078,446.00701904296875,0],[198.20445251464844,443.8525085449219,0],[202.03472900390625,441.4585876464844,0],[205.38621520996094,440.5010070800781,0],[209.21649169921875,439.3040466308594,0],[212.807373046875,439.3040466308594,0],[217.11642456054688,440.7403869628906,0],[218.79217529296875,443.61309814453125,0],[219.03155517578125,447.2039794921875,0],[219.03155517578125,451.0342712402344,0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs(reverseR([[221.90426635742188,451.5130310058594,0],[220.46791076660156,453.6675720214844,0],[219.03155517578125,456.3008728027344,0],[215.68006896972656,458.4554138183594,0],[212.32858276367188,457.73724365234375,0],[208.73770141601562,457.73724365234375,0],[205.86500549316406,458.6947937011719,0],[201.55593872070312,462.2856750488281,0],[197.7256622314453,465.15838623046875,0],[190.78329467773438,463.96142578125,0],[186.4742431640625,459.173583984375,0],[185.27728271484375,451.5130310058594,0]]));
var n2 = createNubs(reverseR([[218.5527801513672,450.79486083984375,-12],[216.8770294189453,453.18878173828125,-12],[215.2012939453125,455.1039123535156,-12],[212.0891876220703,455.1039123535156,-12],[208.9770965576172,454.3857421875,-12],[205.86500549316406,454.6251525878906,-12],[201.31654357910156,457.4978332519531,-12],[198.92262268066406,460.37054443359375,-12],[195.3317413330078,461.328125,-12],[190.06512451171875,458.6947937011719,-12],[189.10755920410156,455.58270263671875,-12],[190.06512451171875,451.5130310058594,-12]]));
var n3 = createNubs(reverseR([[219.03155517578125,434.5162048339844,-24],[219.03155517578125,436.43133544921875,-24],[218.07398986816406,439.0646667480469,-24],[215.68006896972656,442.1767578125,-24],[208.73770141601562,443.8525085449219,-24],[203.71046447753906,444.3312683105469,-24],[196.76809692382812,444.81005859375,-24],[194.13478088378906,444.81005859375,-24],[191.98025512695312,444.5706787109375,-24],[187.67120361328125,443.8525085449219,-24]]));
var n4 = createNubs(reverseR([[224.53758239746094,442.8949279785156,-36],[221.18609619140625,444.0918884277344,-36],[219.51034545898438,444.81005859375,-36],[214.72250366210938,445.2888488769531,-36],[210.4134521484375,444.81005859375,-36],[205.38621520996094,442.1767578125,-36],[202.2741241455078,440.022216796875,-36],[198.92262268066406,438.58587646484375,-36],[196.76809692382812,437.8677062988281,-36],[195.57113647460938,436.6707458496094,-36]]));

var volumeSx = createBezierS1([n1,n2,n3,n4,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up =createNubs(reverseR([[219.03155517578125,451.0342712402344,0],[218.5527801513672,450.79486083984375,0],[216.8770294189453,453.18878173828125,0],[215.2012939453125,455.1039123535156,0],[212.0891876220703,455.1039123535156,0],[208.9770965576172,454.3857421875,0],[205.86500549316406,454.6251525878906,0],[201.31654357910156,457.4978332519531,0],[198.92262268066406,460.37054443359375,0],[195.3317413330078,461.328125,0],[190.06512451171875,451.5130310058594,0]]));
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));

//________________________________________________________________________________PART 9_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[203.94985961914062,470.90380859375,0],[207.0619659423828,474.9734802246094,0],[210.89222717285156,476.6492004394531,0],[215.68006896972656,478.0855712890625,0],[219.51034545898438,480.0007019042969,0],[223.81939697265625,483.8309631347656,0],[229.08602905273438,487.1824645996094,0],[235.07083129882812,488.85821533203125,0],[242.25259399414062,486.46429443359375,0],[246.80104064941406,483.3522033691406,0],[247.9980010986328,477.8461608886719,0],[246.5616455078125,472.5795593261719,0]]);
var n2 = createNubs([[208.01953125,470.6643981933594,-40],[210.4134521484375,473.7765197753906,-40],[214.4831085205078,474.73406982421875,-40],[217.59521484375,475.2128601074219,-40],[221.18609619140625,477.3674011230469,-40],[224.53758239746094,480.7188720703125,-40],[229.08602905273438,484.5491638183594,-40],[234.11326599121094,485.0279235839844,-40],[240.33746337890625,483.5915832519531,-40],[243.2101593017578,480.9582824707031,-40],[244.40711975097656,477.6067810058594,-40],[242.73138427734375,472.34014892578125,-40]]);
var n3 = createNubs([[215.440673828125,454.3857421875,-80],[216.39825439453125,458.6947937011719,-80],[219.51034545898438,460.37054443359375,-80],[221.90426635742188,460.6099548339844,-80],[224.53758239746094,459.4129943847656,-80],[226.69210815429688,459.4129943847656,-80],[229.80419921875,460.6099548339844,-80],[232.43751525878906,462.52508544921875,-80],[236.0283966064453,463.4826354980469,-80],[239.61927795410156,463.4826354980469,-80],[242.97076416015625,461.8069152832031,-80],[244.8859100341797,456.540283203125,-80]]);
var n4 = createNubs([[219.03155517578125,436.9101257324219,-70],[220.228515625,440.5010070800781,-70],[222.14366149902344,442.6555480957031,-70],[224.53758239746094,443.37371826171875,-70],[226.93150329589844,443.1343078613281,-70],[228.1284637451172,442.6555480957031,-70],[230.76177978515625,441.9373474121094,-70],[233.87387084960938,442.1767578125,-70],[236.0283966064453,444.5706787109375,-70],[237.94354248046875,444.81005859375,-70],[240.8162384033203,443.37371826171875,-70],[242.97076416015625,439.0646667480469,-70]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[208.01953125,470.6643981933594,0],[210.4134521484375,473.7765197753906,0],[214.4831085205078,474.73406982421875,0],[217.59521484375,475.2128601074219,0],[221.18609619140625,477.3674011230469,0],[224.53758239746094,480.7188720703125,0],[229.08602905273438,484.5491638183594,0],[234.11326599121094,485.0279235839844,0],[240.33746337890625,483.5915832519531,0],[243.2101593017578,480.9582824707031,0],[244.40711975097656,477.6067810058594,0],[242.73138427734375,472.34014892578125,0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs(reverseR([[246.5616455078125,472.5795593261719,0],[243.68894958496094,468.0310974121094,0],[240.33746337890625,465.6371765136719,0],[235.07083129882812,464.2008361816406,0],[229.80419921875,464.2008361816406,0],[226.21331787109375,465.3977966308594,0],[222.86183166503906,465.6371765136719,0],[219.2709503173828,464.6795959472656,0],[215.2012939453125,463.7220458984375,0],[211.3710174560547,463.4826354980469,0],[206.34378051757812,465.6371765136719,0],[203.94985961914062,470.90380859375,0]]));
var n2 = createNubs(reverseR([[242.73138427734375,472.34014892578125,-40],[240.57684326171875,469.94622802734375,-40],[237.7041473388672,468.0310974121094,-40],[233.6344757080078,466.8341369628906,-40],[230.28298950195312,466.8341369628906,-40],[228.1284637451172,467.7917175292969,-40],[223.58001708984375,468.749267578125,-40],[217.59521484375,467.7917175292969,-40],[214.96189880371094,466.3553466796875,-40],[211.13162231445312,466.3553466796875,-40],[208.01953125,470.6643981933594,-40]]));
var n3 = createNubs(reverseR([[244.8859100341797,456.540283203125,-80],[244.40711975097656,454.6251525878906,-80],[241.7738037109375,453.4281921386719,-80],[239.61927795410156,452.4706115722656,-80],[237.22535705566406,451.2736511230469,-80],[235.07083129882812,451.5130310058594,-80],[231.47994995117188,453.18878173828125,-80],[227.1708984375,454.1463623046875,-80],[224.53758239746094,453.4281921386719,-80],[223.10122680664062,451.9918212890625,-80],[219.51034545898438,450.55548095703125,-80],[215.440673828125,454.3857421875,-80]]));
var n4 = createNubs(reverseR([[242.97076416015625,439.0646667480469,-70],[241.534423828125,437.388916015625,-70],[239.3798828125,435.9525451660156,-70],[237.22535705566406,435.4737854003906,-70],[234.83143615722656,434.5162048339844,-70],[233.15570068359375,434.5162048339844,-70],[231.47994995117188,434.9949951171875,-70],[229.5648193359375,435.9525451660156,-70],[225.97393798828125,435.7131652832031,-70],[224.29818725585938,434.5162048339844,-70],[221.6648712158203,434.2768249511719,-70],[219.03155517578125,436.9101257324219,-70]]));

var volumeSx = createBezierS1([n1,n2,n3,n4,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up= createNubs(reverseR([[242.73138427734375,472.34014892578125,0],[240.57684326171875,469.94622802734375,0],[237.7041473388672,468.0310974121094,0],[233.6344757080078,466.8341369628906,0],[230.28298950195312,466.8341369628906,0],[228.1284637451172,467.7917175292969,0],[223.58001708984375,468.749267578125,0],[217.59521484375,467.7917175292969,0],[214.96189880371094,466.3553466796875,0],[211.13162231445312,466.3553466796875,0],[208.9770965576172,468.0310974121094,0],[208.01953125,470.6643981933594,0]]));
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));



//________________________________________________________________________________PART 2_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[269.9454650878906, 428.2642517089844, 0],[275.63092041015625, 429.5840759277344, 0],[280.4026184082031, 432.4267883300781, 0],[283.143798828125, 436.7923889160156, 0],[282.4331359863281, 439.8381652832031, 0],[279.28582763671875, 443.1885070800781, 0],[274.61566162109375, 444.0007019042969, 0],[270.3515930175781, 443.79766845703125, 0]]);
var n2 = createNubs([[270.1485290527344, 431.6145935058594, -20],[274.3110656738281, 432.7313537597656, -20],[277.5599060058594, 434.4573059082031, -20],[278.5751647949219, 435.9801940917969, -20],[278.6766662597656, 438.518310546875, -20],[277.4583740234375, 440.2442626953125, -20],[274.0065002441406, 440.548828125, -20],[270.0469970703125, 440.8534240722656, -20]]);
var n3 = createNubs([[257.15325927734375, 425.116943359375, -40],[259.48834228515625, 426.2337341308594, -40],[261.4173278808594, 427.4520263671875, -40],[262.83868408203125, 429.27947998046875, -40],[263.2447814941406, 431.9191589355469, -40],[262.2295227050781, 435.06646728515625, -40],[259.79290771484375, 435.67559814453125, -40],[254.91969299316406, 434.7618713378906, -40]]);
var n4 = createNubs([[249.2342529296875, 426.436767578125, -50],[250.65560913085938, 426.436767578125, -50],[252.5845947265625, 427.0459289550781, -50],[253.29527282714844, 428.1627197265625, -50],[253.19375610351562, 429.787109375, -50],[251.97544860839844, 430.8023681640625, -50],[250.14797973632812, 430.8023681640625, -50],[249.13272094726562, 430.29473876953125, -50]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[270.1485290527344, 431.6145935058594, 0],[274.3110656738281, 432.7313537597656, 0],[277.5599060058594, 434.4573059082031, 0],[278.5751647949219, 435.9801940917969, 0],[278.6766662597656, 438.518310546875, 0],[277.4583740234375, 440.2442626953125, 0],[274.0065002441406, 440.548828125, 0],[270.0469970703125, 440.8534240722656, 0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs([[270.3515930175781, 443.79766845703125, 0],[265.5798645019531, 443.2900390625, 0],[260.7066345214844, 442.3763122558594, 0],[257.76239013671875, 440.548828125, 0],[254.8181610107422, 437.0969543457031, 0],[254.8181610107422, 432.5283203125, 0],[256.7471618652344, 430.3962707519531, 0],[260.7066345214844, 428.2642517089844, 0],[265.2752990722656, 428.1627197265625, 0],[269.9454650878906, 428.2642517089844, 0]]);
var n2 = createNubs([[270.0469970703125, 440.8534240722656, -20],[268.7271728515625, 440.75189208984375, -20],[265.681396484375, 439.939697265625, -20],[260.80816650390625, 438.2137451171875, -20],[258.980712890625, 436.7923889160156, -20],[257.9654541015625, 434.1527099609375, -20],[260.0975036621094, 432.02069091796875, -20],[262.7371520996094, 431.4115295410156, -20],[266.2905578613281, 431.4115295410156, -20],[270.1485290527344, 431.6145935058594, -20]]);
var n3 = createNubs([[254.91969299316406, 434.7618713378906, -40],[252.5845947265625, 434.2542419433594, -40],[250.4525604248047, 432.02069091796875, -40],[249.53883361816406, 430.5993347167969, -40],[249.2342529296875, 428.46728515625, -40],[250.24951171875, 426.2337341308594, -40],[251.87391662597656, 425.2184753417969, -40],[253.49832153320312, 424.91387939453125, -40],[255.32579040527344, 424.60931396484375, -40],[257.15325927734375, 425.116943359375, -40]]);
var n4 = createNubs(reverseR([[249.13272094726562, 430.29473876953125, -50],[247.60984802246094, 430.29473876953125, -50],[246.39154052734375, 430.0917053222656, -50],[245.8839111328125, 429.4825439453125, -50],[246.0869598388672, 428.1627197265625, -50],[246.899169921875, 427.3504943847656, -50],[247.81289672851562, 427.0459289550781, -50],[248.0159454345703, 426.7413635253906, -50],[248.62509155273438, 426.5382995605469, -50],[249.2342529296875, 426.436767578125, -50]]));

var volumeSx = createBezierS1([n1,n2,n3,n4,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up =createNubs([[270.0469970703125, 440.8534240722656, 0],[268.7271728515625, 440.75189208984375, 0],[265.681396484375, 439.939697265625, 0],[260.80816650390625, 438.2137451171875, 0],[258.980712890625, 436.7923889160156, 0],[257.9654541015625, 434.1527099609375, 0],[260.0975036621094, 432.02069091796875, 0],[262.7371520996094, 431.4115295410156, 0],[266.2905578613281, 431.4115295410156, 0],[270.1485290527344, 431.6145935058594, 0]]);
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));


//________________________________________________________________________________PART 5_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[256.7492370605469, 446.23846435546875, 0],[253.57290649414062, 447.8266296386719, 0],[250.22010803222656, 451.0029602050781, 0],[247.5731658935547, 456.120361328125, 0],[247.22024536132812, 460.7084045410156, 0],[249.1613311767578, 466.7081298828125, 0],[251.45535278320312, 470.0609436035156, 0],[254.45521545410156, 474.11956787109375, 0], [257.455078125, 476.7665100097656, 0]]);
var n2 = createNubs([[256.2198486328125, 450.1206359863281, -30],[254.27874755859375, 451.3558654785156, -30],[252.69058227539062, 453.1205139160156, -30],[250.57302856445312, 456.4732971191406, -30],[250.22010803222656, 460.35546875, -30],[251.2788848876953, 465.29644775390625, -30],[252.86705017089844, 468.4727783203125, -30],[254.98460388183594, 471.1197204589844, -30],[257.27862548828125, 472.7078857421875, -30]]);
var n3 = createNubs([[254.102294921875, 436.70947265625, -50],[250.22010803222656, 437.2388610839844, -50],[248.10255432128906, 438.2976379394531, -50],[246.16146850585938, 439.88580322265625, -50],[245.10269165039062, 441.6504211425781, -50],[244.04391479492188, 443.4150390625, -50],[243.3380584716797, 445.1796875, -50],[242.8086700439453, 447.1207580566406, -50],[242.6322021484375, 449.0618591308594, -50]]);
var n4 = createNubs([[250.57302856445312, 433.1802062988281, -70],[247.5731658935547, 433.1802062988281, -70],[246.51438903808594, 433.53314208984375, -70],[244.57330322265625, 434.2389831542969, -70],[243.16159057617188, 435.4742126464844, -70],[242.6322021484375, 436.1800842285156, -70],[241.74989318847656, 437.2388610839844, -70],[241.04403686523438, 438.4740905761719, -70]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[256.2198486328125, 450.1206359863281, 0],[254.27874755859375, 451.3558654785156, 0],[252.69058227539062, 453.1205139160156, 0],[250.57302856445312, 456.4732971191406, 0],[250.22010803222656, 460.35546875, 0],[251.2788848876953, 465.29644775390625, 0],[252.86705017089844, 468.4727783203125, 0],[254.98460388183594, 471.1197204589844, 0],[257.27862548828125, 472.7078857421875, 0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs(reverseR([[256.7492370605469, 446.23846435546875, 0],[258.51385498046875, 447.1207580566406, 0],[260.4549560546875, 448.532470703125, 0],[262.2195739746094, 451.1794128417969, 0],[262.572509765625, 455.2380676269531, 0],[263.63128662109375, 459.6496276855469, 0],[264.86651611328125, 463.8847351074219, 0],[265.5723571777344, 469.53155517578125, 0],[264.86651611328125, 473.76666259765625, 0],[262.9254150390625, 476.5900573730469, 0],[260.2784729003906, 477.8252868652344, 0], [257.455078125, 476.7665100097656, 0]]));
var n2 = createNubs(reverseR([[256.2198486328125, 450.1206359863281, -30],[257.455078125, 450.47357177734375, -30],[259.0432434082031, 451.70880126953125, -30],[259.5726318359375, 453.4734191894531, -30],[259.5726318359375, 455.4145202636719, -30],[259.74908447265625, 457.3556213378906, -30],[260.63140869140625, 460.17901611328125, -30],[262.3960266113281, 463.3553466796875, -30],[262.74896240234375, 468.1198425292969, -30],[262.2195739746094, 471.4726257324219, -30],[260.9843444824219, 472.3549499511719, -30],[259.0432434082031, 472.3549499511719, -30],[257.27862548828125, 472.88433837890625, -30]]));
var n3 = createNubs(reverseR([[254.102294921875, 436.70947265625, -50],[255.3375244140625, 437.9447021484375, -50],[256.2198486328125, 440.062255859375, -50],[255.69046020507812, 442.00335693359375, -50],[254.102294921875, 443.4150390625, -50],[251.45535278320312, 443.9444274902344, -50],[250.04364013671875, 445.0032043457031, -50],[249.51425170898438, 446.9443054199219, -50],[249.51425170898438, 449.7677001953125, -50],[248.10255432128906, 452.2381896972656, -50],[245.27914428710938, 453.1205139160156, -50],[242.98513793945312, 451.70880126953125, -50], [242.6322021484375, 449.0618591308594, -50],[256.2198486328125, 450.1206359863281, -30],[257.455078125, 450.47357177734375, -30],[259.0432434082031, 451.70880126953125, -30],[259.5726318359375, 453.4734191894531, -30],[259.5726318359375, 455.4145202636719, -30],[259.74908447265625, 457.3556213378906, -30],[260.63140869140625, 460.17901611328125, -30],[262.3960266113281, 463.3553466796875, -30],[262.74896240234375, 468.1198425292969, -30],[262.2195739746094, 471.4726257324219, -30],[260.9843444824219, 472.3549499511719, -30],[259.0432434082031, 472.3549499511719, -30],[257.27862548828125, 472.88433837890625, -30]]));
var n4 = createNubs(reverseR([[250.57302856445312, 433.1802062988281, -70],[250.57302856445312, 434.5919189453125, -70],[251.1024169921875, 436.00360107421875, -70],[250.74949645996094, 437.76824951171875, -70],[248.63194274902344, 438.6505432128906, -70],[246.51438903808594, 437.76824951171875, -70],[245.27914428710938, 437.4153137207031, -70],[244.57330322265625, 437.5917663574219, -70],[244.39683532714844, 439.00347900390625, -70],[244.04391479492188, 440.5916442871094, -70],[242.45574951171875, 442.00335693359375, -70],[240.5146484375, 440.944580078125, -70],[240.16172790527344, 439.7093200683594, -70], [241.04403686523438, 438.4740905761719, -70]]));

var volumeSx = createBezierS1([n1,n2,n3,n4,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up =createNubs(reverseR([[256.2198486328125, 450.1206359863281, 0],[257.455078125, 450.47357177734375, 0],[259.0432434082031, 451.70880126953125, 0],[259.5726318359375, 453.4734191894531, 0],[259.5726318359375, 455.4145202636719, 0],[259.74908447265625, 457.3556213378906, 0],[260.63140869140625, 460.17901611328125, 0],[262.3960266113281, 463.3553466796875, 0],[262.74896240234375, 468.1198425292969, 0],[262.2195739746094, 471.4726257324219, 0],[260.9843444824219, 472.3549499511719, 0],[259.0432434082031, 472.3549499511719, 0],[257.27862548828125, 472.88433837890625, 0]]));
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));

//________________________________________________________________________________PART 3_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[274.63531494140625, 483.582275390625, 0],[278.9443664550781, 484.3004455566406, 0],[281.81707763671875, 483.1034851074219, 0],[284.45037841796875, 480.47015380859375, 0],[286.3655090332031, 476.8792724609375, 0],[288.5200500488281, 471.3732604980469, 0],[289.23822021484375, 467.064208984375, 0],[289.7170104980469, 460.6006164550781, 0],[286.84429931640625, 453.4188537597656, 0],[283.0140380859375, 449.5885925292969, 0],[275.5928649902344, 447.912841796875, 0]]);
var n2 = createNubs([[275.832275390625, 479.0338134765625, -40],[278.465576171875, 479.0338134765625, -40],[281.3382873535156, 478.3156433105469, -40],[283.9715881347656, 476.1611022949219, -40],[284.68975830078125, 471.85205078125, -40],[285.407958984375, 466.3460388183594, -40],[285.6473388671875, 460.1218566894531, -40],[283.7322082519531, 454.855224609375, -40],[281.3382873535156, 451.9825134277344, -40],[275.3534851074219, 450.5461730957031, -40]]);
var n3 = createNubs([[255.2445526123047, 452.4613037109375, -60],[259.7929992675781, 453.4188537597656, -60],[262.90509033203125, 452.4613037109375, -60],[264.5808410644531, 449.8279724121094, -60],[265.29901123046875, 447.1946716308594, -60],[265.29901123046875, 443.8431701660156, -60],[264.5808410644531, 439.7735290527344, -60],[263.3838806152344, 436.90081787109375, -60],[262.1869201660156, 434.0281066894531, -60],[260.51116943359375, 432.5917663574219, -60]]);
var n4 = createNubs([[248.3021697998047, 439.7735290527344, -80],[250.4567108154297, 441.2098693847656, -80],[251.65367126464844, 441.68865966796875, -80],[253.0900115966797, 441.68865966796875, -80],[254.76576232910156, 440.49169921875, -80],[255.4839324951172, 438.5765686035156, -80],[256.2021179199219, 435.9432373046875, -80],[256.9202880859375, 433.3099365234375, -80],[256.4414978027344, 430.4372253417969, -80],[255.4839324951172, 428.0433044433594, -80]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[275.832275390625, 479.0338134765625, 0],[278.465576171875, 479.0338134765625, 0],[281.3382873535156, 478.3156433105469, 0],[283.9715881347656, 476.1611022949219, 0],[284.68975830078125, 471.85205078125, 0],[285.407958984375, 466.3460388183594, 0],[285.6473388671875, 460.1218566894531, 0],[283.7322082519531, 454.855224609375, 0],[281.3382873535156, 451.9825134277344, 0],[275.3534851074219, 450.5461730957031, 0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs([[275.5928649902344, 447.912841796875, 0] ,[271.7626037597656, 448.6310119628906, 0],[268.6505126953125, 451.0249328613281, 0],[266.0171813964844, 454.6158142089844, 0],[265.7778015136719, 458.9248962402344, 0],[267.45355224609375, 463.47332763671875, 0],[269.84747314453125, 468.5005798339844, 0],[271.2838134765625, 472.3308410644531, 0],[270.5656433105469, 476.8792724609375, 0],[271.2838134765625, 481.6671142578125, 0], [274.63531494140625, 483.582275390625, 0]]);
var n2 = createNubs([[275.3534851074219, 450.5461730957031, -40],[272.48077392578125, 451.7431335449219, -40],[269.6080627441406, 453.89764404296875, -40],[268.6505126953125, 456.7703552246094, -40],[269.84747314453125, 460.3612365722656, -40],[271.7626037597656, 464.6702880859375, -40],[273.1989440917969, 468.9793395996094, -40],[273.1989440917969, 473.28839111328125, -40],[272.9595642089844, 477.83685302734375, -40], [275.832275390625, 479.0338134765625, -40]]);
var n3 = createNubs([[260.51116943359375, 432.5917663574219, -60],[258.8354187011719, 430.6766052246094, -60],[256.2021179199219, 430.6766052246094, -60],[254.76576232910156, 432.35235595703125, -60],[254.5263671875, 436.4220275878906, -60],[255.2445526123047, 439.0553283691406, -60],[257.1596984863281, 442.4068298339844, -60],[256.9202880859375, 445.279541015625, -60],[253.80819702148438, 447.6734619140625, -60],[253.32940673828125, 451.26434326171875, -60], [255.2445526123047, 452.4613037109375, -60]]);
var n4 = createNubs([[255.4839324951172, 428.0433044433594, -80],[253.80819702148438, 426.128173828125, -80],[252.37184143066406, 423.7342529296875, -80],[250.4567108154297, 423.2554626464844, -80],[247.82339477539062, 424.2130432128906, -80],[246.86582946777344, 426.6069641113281, -80],[247.3446044921875, 429.71905517578125, -80],[248.7809600830078, 431.6341857910156, -80],[249.02035522460938, 434.74627685546875, -80],[247.58399963378906, 436.90081787109375, -80], [248.3021697998047, 439.7735290527344, -80]]);

var volumeSx = createBezierS1([n1,n2,n3,n4,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up =createNubs([[275.3534851074219, 450.5461730957031, 0],[272.48077392578125, 451.7431335449219, 0],[269.6080627441406, 453.89764404296875, 0],[268.6505126953125, 456.7703552246094, 0],[269.84747314453125, 460.3612365722656, 0],[271.7626037597656, 464.6702880859375, 0],[273.1989440917969, 468.9793395996094, 0],[273.1989440917969, 473.28839111328125, 0],[272.9595642089844, 477.83685302734375, 0], [275.832275390625, 479.0338134765625, 0]]);
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));



//________________________________________________________________________________PART 4_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[249.03439331054688, 491.335693359375, 0],[249.93368530273438, 494.0335693359375, 0],[251.01284790039062, 497.45086669921875, 0],[253.171142578125, 501.2279052734375, 0],[256.228759765625, 504.10565185546875, 0],[260.0057678222656, 504.4653625488281, 0],[262.5238037109375, 503.38623046875, 0],[265.2216796875, 501.40777587890625, 0],[265.0418395996094, 496.7314453125, 0],[264.1425476074219, 494.3932800292969, 0],[264.8619689941406, 492.2349853515625, 0]]);
var n2 = createNubs([[252.4517059326172, 491.5155334472656, -70],[252.4517059326172, 493.13427734375, -70],[252.9912872314453, 495.4724426269531, -70],[254.61001586914062, 499.0696105957031, -70],[256.228759765625, 500.8681945800781, -70],[257.6676025390625, 501.7674865722656, -70],[259.2863464355469, 502.127197265625, -70],[261.44464111328125, 501.0480651855469, -70],[263.0633850097656, 499.9689025878906, -70],[262.8835144042969, 497.2710266113281, -70],[261.9842224121094, 494.75299072265625, -70],[262.34393310546875, 492.2349853515625, -70]]);
var n3 = createNubs([[242.0198974609375, 463.09783935546875, -80],[242.55947875976562, 465.79571533203125, -80],[243.99835205078125, 467.774169921875, -80],[246.51637268066406, 468.3137512207031, -80],[247.59552001953125, 468.1338806152344, -80],[249.7538299560547, 466.3352966308594, -80],[250.2934112548828, 464.177001953125, -80],[250.6531219482422, 462.5582580566406, -80],[250.11354064941406, 460.9395446777344, -80]]);
var n4 = createNubs([[233.02696228027344, 442.0543518066406, -6-50],[233.02696228027344, 445.65155029296875, -6-50],[233.74639892578125, 447.8098449707031, -6-50],[235.90469360351562, 448.529296875, -6-50],[237.88314819335938, 448.529296875, -6-50],[239.86158752441406, 447.8098449707031, -6-50],[240.76089477539062, 446.1911315917969, -6-50],[241.3004608154297, 444.75225830078125, -6-50],[241.3004608154297, 443.673095703125, -6-50],[241.3004608154297, 442.2342224121094, -6-50]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[252.4517059326172, 491.5155334472656, 0],[252.4517059326172, 493.13427734375, 0],[252.9912872314453, 495.4724426269531, 0],[254.61001586914062, 499.0696105957031, 0],[256.228759765625, 500.8681945800781, 0],[257.6676025390625, 501.7674865722656, 0],[259.2863464355469, 502.127197265625, 0],[261.44464111328125, 501.0480651855469, 0],[263.0633850097656, 499.9689025878906, 0],[262.8835144042969, 497.2710266113281, 0],[261.9842224121094, 494.75299072265625, 0],[262.34393310546875, 492.2349853515625, 0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs([[249.03439331054688, 491.335693359375, 0],[249.39410400390625, 489.7169494628906, 0],[250.4732666015625, 486.65936279296875, 0],[253.53086853027344, 482.88232421875, 0],[257.3078918457031, 481.80316162109375, 0],[263.9626770019531, 481.4434509277344, 0],[267.020263671875, 482.5226135253906, 0],[268.4591369628906, 484.1413269042969, 0],[268.4591369628906, 486.1197814941406, 0],[265.7612609863281, 490.6162414550781, 0],[ 264.8619689941406, 492.2349853515625, 0]]);
var n2 = createNubs([[252.4517059326172, 491.5155334472656, -70],[252.4517059326172, 490.07666015625, -70],[253.3509979248047, 486.65936279296875, -70],[256.4085998535156, 485.0406188964844, -70],[262.34393310546875, 483.60174560546875, -70],[265.0418395996094, 483.9614562988281, -70],[265.2216796875, 486.1197814941406, -70],[263.24322509765625, 488.6377868652344, -70],[ 262.34393310546875, 492.2349853515625, -70]]);
var n3 = createNubs([[242.0198974609375, 463.09783935546875, -80],[242.0198974609375, 460.579833984375, -80],[242.1997528076172, 459.1409606933594, -80],[243.99835205078125, 457.8819274902344, -80],[246.69622802734375, 456.9826354980469, -80],[249.39410400390625, 457.1625061035156, -80],[250.2934112548828, 458.2416687011719, -80],[250.2934112548828, 459.8603820800781, -80],[ 250.11354064941406, 460.9395446777344, -80]]);
var n4 = createNubs([[233.02696228027344, 442.0543518066406, -6-50],[233.20681762695312, 440.2557678222656, -6-50],[233.3866729736328, 438.6370544433594, -6-50],[234.10610961914062, 437.7377624511719, -6-50],[237.16371154785156, 437.5578918457031, -6-50],[238.6025848388672, 437.7377624511719, -6-50],[240.2213134765625, 439.3564758300781, -6-50],[ 241.3004608154297, 442.2342224121094, -6-50]]);

var volumeSx = createBezierS1([n1,n2,n3,n4,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up =createNubs([[252.4517059326172, 491.5155334472656, 0],[252.4517059326172, 490.07666015625, 0],[253.3509979248047, 486.65936279296875, 0],[256.4085998535156, 485.0406188964844, 0],[262.34393310546875, 483.60174560546875, 0],[265.0418395996094, 483.9614562988281, 0],[265.2216796875, 486.1197814941406, 0],[263.24322509765625, 488.6377868652344, 0],[ 262.34393310546875, 492.2349853515625, 0]]);
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));


//--------------------------------------------------------------------------------CELL MEMBRANE------------------------------------------------------------------------------------------

var controlsMembraneEx1 = [[144.06448364257812,29.968891143798828-10,0],[244.06448364257812,27.968891143798828-10,-70],[316.0644836425781,28.968891143798828-10,-70],[412.0644836425781,28.968891143798828-10,0]]
var controlsMembraneEx2 = [[88.06449127197266,55.96889114379883-10,0],[231.06448364257812,56.96889114379883-10,-80],[326.0644836425781,56.96889114379883-10,-80],[470.0644836425781,57.96889114379883-10,0]]
var controlsMembraneEx3 = [[61.06448745727539,84.96888732910156,0],[215.06448364257812,85.96888732910156,-90],[342.0644836425781,85.96888732910156,-80],[513.064453125,85.96888732910156,0]]
var controlsMembraneEx4 = [[30.064489364624023,114.96888732910156,0],[201.06448364257812,112.96888732910156,-70],[358.0644836425781,113.96888732910156,-70],[540.064453125,114.96888732910156,0]]
var controlsMembraneEx5 = [[4.064489841461182,141.96888732910156,0],[187.06448364257812,143.96888732910156,-200],[368.0644836425781,142.96888732910156,-200],[569.064453125+10,140.96888732910156,0]]
var controlsMembraneEx6 = [[4.064489841461182,141.96888732910156,0],[187.06448364257812,143.96888732910156,-120],[368.0644836425781,142.96888732910156,-120],[569.064453125,140.96888732910156,0]]
var controlsMembraneEx7 = [[-21.935508728027344,170.96888732910156,0],[173.06448364257812,170.96888732910156,-130],[384.0644836425781,169.96888732910156,-130],[578.064453125,171.96888732910156,0]]
var controlsMembraneEx8 = [[-35.935508728027344,217.96888732910156,0],[144.06448364257812,216.96888732910156,-180],[396.0644836425781,219.96888732910156,-180],[606.064453125,221.96888732910156,0]]
var controlsMembraneEx9 = [[-50.935508728027344,274.9688720703125,0],[116.06449127197266,278.9688720703125,-200],[414.0644836425781,278.9688720703125,-200],[620.064453125,279.9688720703125,0]]
var controlsMembraneEx10 = [[-31.935508728027344,309.9688720703125,0],[144.06448364257812,309.9688720703125,-240],[398.0644836425781,308.9688720703125,-240],[607.064453125,309.9688720703125,0]]
var controlsMembraneEx11 = [[-18.935508728027344,350.9688720703125,0],[159.06448364257812,350.9688720703125,-200],[379.0644836425781,348.9688720703125,-200],[577.064453125,348.9688720703125,0]]
var controlsMembraneEx12 = [[-16.935508728027344,395.9688720703125,0],[171.06448364257812,396.9688720703125,-180],[358.0644836425781,395.9688720703125,-180],[589.064453125,396.9688720703125,0]]
var controlsMembraneEx13 = [[3.0644898414611816,438.9688720703125,0],[187.06448364257812,438.9688720703125,-130],[347.0644836425781,441.9688720703125,-130],[580.064453125,435.9688720703125,0]]
var controlsMembraneEx14 = [[20.064489364624023,466.9688720703125,0],[202.06448364257812,467.9688720703125,-120],[334.0644836425781,467.9688720703125,-120],[551.064453125,466.9688720703125,0]]
var controlsMembraneEx15 = [[35.06448745727539,493.9688720703125,0],[215.06448364257812,494.9688720703125,-100],[318.0644836425781,493.9688720703125,-100],[538.064453125,495.9688720703125,0]]
var controlsMembraneEx16 = [[61.06448745727539,520.9688720703125,0],[227.06448364257812,522.9688720703125,-70],[306.0644836425781,521.9688720703125,-70],[510.0644836425781,522.9688720703125,0]]
var controlsMembraneEx17 = [[103.06449127197266,552.9688720703125+10,0],[244.06448364257812,550.9688720703125+10,-80],[283.0644836425781,549.9688720703125+10,-80],[470.0644836425781,550.9688720703125+10,0]]
var controlsMembraneEx18 = [[142.06448364257812,579.9688720703125+10,0],[259.0644836425781,580.9688720703125+10,-70],[279.0644836425781,581.9688720703125+10,-70],[416.0644836425781,578.9688720703125+10,0]]

var curveExMembrane = createCurveSurface([270.756103515625,-13.5130615234375+30,0],[280.2683410644531,614.7684936523438-30,0], [controlsMembraneEx1, controlsMembraneEx2, controlsMembraneEx3, controlsMembraneEx4, controlsMembraneEx5, controlsMembraneEx6, controlsMembraneEx7, controlsMembraneEx8, controlsMembraneEx9, controlsMembraneEx10, controlsMembraneEx11, controlsMembraneEx12, controlsMembraneEx13, controlsMembraneEx14, controlsMembraneEx15, controlsMembraneEx16, controlsMembraneEx17, controlsMembraneEx18]);
DRAW(COLOR(mattBurlywood)(MAP(curveExMembrane)(domain3)));


var controlsMembraneIn1 = [[119.26834106445312,28.76850700378418-30,0],[225.26834106445312,28.76850700378418-30,-130],[343.2683410644531,28.76850700378418-30,-130],[440.2683410644531,28.76850700378418-30,0]]
var controlsMembraneIn2 = [[62.268341064453125,56.76850509643555-30,0],[214.26834106445312,58.76850509643555-30,-140],[356.2683410644531,57.76850509643555-30,-140],[497.2683410644531,58.76850509643555-30,0]]
var controlsMembraneIn3 = [[33.268341064453125,86.76850891113281,0],[185.26834106445312,86.76850891113281,-145],[391.2683410644531,86.76850891113281,-145],[538.268310546875,87.76850891113281,0]]
var controlsMembraneIn4 = [[2.268343210220337,114.76850128173828,0],[179.26834106445312,113.76850128173828,-150],[396.2683410644531,114.76850128173828,-150],[567.268310546875,116.76850128173828,0]]
var controlsMembraneIn5 = [[-54.73165512084961,170.7685089111328,0],[140.26834106445312,169.7685089111328,-270],[461.2683410644531,170.7685089111328,-270],[611.268310546875,170.7685089111328,0]]
var controlsMembraneIn6 = [[-74.73165130615234,219.7685089111328,0],[110.26834106445312,218.7685089111328,-200],[546.268310546875,219.7685089111328,-200],[645.268310546875,221.7685089111328,0]]
var controlsMembraneIn7 = [[-103.73165130615234,273.76849365234375,0],[55.268341064453125,274.76849365234375,-221.5],[515.268310546875,275.76849365234375,-221.5],[675.268310546875,274.76849365234375,0]]
var controlsMembraneIn8 = [[-74.73165130615234,309.76849365234375,0],[166.26834106445312,309.76849365234375,-250],[428.2683410644531,306.76849365234375,-250],[643.268310546875,309.76849365234375,0]]
var controlsMembraneIn9 = [[-52.73165512084961,349.76849365234375,0],[190.26834106445312,351.76849365234375,-250],[350.2683410644531,352.76849365234375,-250],[611.268310546875,347.76849365234375,0]]
var controlsMembraneIn10 = [[-55.73165512084961,393.76849365234375,0],[190.26834106445312,395.76849365234375,-221.5],[350.2683410644531,396.76849365234375,-221.5],[625.268310546875,395.76849365234375,0]]
var controlsMembraneIn11 = [[-25.731657028198242,438.76849365234375,0],[166.26834106445312,440.76849365234375,-200],[440.2683410644531,440.76849365234375,-200],[600.2683410644531,441.76849365234375,0]]
var controlsMembraneIn12 = [[-7.731656551361084,466.76849365234375,0],[210.26834106445312,468.76849365234375,-270],[350.2683410644531,468.76849365234375,-270],[578.268310546875,467.76849365234375,0]]
var controlsMembraneIn13 = [[2.268343210220337,494.76849365234375,0],[216.26834106445312,494.76849365234375,-150],[327.2683410644531,493.76849365234375,-150],[565.268310546875,496.76849365234375,0]]
var controlsMembraneIn14 = [[34.268341064453125,523.7684936523438,0],[227.26834106445312,522.7684936523438,-145],[307.2683410644531,522.7684936523438,-145],[537.268310546875,523.7684936523438,0]]
var controlsMembraneIn15 = [[76.26834106445312,550.7684936523438+20,0],[214.26834106445312,550.7684936523438+20,-140],[356.2683410644531,550.7684936523438+20,-140],[497.2683410644531,552.7684936523438+20,0]]
var controlsMembraneIn16 = [[119.26834106445312,581.7684936523438+20,0],[225.2683410644531,580.7684936523438+20,-130],[343.2683410644531,578.7684936523438+20,-130],[440.2683410644531,578.7684936523438+20,0]]

var curveInMembrane = createCurveSurface([270.2683410644531,28.76850700378418-30,0],[279.2683410644531,581.7684936523438+20,0], [controlsMembraneIn1, controlsMembraneIn2, controlsMembraneIn3, controlsMembraneIn4, controlsMembraneIn5, controlsMembraneIn6, controlsMembraneIn7, controlsMembraneIn8, controlsMembraneIn9, controlsMembraneIn10, controlsMembraneIn11, controlsMembraneIn12, controlsMembraneIn13, controlsMembraneIn14, controlsMembraneIn15, controlsMembraneIn16]);
DRAW(COLOR(mattBisque)(MAP(curveInMembrane)(domain3)));

createBezierS2([curveExMembrane, curveInMembrane], mattBisque)

//--------------------------------------------------------------------------AXON---------------------------------------------------------------------


var controls60 = createNubs([[-2.9284915924072266-35, 273.9616394042969, 0 ],[-3.0094761848449707-30, 288.55059814453125, -30 ],[-3.0094761848449707-30, 305.0794982910156, -30],[-3.0094761848449707-35, 319.3544921875, 0 ]])
var controls61 = createNubs(controlsPointTranslation([[-92.41593933105469, 281.0374450683594, 0 ],[-90.9133071899414, 293.0584716796875, -26.7],[-90.9133071899414, 311.8413391113281, -26.7],[-92.41593933105469, 322.3597412109375, 0 ]], -25,0,0));
var controls62 = createNubs(controlsPointTranslation([[-156.27769470214844, 269.7677307128906, 0 ],[-162.2882080078125, 277.2808532714844, -23.4],[-170.55267333984375, 286.296630859375, -23.4],[-181.82240295410156, 293.8097839355469, 0 ]], -25,0,0));
var controls63 = createNubs(controlsPointTranslation([[-215.63156127929688, 233.70460510253906, 0 ],[-223.89602661132812, 237.461181640625, -20.1],[-235.9170684814453, 241.9690704345703, -20.1],[-243.43020629882812, 242.7203826904297, 0 ]], -25,0,0));
var controls64 = createNubs(controlsPointTranslation([[-264.4670104980469, 201.39808654785156, 0 ],[-274.234130859375, 206.65728759765625, -16.8],[-289.2604064941406, 213.4191131591797, -16.8],[-295.27093505859375, 214.9217529296875, 0 ]], -25,0,0));
var controls65 = createNubs(controlsPointTranslation([[-358.3813781738281, 156.31919860839844, 0 ],[-360.63531494140625, 163.83233642578125, -13.5],[-364.39190673828125, 170.59417724609375, -13.5],[-367.39715576171875, 177.3560028076172, 0 ]], -25,0,0));
var controls66 = createNubs(controlsPointTranslation([[-472.58123779296875, 151.81130981445312, 0 ],[-474.0838623046875, 158.57313537597656, -10.2],[-476.3377990722656, 164.58364868164062, -10.2],[-479.2711181640625, 171.63917541503906, 0 ]], -25,0,0));
var controls67 = createNubs(controlsPointTranslation([[-617.5849609375, 181.8638916015625, 0 ],[-615.3310546875, 185.62046813964844, -6.9 ],[-612.3258056640625, 192.38230895996094, -6.9 ],[-609.3204956054688, 196.89019775390625, 0 ]], -25,0,0));
var controls68 = createNubs(controlsPointTranslation([[-712.2506103515625, 211.91648864746094, 0 ],[-712.2506103515625, 217.17568969726562, -3.6 ],[-712.2506103515625, 223.93753051757812, -3.6],[-712.2506103515625, 229.9480438232422, 0 ]], -25,0,0));
var curveAxonOpen = createBezierS1([controls60,controls61, controls62, controls63, controls64, controls65, controls66, controls67, controls68]);
DRAW(COLOR(mattBisque)(MAP(curveAxonOpen)(domain2)));


var controls69 = createNubs([[-3.023437976837158-35, 278.32452392578125, 0 ],[-3.342068672180176-30, 292.0256652832031, -25 ],[-3.342068672180176-30, 302.2218322753906, -25 ],[-3.023437976837158-35, 315.9229736328125, 0 ]])
var controls70 = createNubs(controlsPointTranslation([[-92.24007415771484, 284.05987548828125, 0 ],[-90.96554565429688, 296.4864807128906, -22.3],[-90.96554565429688, 308.9130859375, -22.3],[-92.24007415771484, 318.15338134765625, 0 ]], -25,0,0));
var controls71 = createNubs(controlsPointTranslation([[-158.1966552734375, 273.2264404296875, 0 ],[-165.20652770996094, 280.236328125,-19.6],[-167.75558471679688, 283.7412414550781,-19.6],[-176.67724609375, 289.79522705078125, 0 ]], -25,0,0));
var controls72 = createNubs(controlsPointTranslation([[-219.69239807128906, 235.3093719482422, 0 ],[-226.0650177001953, 238.4956817626953, -16.9],[-231.4817352294922, 240.407470703125, -16.9],[-238.4916229248047, 242.63787841796875, 0 ]], -25,0,0));
var controls73 = createNubs(controlsPointTranslation([[-269.3988037109375, 204.08355712890625, 0 ],[-278.0018310546875, 208.5443878173828, -14.2],[-283.4185791015625, 211.0934295654297, -14.2],[-291.0657043457031, 213.9611053466797, 0 ]], -25,0,0));
var controls74 = createNubs(controlsPointTranslation([[-359.2527160644531, 160.43112182617188, 0 ],[-361.8017578125, 165.52920532226562, -11.5],[-363.7135314941406, 169.03414916992188, -11.5],[-365.62530517578125, 173.1763458251953, 0 ]], -25,0,0));
var controls75 = createNubs(controlsPointTranslation([[-473.3225402832031, 156.28890991210938, 0 ],[-474.91571044921875, 160.43112182617188, -8.8],[-475.87158203125, 162.66152954101562, -8.8],[-478.10198974609375, 167.1223602294922, 0 ]], -25,0,0));
var controls76 = createNubs(controlsPointTranslation([[-615.82177734375, 184.527587890625, 0 ],[-614.562744140625, 186.68588256835938, -6.1],[-613.3037719726562, 189.38377380371094, -6.1],[-611.68505859375, 193.52052307128906, 0 ]], -25,0,0));
var controls77 = createNubs(controlsPointTranslation([[-712.0462036132812, 215.82301330566406, 0 ],[-712.4059448242188, 219.42018127441406,-3.4],[-712.4059448242188, 221.3986358642578, -3.4],[-712.5857543945312, 225.35552978515625, 0 ]], -25,0,0));
var curveAxonOpenInner = createBezierS1([controls69,controls70, controls71, controls72, controls73, controls74, controls75, controls76, controls77]);
DRAW(COLOR(mattBisque)(MAP(curveAxonOpenInner)(domain2)));

createBezierS2([curveAxonOpenInner, curveAxonOpen], mattBisque);

var controls61 = [[-2.9284915924072266-35,273.9616394042969,0],[-3.0094761848449707-30,288.55059814453125,0],[-3.0094761848449707-30,305.0794982910156,0],[-3.0094761848449707-35,319.3544921875,0]]
var controls79 =  createNubs(controlsPointTranslation([[-3.6292459964752197,292.3113708496094,0],[-3.6292459964752197,294.86041259765625,0],[-3.9478769302368164,296.7721862792969,0],[-3.6292459964752197,300.9143981933594,0]], -35,0,0));
var controls80 =  createNubs(controlsPointTranslation([[-90.93409729003906,296.45355224609375,0],[-90.93409729003906,299.0025939941406,0],[-90.93409729003906,303.7820739746094,0],[-90.93409729003906,308.8801574707031,0]], -35,-8,0));
var controls81 =  createNubs(controlsPointTranslation([[-162.30740356445312,277.335693359375,0],[-165.49371337890625,279.884765625,0],[-167.40550231933594,284.3455810546875,0],[-169.9545440673828,285.9387512207031,0]], -35,-3,0));
var controls82 =  createNubs(controlsPointTranslation([[-224.1217803955078,238.1441192626953,0],[-226.67083740234375,238.46275329589844,0],[-231.1316680908203,240.05589294433594,0],[-235.9111328125,242.28631591796875,0]], -35,-8,0));
var controls83 =  createNubs(controlsPointTranslation([[-274.1468200683594,206.91830444335938,0],[-278.2890319824219,208.83009338378906,0],[-283.0685119628906,211.0605010986328,0],[-288.4852294921875,212.9722900390625,0]], -35,-14,0));
var controls84 =  createNubs(controlsPointTranslation([[-361.1330871582031,163.5845184326172,0],[-362.0889587402344,165.81492614746094,0],[-363.68212890625,169.00123596191406,0],[-364.9566345214844,171.23165893554688,0]], -35,+2,0));
var controls85 =  createNubs(controlsPointTranslation([[-473.6097717285156,158.48641967773438,0],[-474.88427734375,160.7168426513672,0],[-475.8401794433594,162.94725036621094,0],[-476.4774475097656,164.22177124023438,0]], -35,+8,0));
var controls86 =  createNubs(controlsPointTranslation([[-615.0818481445312,186.20730590820312,0],[-614.76318359375,187.16319274902344,0],[-613.4887084960938,189.07498168945312,0],[-612.2141723632812,190.6681365966797,0]], -35,+1,0));
var controls87 =  createNubs(controlsPointTranslation([[-712.2642211914062,216.79586791992188,0],[-712.9014892578125,219.34490966796875,0],[-712.2642211914062,221.25669860839844,0],[-711.9456176757812,223.16847229003906,0]], -25,0,0));
var curveAxonOpenInner2 = createBezierS1([controls79, controls80, controls81, controls82, controls83, controls84, controls85, controls86, controls87]);
DRAW(COLOR(mattIndianRed)(MAP(curveAxonOpenInner2)(domain2)));


var con1 = controlsPointTranslation([[-712.2506103515625,211.91648864746094,0],[-712.2506103515625,217.17568969726562,-3],[-712.2506103515625,223.93753051757812,-3],[-712.2506103515625,229.9480438232422,0]], -25,0,0);
var con2 = controlsPointTranslation([[-721.296630859375,206.88430786132812,0],[-721.296630859375,216.48036193847656,-5],[-721.861083984375,223.25405883789062,-5],[-721.861083984375,236.80142211914062,0]], -25,0,0);
var con3 = controlsPointTranslation([[-732.5861206054688,201.80404663085938,0],[-732.0216674804688,216.48036193847656,-8],[-732.0216674804688,222.12510681152344,-8],[-732.0216674804688,241.3172149658203,0]], -25,0,0);
var con4 = controlsPointTranslation([[-743.8756103515625,197.2882537841797,0],[-743.3110961914062,213.6580047607422,-10],[-742.7466430664062,222.12510681152344,-10],[-743.8756103515625,247.52642822265625,0]], -25,0,0);
var con5 = controlsPointTranslation([[-753.4716186523438,202.36851501464844,0],[-753.4716186523438,214.7869415283203,-8],[-753.4716186523438,219.86721801757812,-8],[-755.1651000976562,239.62379455566406,0]], -25,0,0);
var con6 = controlsPointTranslation([[-761.9387817382812,208.57772827148438,0],[-762.5032348632812,216.48036193847656,-5],[-762.5032348632812,222.12510681152344,-5],[-763.6322021484375,232.85011291503906,0]], -25,0,0);
var finalpoint = [-770.4058837890625-18,220.99615478515625,0];
var curveSinapsiOuter = createCurveSurface2(finalpoint, [con1, con2, con3, con4, con5, con6]); 
DRAW(COLOR(mattBisque)(MAP(curveSinapsiOuter)(domain2)));

var con7 = controlsPointTranslation([[-712.2506103515625,211.91648864746094,0],[-712.2506103515625,217.17568969726562,-2],[-712.2506103515625,223.93753051757812,-2],[-712.2506103515625,229.9480438232422,0]], -25,0,0);
var con8 = controlsPointTranslation([[-715.7742309570312,214.36476135253906,0],[-715.0548095703125,219.58065795898438,-4],[-715.234619140625,223.35769653320312,-4],[-715.0548095703125,227.31459045410156,0]], -25,0,0);
var con9 = controlsPointTranslation([[-721.5297241210938,211.12730407714844,0],[-721.1699829101562,216.34320068359375,-6],[-721.889404296875,223.35769653320312,-6],[-722.0692749023438,232.3506317138672,0]], -25,0,0);
var con10 = controlsPointTranslation([[-732.5010986328125,207.53012084960938,0],[-731.601806640625,216.34320068359375,-8],[-732.3212280273438,221.7389678955078,-8],[-731.601806640625,235.22837829589844,0]], -25,0,0);
var con11 = controlsPointTranslation([[-743.65234375,203.75308227539062,0],[-743.65234375,214.1848907470703,-6],[-742.7530517578125,222.45840454101562,-6],[-743.8322143554688,240.6241455078125,0]], -25,0,0);
var con12 = controlsPointTranslation([[-753.3646850585938,207.3502655029297,0],[-753.1848754882812,215.80361938476562,-4],[-753.5445556640625,219.76051330566406,-4],[-754.8035888671875,234.6887969970703,0]], -25,0,0);
var con13 = controlsPointTranslation([[-762.357666015625,212.02659606933594,0],[-762.357666015625,218.68136596679688,-2],[-762.1777954101562,224.25698852539062,-2],[-763.0770874023438,227.8541717529297,0]], -25,0,0);
var finalpoint2 = [-767.2138671875-20,221.01953125,0];
var curveSinapsiInner = createCurveSurface2(finalpoint, [con7, con8, con9, con10, con11, con12, con13]); 
DRAW(COLOR(mattBisque)(MAP(curveSinapsiInner)(domain2)));

createBezierS2([curveSinapsiInner, curveSinapsiOuter], mattBisque);

var controlsMicrofilament = [[-3.6292459964752197-35,292.3113708496094+15,0],[-90.93409729003906-35,296.45355224609375+5,0],[-162.30740356445312-35,277.335693359375-2,0],[-162.30740356445312-35,277.335693359375-3,0],[-224.1217803955078-55,238.1441192626953,0],[-274.1468200683594-85,206.91830444335938-4,0],[-361.1330871582031+3,163.5845184326172+42,-5]]
var nubsMicrofilament = createNubs(controlsMicrofilament);
DRAW(COLOR(mattGold)(MAP(nubsMicrofilament)(domain1)));

var controlsMicrofilament2 = [[-3.6292459964752197-35,292.3113708496094+20,0],[-90.93409729003906-35,296.45355224609375+10,0],[-162.30740356445312-50,277.335693359375-10,0],[-162.30740356445312-35,277.335693359375-3,0],[-224.1217803955078-55,238.1441192626953,0],[-274.1468200683594-85,206.91830444335938-4,0],[-361.1330871582031+3,163.5845184326172+42,-5]]
var nubsMicrofilament2 = createNubs(controlsMicrofilament2);
DRAW(COLOR(mattGold)(MAP(nubsMicrofilament2)(domain1)));

var controlsMicrofilament3 = [[-3.6292459964752197-35,292.3113708496094-5,0],[-90.93409729003906-35,296.45355224609375-10,0],[-162.30740356445312-55,277.335693359375-28,0],[-162.30740356445312-35,277.335693359375-20,0],[-224.1217803955078-55,238.1441192626953-12,0],[-274.1468200683594-85,206.91830444335938-10,0],[-361.1330871582031-100,163.5845184326172+30,0]]
var nubsMicrofilament3 = createNubs(controlsMicrofilament3);
var prova = COLOR(mattGold)(MAP(nubsMicrofilament3)(domain1));
DRAW(prova);


var controlsMicrofilament3 = [[-3.6292459964752197-35,292.3113708496094-5,0],[-90.93409729003906-10,296.45355224609375-15,0],[-162.30740356445312+25,277.335693359375-1,0],[-224.1217803955078+15,238.1441192626953+12,0],[-274.1468200683594,206.91830444335938+18,0],[-361.1330871582031+13,163.5845184326172+32.5,0]]
var nubsMicrofilament3 = createNubs(controlsMicrofilament3);
DRAW(COLOR(mattGold)(MAP(nubsMicrofilament3)(domain1)));

var controlsMicrofilament4 = [[-3.6292459964752197-35,292.3113708496094-10,0],[-90.93409729003906-35,296.45355224609375-15,0],[-162.30740356445312-55,277.335693359375-28,0],[-162.30740356445312-35,277.335693359375-20,0],[-224.1217803955078-55,238.1441192626953-12,0],[-274.1468200683594-85,206.91830444335938-10,0],[-361.1330871582031-100,163.5845184326172+30,0]]
var nubsMicrofilament4 = createNubs(controlsMicrofilament4);
var prova = COLOR(mattGold)(MAP(nubsMicrofilament4)(domain1));
DRAW(prova);

var controls88 = [[-719.559326171875,211.6128692626953-3,-2],[-715.6080322265625,211.6128692626953-3,-2.5],[-709.3988037109375,211.6128692626953-3,-2.5],[-707.1409301757812,210.48391723632812-3,-2]]
var controls89 = [[-724.0751342773438,207.09707641601562,-3],[-722.3817138671875,207.09707641601562,-3.75],[-720.6882934570312,205.96812438964844,-3.75],[-718.430419921875,205.40365600585938,-3]]
var controls90 = [[-735.3646240234375,197.5010223388672,-3],[-733.6712036132812,195.80760192871094,-3.25],[-732.542236328125,195.80760192871094,-3.25],[-731.413330078125,194.1141815185547,-3]]
var controls91 = [[-760.2014770507812,169.841796875,-3],[-757.943603515625,168.14837646484375,-3.125],[-756.490966796875,143.3115234375,-3.125],[-755.3619995117188,142.74703979492188,-3]]
var controls92 = [[-766.9751586914062,142.74703979492188,-3],[-773.7488403320312,117.34571838378906,-3.1],[-771.490966796875,116.78124237060547,-3.1],[-769.7975463867188,116.78124237060547,-3]]
var finalPoint7 = [-761.8948974609375,80.6549072265625,-3];

var curveDendrite1Under = createCurveSurface2(finalPoint7, [controls88, controls89, controls90, controls91, controls92]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite1Under)(domain2)));

var controls88 = [[-719.559326171875,211.6128692626953-3,-2],[-715.6080322265625,211.6128692626953-3,-2.5],[-709.3988037109375,211.6128692626953-3,-2.5],[-707.1409301757812,210.48391723632812-3,-2]];
var controls89 = [[-724.0751342773438,207.09707641601562,-3],[-722.3817138671875,207.09707641601562,-2.1],[-720.6882934570312,205.96812438964844,-2.1],[-718.430419921875,205.40365600585938,-3]]
var controls90 = [[-735.3646240234375,197.5010223388672,-3],[-733.6712036132812,195.80760192871094,-2.125],[-732.542236328125,195.80760192871094,-2.125],[-731.413330078125,194.1141815185547,-3]]
var controls91 = [[-760.2014770507812,169.841796875,-3],[-757.943603515625,168.14837646484375,-2.25],[-756.490966796875,143.3115234375,-2.25],[-755.3619995117188,142.74703979492188,-3]]
var controls92 = [[-766.9751586914062,142.74703979492188,-3],[-773.7488403320312,117.34571838378906,-2.75],[-771.490966796875,116.78124237060547,-2.75],[-769.7975463867188,116.78124237060547,-3]]
var finalPoint7 = [-761.8948974609375,80.6549072265625,-3];

var curveDendrite1Upper = createCurveSurface2(finalPoint7, [controls88, controls89, controls90, controls91, controls92]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite1Upper)(domain2)));


var controls93 = [[-767.7393798828125+4,113.60464477539062,-3],[-767.7393798828125+4,116.23796081542969,-3],[-767.7393798828125+4,117.91370391845703,-3],[-767.7393798828125+4.5,120.06822967529297,-3]]
var controls94 = controlsPointTranslation([[-764.3878784179688,115.04100036621094,0],[-764.1484985351562,115.99856567382812,0],[-763.9090576171875,117.43492126464844,0],[-763.669677734375,118.87126922607422,0]], 0,0,-3);
var controls95 = controlsPointTranslation([[-759.8394165039062,113.84403991699219,0],[-759.6000366210938,115.28038787841797,0],[-759.8394165039062,116.47734832763672,0],[-759.8394165039062,117.91370391845703,0]], 0,0,-3);
var controls96 = controlsPointTranslation([[-755.0515747070312,112.88646697998047,0],[-755.0515747070312,113.60464477539062,0],[-754.5728149414062,114.56221771240234,0],[-754.5728149414062,115.51978302001953,0]], 0,0,-3);
var finalPoint8 = [-749.5455322265625,113.12586212158203,-3]

var curveDentrite1 = createCurveSurface2(finalPoint8, [controls93, controls94, controls95, controls96]);
DRAW(COLOR(mattBisque)(MAP(curveDentrite1)(domain2)))

var con14 = [[-768.1600341796875+9,134.2810516357422,-3],[-767.9569702148438+9,134.68714904785156,-3],[-767.5508422851562+9,135.2963104248047,-3],[-767.144775390625+9,135.60089111328125,-3]]
var con15 = [[-762.373046875,130.9307098388672,-3],[-762.1699829101562,131.13375854492188,-3],[-762.0684814453125,131.53985595703125,-3],[-761.763916015625,131.8444366455078,-3]]
var con16 = [[-752.322021484375,123.3162841796875,-3],[-751.9158935546875,123.51934051513672,-3],[-751.611328125,123.62086486816406,-3],[-751.3067626953125,123.82391357421875,-3]]
var finalPoint9 = [-741.0526733398438,113.87440490722656,-3];
var curveDendrite2 = createCurveSurface2(finalPoint9,[con14, con15, con16]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite2)(domain2)));

var con17 = [[-745.0995483398438-0.1,117.72412872314453,-3],[-744.9276123046875-0.1,117.60951232910156,-3],[-744.84716796875-0.1,117.5472412109375,-3],[-744.7501220703125-0.1,117.48253631591797,-3]]
var con18 = [[-745.88232421875,115.44454193115234,-3],[-745.817626953125,115.44454193115234,0-3],[-745.7852783203125,115.41219329833984,-3],[-745.7852783203125,115.41219329833984,-3]]
var finalpoint10 = [-746.335205078125,113.37419128417969,-3]
var curveDendrite3 = createCurveSurface2(finalpoint10, [con17, con18]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite3)(domain2)))

var con19 = [[-745.7793579101562,115.40352630615234,-3],[-745.7930908203125,115.36236572265625,-3],[-745.7930908203125,115.32121276855469,-3],[-745.8067626953125,115.2800521850586,-3]]
var finalPoint11 = [-744.4348754882812,113.90812683105469,-3];
var curveDendrite4 = createCurveSurface2(finalPoint11, [con19]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite4)(domain2)));

var con20 = [[-745.8746337890625,115.33885955810547,-3],[-745.8746337890625,115.31558227539062,-3],[-745.8746337890625,115.28649139404297,-3],[-745.8746337890625,115.25740051269531,-3]]
var finalPoint12 = [-747.1138916015625,114.48356628417969,-3]
var curveDendrite5 = createCurveSurface2(finalPoint12, [con20]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite5)(domain2)));

var con21 = [[-742.810791015625,115.546142578125-0.1,-3],[-742.7560424804688,115.49136352539062-0.1,-3],[-742.6829833984375,115.49136352539062-0.1,-3],[-742.6829833984375,115.45484161376953-0.1,-3]]
var finalPoint13 = [-743.084716796875,114.15836334228516,-3]
var curveDendrite6 = createCurveSurface2(finalPoint13, [con21]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite6)(domain2)));

var con22 = [[-742.0177612304688-0.1,114.8627700805664,-3],[-741.9945068359375-0.1,114.83179473876953,-3],[-741.9867553710938-0.1,114.79307556152344,-3],[-741.9635620117188-0.1,114.76984405517578,-3]]
var finalPoint14 = [-740.848388671875,114.98667907714844,-3]
var curveDendrite7 = createCurveSurface2(finalPoint14, [con22]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite7)(domain2)));

var con23 = [[-775.4422607421875+15,125.24835205078125,-3],[-776.0067138671875+15,126.3772964477539,-3],[-776.0067138671875+15,126.3772964477539,-3],[-776.5712280273438+15,128.63519287109375,-3]]
var con24 = [[-785.602783203125,109.44307708740234,-3],[-786.1672973632812,109.44307708740234,-3],[-786.7317504882812,111.13650512695312,-3],[-788.4251708984375,112.26544952392578,-3]]
var finalPoint15 = [-811.568603515625,91.37991333007812,-3]
var curveDendrite8 = createCurveSurface2(finalPoint15, [con23, con24]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite8)(domain2)));

var con25 = [[-804.758056640625,97.09049224853516,-3],[-804.6607666015625,97.15713500976562,-3],[-804.6058959960938,97.19828796386719,-3],[-804.551025390625,97.2257308959961,-3]]
var finalPoint16 = [-804.1952514648438,92.71627807617188,-3];
var curveDendrite9 = createCurveSurface2(finalPoint16, [con25]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite9)(domain2)));

var con26 = [[-804.758056640625,97.09049224853516,-3],[-804.6607666015625,97.15713500976562,-3],[-804.6058959960938,97.19828796386719,-3],[-804.551025390625,97.2257308959961,-3]]
var finalPoint17 = [-811.6441040039062,96.11776733398438,-3]
var curveDendrite10 = createCurveSurface2(finalPoint17, [con26]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite10)(domain2)));

var con27 = [[-804.324462890625-0.1,94.69689178466797-0.1,-3],[-804.3674926757812-0.05,94.82606506347656-0.05,-3],[-804.3674926757812-0.1,94.82606506347656-0.1,-3],[-804.3674926757812-0.02,95.08440399169922-0.1,-3]]
var finalpoint11 = [-801.5257568359375,94.52466583251953,-3];
var curveDendrite11 = createCurveSurface2(finalpoint11, [con27]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite11)(domain2)));

//--------------------------------------------------------------------------------NEURON DENDRITE 1 -------------------------------------------------------------------------------------------

var controls12 = controlsPointTranslation([[531.6243896484375, 439.8178405761719, 0],[536.14013671875-10, 433.0441589355469-20, -20],[541.0733642578125-10, 423.8709411621094-20, -20],[545.7362060546875, 412.15863037109375, 0]],-60,0,-100)
var controls13 = controlsPointTranslation([[596.7022705078125, 475.6723327636719, 0 ],[599.8886108398438, 469.9369812011719, -16.6 ],[603.0748901367188, 464.8388671875, -16.6 ],[606.2611694335938, 458.7848815917969, 0 ]], -60,0,-100);
var controls14 = controlsPointTranslation([[651.1881713867188, 531.4327392578125, 0 ],[654.0897216796875, 528.93310546875, -13.2],[658.197998046875, 525.6973876953125, -13.2 ],[662.9774780273438, 521.873779296875, 0 ]], -60,0,-100);
var controls15 = controlsPointTranslation([[697.162109375, 626.8892822265625, 0 ],[700.8946533203125, 624.1543579101562, -9.8 ],[708.22314453125, 620.330810546875, -9.8 ],[712.4564208984375, 619.2421264648438, 0 ]], -60,0,-100);
var controls16 = controlsPointTranslation([[735.7164916992188, 683.2869262695312, 0 ],[739.767578125, 681.1892700195312, -6.4 ],[745.8215942382812, 678.6402587890625, -6.4 ],[750.0548706054688, 677.23291015625, 0 ]], -60,0,-100);
var controls17 = controlsPointTranslation([[794.7738037109375, 746.343017578125, 0 ],[797.779052734375, 740.33251953125, -3.0 ],[799.2816772460938, 735.0733032226562, -3.0 ],[801.5355834960938, 728.3114624023438, 0 ]], -60,0,-100);
var controls18 = controlsPointTranslation([[898.9223022460938, 776.568359375, 0 ],[901.18017578125, 771.4880981445312, 0 ],[902.8735961914062, 766.4078369140625, 0 ],[904.0025634765625, 761.8920288085938, 0 ]], -60,0,-100);
var finalPoint1 = [1016.767822265625-60, 819.8773803710938, -50 ];
var curveNeuron1Under = createCurveSurface2(finalPoint1, [controls12, controls13, controls14, controls15, controls16, controls17, controls18]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron1Under)(domain2)));

var controls12 = controlsPointTranslation([[531.6243896484375, 439.8178405761719, 0],[536.14013671875+10, 433.0441589355469+20, 20],[541.0733642578125+10, 423.8709411621094+20, 20],[545.7362060546875, 412.15863037109375, 0]],-60,0,-100)
var controls13 = controlsPointTranslation([[596.7022705078125, 475.6723327636719, 0 ],[599.8886108398438, 469.9369812011719, 16.6 ],[603.0748901367188, 464.8388671875, 16.6 ],[606.2611694335938, 458.7848815917969, 0 ]], -60,0,-100);
var controls14 = controlsPointTranslation([[651.1881713867188, 531.4327392578125, 0 ],[654.0897216796875, 528.93310546875, 13.2],[658.197998046875, 525.6973876953125, 13.2 ],[662.9774780273438, 521.873779296875, 0 ]], -60,0,-100);
var controls15 = controlsPointTranslation([[697.162109375, 626.8892822265625, 0 ],[700.8946533203125, 624.1543579101562, 9.8 ],[708.22314453125, 620.330810546875, 9.8 ],[712.4564208984375, 619.2421264648438, 0 ]], -60,0,-100);
var controls16 = controlsPointTranslation([[735.7164916992188, 683.2869262695312, 0 ],[739.767578125, 681.1892700195312, 6.4 ],[745.8215942382812, 678.6402587890625, 6.4 ],[750.0548706054688, 677.23291015625, 0 ]], -60,0,-100);
var controls17 = controlsPointTranslation([[794.7738037109375, 746.343017578125, 0 ],[797.779052734375, 740.33251953125, 3.0 ],[799.2816772460938, 735.0733032226562, 3.0 ],[801.5355834960938, 728.3114624023438, 0 ]], -60,0,-100);
var controls18 = controlsPointTranslation([[898.9223022460938, 776.568359375, 0 ],[901.18017578125, 771.4880981445312, 0 ],[902.8735961914062, 766.4078369140625, 0 ],[904.0025634765625, 761.8920288085938, 0 ]], -60,0,-100);

var curveNeuron1Upper = createCurveSurface2(finalPoint1, [controls12, controls13, controls14, controls15, controls16, controls17, controls18]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron1Upper)(domain2)));

//----------------------------------------------------------------------------------------BRANCH------------------------------------------------------------------------------------------------

var controls23 = controlsPointTranslation([[701.4566040039062, 594.3966064453125, 0],[703.7144775390625, 599.4768676757812, -10],[705.972412109375, 603.4281616210938, -10],[708.7947998046875, 610.2018432617188, 0]],-65,0,-100);
var controls24 = controlsPointTranslation([[775.9671630859375, 538.513671875, 0],[779.6598510742188, 543.3978271484375, -8],[784.998779296875, 547.5452270507812, -8],[789.5145263671875, 555.4478759765625, 0]], -60,0,-100);
var controls25 = controlsPointTranslation([[808.7066650390625, 508.5965270996094, 0],[812.0556030273438, 514.9810180664062, -6],[815.8792114257812, 521.6723022460938, -6],[820.5606079101562, 528.9176025390625, 0]], -60,0,-100);
var controls26 = controlsPointTranslation([[890.7574462890625, 521.6723022460938, 0],[887.8897705078125, 527.0889892578125, -4],[885.0220947265625, 532.5057373046875, -4],[881.5171508789062, 538.8783569335938, 0]], -60,0,-100);
var controls27 = controlsPointTranslation([[941.4197387695312, 535.0547485351562, 0],[941.7384033203125, 538.8783569335938, -2],[942.0570068359375, 543.6577758789062, -2],[942.6942749023438, 548.7559204101562, 0]], -60,0,-100);
var controls28 = controlsPointTranslation([[984.4349365234375, 505.4220886230469, 0],[986.25732421875, 507.2715148925781, 0],[987.6212158203125, 509.8829345703125, 0],[989.21435546875, 512.1133422851562, 0]], -65,0,-100);
var finalPoint2 = [997.2630004882812-60,451.7737731933594,-150]

var curveNeuron2Under = createCurveSurface2(finalPoint2, [controls23, controls24, controls25, controls26, controls27, controls28]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron2Under)(domain2)));

var controls23 = controlsPointTranslation([[701.4566040039062, 594.3966064453125, 0],[703.7144775390625, 599.4768676757812, 10],[705.972412109375, 603.4281616210938, 10],[708.7947998046875, 610.2018432617188, 0]],-65,0,-100);
var controls24 = controlsPointTranslation([[775.9671630859375, 538.513671875, 0],[779.6598510742188, 543.3978271484375, 8],[784.998779296875, 547.5452270507812, 8],[789.5145263671875, 555.4478759765625, 0]], -60,0,-100);
var controls25 = controlsPointTranslation([[808.7066650390625, 508.5965270996094, 0],[812.0556030273438, 514.9810180664062, 6],[815.8792114257812, 521.6723022460938, 6],[820.5606079101562, 528.9176025390625, 0]], -60,0,-100);
var controls26 = controlsPointTranslation([[890.7574462890625, 521.6723022460938, 0],[887.8897705078125, 527.0889892578125, 4],[885.0220947265625, 532.5057373046875, 4],[881.5171508789062, 538.8783569335938, 0]], -60,0,-100);
var controls27 = controlsPointTranslation([[941.4197387695312, 535.0547485351562, 0],[941.7384033203125, 538.8783569335938, 2],[942.0570068359375, 543.6577758789062, 2],[942.6942749023438, 548.7559204101562, 0]], -60,0,-100);
var controls28 = controlsPointTranslation([[984.4349365234375, 505.4220886230469, 0],[986.25732421875, 507.2715148925781, 0],[987.6212158203125, 509.8829345703125, 0],[989.21435546875, 512.1133422851562, 0]], -65,0,-100);

var curveNeuron2Upper = createCurveSurface2(finalPoint2, [controls23, controls24, controls25, controls26, controls27, controls28]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron2Upper)(domain2)));


//-------------------------------------------------------------------------------NEURON DENTRITE 2----------------------------------------------------------------------

var controls35 = controlsPointTransformation([[250.13494873046875,296.8428649902344-100,300],[274.1138610839844,296.71685791015625-100,300+40],[293.1138610839844,296.71685791015625-100,300+40],[313.9111328125,295.0713195800781-100,300]]);
var controls36 = controlsPointTransformation([[254.6446990966797, 351.1073913574219-100,300+40],[253.6783447265625,318.5879211425781-100,300+36.4+40],[276.7083740234375,319.8731689453125-100,300+36.4+40],[308.43231201171875,320.2813415527344-100,300+40]]);
var controls37 = controlsPointTransformation([[226.0191192626953,353.02081298828125-100,300+76],[248.36338806152344,351.7612609863281-100,300+32.8+76],[287.3377380371094,349.98968505859375-100,300+32.8+76],[305.0533447265625,349.98968505859375-100,300+76]]);
var controls38 = controlsPointTransformation([[244.8202667236328,385.4209289550781-100,300+112],[264.30743408203125,385.4209289550781-100,300+29.2+112],[296.1955261230469,385.4209289550781-100,300+29.2+112],[315.6827087402344,383.64935302734375-100,300+112]]);
var controls39 = controlsPointTransformation([[264.30743408203125,419.08056640625-100,300+148],[280.2514953613281,419.08056640625-100,300+25.6+148],[305.0533447265625,417.30902099609375-100,300+25.6+148],[320.99737548828125,417.30902099609375-100,300+148]]);
var controls40 = controlsPointTransformation([[271.3936767578125,449.1971130371094-100,300+184],[283.79461669921875,447.425537109375-100,300+22+184],[308.5964660644531,447.425537109375-100,300+22+184],[331.6267395019531,447.425537109375-100,300+184]])
var controls41 = controlsPointTransformation([[280.2514953613281,484.6283264160156-100,300+220],[292.65240478515625,482.8567810058594-100,300+18.4+220],[313.9111328125,484.6283264160156-100,300+18.4+220],[331.6267395019531,484.6283264160156-100,300+220]])
var controls42 = controlsPointTransformation([[280.2514953613281,514.744873046875-100,300+256],[289.1092834472656,518.2879638671875-100,300+14.8+256],[301.5102233886719,518.2879638671875-100,300+14.8+256],[312.13958740234375,520.0595703125-100,300+256]])
var controls43 = controlsPointTransformation([[264.30743408203125,555.4907836914062-100,300+292],[276.7083740234375,555.4907836914062-100,300+11.2+292],[290.880859375,555.4907836914062-100,300+11.2+292],[299.7386474609375,555.4907836914062-100,300+292]])
var controls44 = controlsPointTransformation([[260.7643127441406,585.6072998046875-100,300+328],[269.6221008300781,583.8357543945312-100,300+7.6+328],[276.7083740234375,583.8357543945312-100,300+7.6+328],[289.1092834472656,585.6072998046875-100,300+328]])
var controls45 = controlsPointTransformation([[260.7643127441406,622.81005859375-100,300+364],[266.0789794921875,621.0385131835938-100,300+4+364],[273.1652526855469,621.0385131835938-100,300+4+364],[282.0230407714844,621.0385131835938-100,300+364]])

var finalPoint3 = [+300+400, 283.79461669921875,-675.9569091796875-100];
var curveNeuron2Upper = createCurveSurface2(finalPoint3, [controls35, controls36, controls37, controls38, controls39, controls40, controls41, controls42, controls43, controls44, controls45]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron2Upper)(domain2)));

var controls35 = controlsPointTransformation([[250.13494873046875,296.8428649902344-100,300],[274.1138610839844,296.71685791015625-100,300-40],[293.1138610839844,296.71685791015625-100,300-40],[313.9111328125,295.0713195800781-100,300]]);
var controls36 = controlsPointTransformation([[232.22833251953125,317.4589538574219-100,300+40],[253.6783447265625,318.5879211425781-100,300-36.4+40],[276.7083740234375,319.8731689453125-100,300-36.4+40],[308.43231201171875,320.2813415527344-100,300+40]]);
var controls37 = controlsPointTransformation([[226.0191192626953,353.02081298828125-100,300+76],[248.36338806152344,351.7612609863281-100,300-32.8+76],[287.3377380371094,349.98968505859375-100,300-32.8+76],[305.0533447265625,349.98968505859375-100,300+76]]);
var controls38 = controlsPointTransformation([[244.8202667236328,385.4209289550781-100,300+112],[264.30743408203125,385.4209289550781-100,300-29.2+112],[296.1955261230469,385.4209289550781-100,300-29.2+112],[315.6827087402344,383.64935302734375-100,300+112]]);
var controls39 = controlsPointTransformation([[264.30743408203125,419.08056640625-100,300+148],[280.2514953613281,419.08056640625-100,300-25.6+148],[305.0533447265625,417.30902099609375-100,300-25.6+148],[320.99737548828125,417.30902099609375-100,300+148]]);
var controls40 = controlsPointTransformation([[271.3936767578125,449.1971130371094-100,300+184],[283.79461669921875,447.425537109375-100,300-22+184],[308.5964660644531,447.425537109375-100,300-22+184],[331.6267395019531,447.425537109375-100,300+184]])
var controls41 = controlsPointTransformation([[280.2514953613281,484.6283264160156-100,300+220],[292.65240478515625,482.8567810058594-100,300-18.4+220],[313.9111328125,484.6283264160156-100,300-18.4+220],[331.6267395019531,484.6283264160156-100,300+220]])
var controls42 = controlsPointTransformation([[280.2514953613281,514.744873046875-100,300+256],[289.1092834472656,518.2879638671875-100,300-14.8+256],[301.5102233886719,518.2879638671875-100,300-14.8+256],[312.13958740234375,520.0595703125-100,300+256]])
var controls43 = controlsPointTransformation([[264.30743408203125,555.4907836914062-100,300+292],[276.7083740234375,555.4907836914062-100,300-11.2+292],[290.880859375,555.4907836914062-100,300-11.2+292],[299.7386474609375,555.4907836914062-100,300+292]])
var controls44 = controlsPointTransformation([[260.7643127441406,585.6072998046875-100,300+328],[269.6221008300781,583.8357543945312-100,300-7.6+328],[276.7083740234375,583.8357543945312-100,300-7.6+328],[289.1092834472656,585.6072998046875-100,300+328]])
var controls45 = controlsPointTransformation([[260.7643127441406,622.81005859375-100,300+364],[266.0789794921875,621.0385131835938-100,300-4+364],[273.1652526855469,621.0385131835938-100,300-4+364],[282.0230407714844,621.0385131835938-100,300+364]])

var curveNeuron2Under = createCurveSurface2(finalPoint3, [controls35, controls36, controls37, controls38, controls39, controls40, controls41, controls42, controls43, controls44, controls45]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron2Under)(domain2)));

//--------------------------------------------------------------------------------------BRANCH----------------------------------------------------------------------------------------------------

var controls46 = controlsPointTransformation([[264.3957214355469+20, 419.36602783203125+20, 500+75],[266.09210205078125+20, 421.9106140136719+20, 509+75],[266.9403076171875+20, 425.3033752441406+20, 509+75],[267.7884826660156+20, 428.2720642089844+20, 500+75]])
var controls47 = controlsPointTransformation([[208.1690673828125, 426.87451171875, 500],[209.28956604003906, 427.9949951171875, 507],[210.28956604003906, 428.9949951171875, 507],[211.13775634765625, 427.4190979003906, 500]])
var controls48 = controlsPointTransformation([[180.0002899169922, 466.0167541503906, 400],[180.84848022460938, 466.0167541503906, 405],[181.2725830078125, 466.44085693359375, 405],[182.5448760986328, 466.8649597167969, 400]])
var finalPoint4 = [500,137.59051513671875,-467.4360656738281]    
var curveNeuron2Under2 = createCurveSurface2(finalPoint4, [controls46, controls47, controls48]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron2Under2)(domain2)));

var controls46 = controlsPointTransformation([[264.3957214355469+20, 419.36602783203125+20, 500+75],[266.09210205078125+20, 421.9106140136719+20, 491+75],[266.9403076171875+20, 425.3033752441406+20, 491+75],[267.7884826660156+20, 428.2720642089844+20, 500+75]])
var controls47 = controlsPointTransformation([[208.1690673828125, 426.87451171875, 500],[209.28956604003906, 427.9949951171875, 489],[210.28956604003906, 428.9949951171875, 489],[211.13775634765625, 427.4190979003906, 500]])
var controls48 = controlsPointTransformation([[180.0002899169922, 466.0167541503906, 400],[180.84848022460938, 466.0167541503906, 387],[181.2725830078125, 466.44085693359375, 387],[182.5448760986328, 466.8649597167969, 400]])
var curveNeuron2Under2 = createCurveSurface2(finalPoint4, [controls46, controls47, controls48]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron2Under2)(domain2)));


//----------------------------------------------------------------------------NEURON DENDRITE 3------------------------------------------------------------------------------------------

var controls50 = controlsPointTranslation([[131.18983459472656 , 537.3367309570312, 0],[139.45428466796875 +5, 544.0985717773438, -10],[152.9779510498047 +5, 552.363037109375, -10],[160.49110412597656, 554.616943359375, 0]], -30,0,-30);
var controls51 = controlsPointTranslation([[118.72698974609375, 543.1304321289062, 0],[126.64077758789062, 548.16650390625, -9],[134.3747100830078, 553.9219970703125, -9],[148.04397583007812, 560.217041015625, 0]], -30,0,-30);
var controls52 = controlsPointTranslation([[105.95701599121094, 551.5838012695312, 0],[113.1513671875, 553.9219970703125, -8],[119.44642639160156, 556.619873046875, -8],[126.82063293457031, 560.5767822265625, 0]], -30,0,-30);
var controls53 = controlsPointTranslation([[98.40294647216797, 565.4329223632812, 0],[101.28068542480469, 565.7926635742188, -7],[105.95701599121094, 567.0516967773438, -7],[108.47503662109375, 568.4905395507812, 0]], -30,0,-30);
var controls54 = controlsPointTranslation([[94.80577087402344, 577.3036499023438, 0],[97.32379150390625, 577.4834594726562, -6],[101.10082244873047, 578.5626220703125, -6],[104.1584243774414, 579.1022338867188, 0]], -30,0,-30);
var controls55 = controlsPointTranslation([[92.47355651855469, 592.7893676757812, 0],[94.80577087402344, 593.31103515625, -5],[96.66260528564453, 594.0055541992188, -5],[98.28417205810547, 594.5460815429688, 0]], -30,0,-30);
var controls56 = controlsPointTranslation([[89.90607452392578, 612.38330078125, 0],[92.20329284667969, 613.0589599609375, -4],[94.23025512695312, 613.5994873046875, -4],[96.12207794189453, 614.275146484375, 0 ]], -30,0,-30);
var controls57 = controlsPointTranslation([[85.99269104003906, 628.2036743164062, 0],[87.47372436523438, 628.5989990234375, -3],[88.96015930175781, 629.274658203125, -3],[90.31146240234375, 630.2205200195312, -30 ]], -30,0,-30);
var controls58 = controlsPointTranslation([[76.99974822998047, 640.9736328125, 0],[78.61847686767578, 642.5923461914062, -2],[79.8185043334961, 643.6663818359375, -2],[81.67607879638672, 644.9305419921875, 0]], -30,0,-30);
var controls59 = controlsPointTranslation([[61.531890869140625, 652.3047485351562, 0],[62.43050003051758, 653.4205932617188, -1],[63.6901969909668, 654.82275390625, -1],[64.40962982177734, 655.9019165039062, 0]], -30,0,-30);
var controls60 = controlsPointTranslation([[44.6183967590332, 657.6615600585938, 0],[44.805023193359375, 659.139404296875, 0],[45.16474151611328, 660.5782470703125, 0],[45.52445602416992, 662.1969604492188, 0]], -30,0,-30);
var finalPoint5 = [27.718435287475586-45, 659.3192138671875, -30 ]

var curveNeuron3Upper = createCurveSurface2(finalPoint5, [controls50 ,controls51, controls52, controls53, controls54, controls55, controls56, controls57, controls58,controls59,controls60]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron3Upper)(domain2)));

var controls50 = controlsPointTranslation([[131.18983459472656, 537.3367309570312, 0 ],[139.45428466796875 +5, 544.0985717773438, 10],[152.9779510498047 +5, 552.363037109375, 10],[160.49110412597656, 554.616943359375, 0]], -30,0,-30);
var controls51 = controlsPointTranslation([[118.72698974609375, 543.1304321289062, 0],[126.64077758789062, 548.16650390625, 9],[134.3747100830078, 553.9219970703125, 9],[148.04397583007812, 560.217041015625, 0]], -30,0,-30);
var controls52 = controlsPointTranslation([[105.95701599121094, 551.5838012695312, 0],[113.1513671875, 553.9219970703125, 8],[119.44642639160156, 556.619873046875, 8],[126.82063293457031, 560.5767822265625, 0]], -30,0,-30);
var controls53 = controlsPointTranslation([[98.40294647216797, 565.4329223632812, 0],[101.28068542480469, 565.7926635742188, 7],[105.95701599121094, 567.0516967773438, 7],[108.47503662109375, 568.4905395507812, 0]], -30,0,-30);
var controls54 = controlsPointTranslation([[94.80577087402344, 577.3036499023438, 0],[97.32379150390625, 577.4834594726562, 6],[101.10082244873047, 578.5626220703125, 6],[104.1584243774414, 579.1022338867188, 0]], -30,0,-30);
var controls55 = controlsPointTranslation([[92.47355651855469, 592.7893676757812, 0],[94.80577087402344, 593.31103515625, 5],[96.66260528564453, 594.0055541992188, 5],[98.28417205810547, 594.5460815429688, 0]], -30,0,-30);
var controls56 = controlsPointTranslation([[89.90607452392578, 612.38330078125, 0],[92.20329284667969, 613.0589599609375, 4],[94.23025512695312, 613.5994873046875, 4],[96.12207794189453, 614.275146484375, 0 ]], -30,0,-30);
var controls57 = controlsPointTranslation([[85.99269104003906, 628.2036743164062, 0],[87.47372436523438, 628.5989990234375, 3],[88.96015930175781, 629.274658203125, 3],[90.31146240234375, 630.2205200195312, -30 ]], -30,0,-30);
var controls58 = controlsPointTranslation([[76.99974822998047, 640.9736328125, 0],[78.61847686767578, 642.5923461914062, 2],[79.8185043334961, 643.6663818359375, 2],[81.67607879638672, 644.9305419921875, 0]], -30,0,-30);
var controls59 = controlsPointTranslation([[61.531890869140625, 652.3047485351562, 0],[62.43050003051758, 653.4205932617188, 1],[63.6901969909668, 654.82275390625, 1],[64.40962982177734, 655.9019165039062, 0]], -30,0,-30);
var controls60 = controlsPointTranslation([[44.6183967590332, 657.6615600585938, 0],[44.805023193359375, 659.139404296875, 0],[45.16474151611328, 660.5782470703125, 0],[45.52445602416992, 662.1969604492188, 0]], -30,0,-30);
var curveNeuron3Upper = createCurveSurface2(finalPoint5, [controls50,controls51, controls52, controls53, controls54, controls55, controls56, controls57, controls58,controls59,controls60]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron3Upper)(domain2)));

//--------------------------------------------------------------------------------NEURON DENDRITE 4 -------------------------------------------------------------------------------------------

var controls01 = controlsPointTranslation([[341, 50, 0],[348, 53, -8],[355, 56, -8],[360, 58, 0]],-60,0,-100)
var controls02 = controlsPointTranslation([[368, -61, 0],[376, -61, -3],[380, -59, -3],[385, -57, 0]], -60,0,-100);
var controls03 = controlsPointTranslation([[310, -169, 0],[315, -171, 0],[319, -173, 0],[324, -174, 0]], -60,0,-100);
var finalPoint4 = [393, -246, -100];

var curveNeuron4Under = createCurveSurface2(finalPoint4, [controls01, controls02, controls03]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron4Under)(domain2)));

var controls01 = controlsPointTranslation([[341, 50, 0],[348, 53, 8],[355, 56, 8],[360, 58, 0]],-60,0,-100)
var controls02 = controlsPointTranslation([[368, -61, 0],[376, -61, 3],[380, -59, 3],[385, -57, 0]], -60,0,-100);
var controls03 = controlsPointTranslation([[310, -169, 0],[315, -171, 0],[319, -173, 0],[324, -174, 0]], -60,0,-100);

var curveNeuron4Upper = createCurveSurface2(finalPoint4, [controls01, controls02, controls03]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron4Upper)(domain2)));


//--------------------------------------------------------------------------------NEURON DENDRITE 5 -------------------------------------------------------------------------------------------

var controls01 = controlsPointTranslation([[133.7630157470703, 97.48199462890625, 0],[137.75601196289062, 90.82699584960938, -10],[143.08001708984375, 85.50299072265625, -10],[145.74200439453125, 82.84099578857422, 0]],-50,75,-100)
var controls02 = controlsPointTranslation([[-27.287982940673828, -10.329005241394043, 0],[-25.95698356628418, -16.984004974365234, -54],[-21.9639835357666, -23.639005661010742, 0-4],[-16.639984130859375, -32.95600509643555, 0]], -50,75,-100);
var controls03 = controlsPointTranslation([[-52.57698440551758, -163.3939971923828, 0],[-47.25298309326172, -168.71800231933594, 0],[-44.59098434448242, -170.0489959716797, 0],[-39.26698303222656, -172.71099853515625, 0]], -50,65,-100);
var finalPoint4 = [-36.604984283447266-50, -292.5010070800781+75, 0];

var curveNeuron4Under = createCurveSurface2(finalPoint4, [controls01, controls02, controls03]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron4Under)(domain2)));

var controls01 = controlsPointTranslation([[133.7630157470703, 97.48199462890625, 0],[137.75601196289062, 90.82699584960938, 10],[143.08001708984375, 85.50299072265625, 10],[145.74200439453125, 82.84099578857422, 0]],-50,75,-100)
var controls02 = controlsPointTranslation([[-27.287982940673828, -10.329005241394043, 0],[-25.95698356628418, -16.984004974365234, 4],[-21.9639835357666, -23.639005661010742, 4],[-16.639984130859375, -32.95600509643555, 0]], -50,75,-100);
var controls03 = controlsPointTranslation([[-52.57698440551758, -163.3939971923828, 0],[-47.25298309326172, -168.71800231933594, 0],[-44.59098434448242, -170.0489959716797, 0],[-39.26698303222656, -172.71099853515625, 0]], -50,75,-100);

var curveNeuron4Upper = createCurveSurface2(finalPoint4, [controls01, controls02, controls03]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron4Upper)(domain2)));

//------------------------------------------------------------------------------SECOND BRANCH--------------------------------------------------------------------------------

var con28 = [[-721.7300415039062,226.4208526611328-3,0],[-720.1238403320312,226.85365295410156-3,0],[-718.430419921875,227.98260498046875-4.3,0],[-717.8659057617188,228.54708862304688-4.3,0]]
var con29 = controlsPointTranslation([[-733.5193481445312,238.210205078125,0],[-731.4132690429688,238.70761108398438,0],[-729.69580078125,239.80335998535156,0],[-728.7399291992188,241.077880859375,0]],0,+7,0);
var con30 = controlsPointTranslation([[-771.7550659179688,246.49459838867188,0],[-772.055419921875,247.73919677734375,0],[-771.490966796875,249.4326171875,0],[-772.055419921875,251.12603759765625,0]],0,+7,0);
var con31 = controlsPointTranslation([[-833.2508544921875,242.35240173339844,0],[-833.5830688476562,243.22340393066406,0],[-834.5253295898438,244.26419067382812,0],[-835.16259765625,245.22007751464844,0]],0,+7,0);
var finalpoint12 = [-881.5633544921875,251.12603759765625+7,0];
var curveDendrite12 = createCurveSurface2(finalpoint12, [con28, con29, con30, con31]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite12)(domain2)));


var con32 = controlsPointTranslation([[-873.7169189453125,249.99954223632812,0],[-872.4424438476562,249.99954223632812,0],[-872.4424438476562,249.99954223632812,0],[-871.4865112304688,249.99954223632812,0]],+15,+5,0);
var finalPoint13 = [-880.0895385742188+15,237.57293701171875+5,0];
var curveDendrite13 = createCurveSurface2(finalPoint13, [con32]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite13)(domain2)));

var con33 = [[-873.7169189453125+9,249.99954223632812+6,0],[-872.4424438476562+9,249.99954223632812+6,0],[-872.4424438476562+9,249.99954223632812+6,0],[-871.4865112304688+9,249.99954223632812+6,0]]
var finalPoint14 = [-875.3101196289062+9,260.19573974609375+6.5,0];
var curveDendrite14 = createCurveSurface2(finalPoint14, [con33]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite14)(domain2)));

var con34 = [[-823.373291015625,242.35240173339844+12,0],[-822.0987548828125,242.35240173339844+12,0],[-820.505615234375,242.35240173339844+12,0],[-819.5496826171875,242.35240173339844+12,0]]
var finalPoint15 = [-827.8341064453125,197.42544555664062+12,0];
var curveDendrite15 = createCurveSurface2(finalPoint15, [con34]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite15)(domain2)));

var con35 = [[-824.3291625976562-2.5,216.22467041015625,0],[-824.6478271484375-2.5,214.31288146972656,0],[-824.6478271484375-2.5,214.31288146972656,0],[-824.6478271484375-2.5,213.03836059570312,0]]
var finalPoint16 = [-843.12841796875-2.5,205.0725860595703,0]
var curveDendrite16 = createCurveSurface2(finalPoint16, [con35]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite16)(domain2)));

var con36 = [[-824.3291625976562-1,216.22467041015625+12,0],[-824.6478271484375-1,214.31288146972656+12,0],[-824.6478271484375-1,214.31288146972656+12,0],[-824.6478271484375-1,213.03836059570312+12,0]]
var finalPoint17 = [-810.3093872070312,199.9744873046875+12,0];
var curveDendrite17 = createCurveSurface2(finalPoint17, [con36]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite17)(domain2)));

var con37 = [[-831.8896484375+9,240.96551513671875+1,0],[-831.8896484375+6,241.5299835205078,0],[-831.3251953125+7,240.96551513671875,0],[-830.1962280273438+7,239.27207946777344,0]]
var finalPoint18 = [-874.7896728515625+6,198.6299591064453,0]
var curveDendrite18 = createCurveSurface2(finalPoint18, [con37]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite18)(domain2)));

var con38 = [[-866.7070922851562+6,205.39122009277344+1,0],[-866.388427734375+6,205.39122009277344+1,0],[-866.06982421875+6,206.34710693359375+1,0],[-865.1138916015625+6,206.66574096679688+1,0]]
var finalPoint19 = [-862.2462158203125+6,192.96461486816406+0.5,0];
var curveDendrite19 = createCurveSurface2(finalPoint19, [con38]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite19)(domain2)));

var con39 = [[-866.7070922851562+5,205.39122009277344,0],[-866.388427734375+5,205.39122009277344,0],[-866.06982421875+5,206.34710693359375,0],[-865.1138916015625+5,206.66574096679688,0]]
var finalPoint20 = [-882.9572143554688+5,212.40109252929688,0];
var curveDendrite20 = createCurveSurface2(finalPoint20, [con39]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite20)(domain2)));

//--------------------------------------------------------------------------------SYNAPSIS-------------------------------------------------------------------------------------------

//Synapsy 1
var cp1 =[-752.65576171875, 213.56027221679688, 0]
var cp2 =[[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]]
var cp3 =[[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]]
var cp4 =[[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]]
var cp5 =[-749.0326538085938, 213.43087768554688, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));

//Synapsy 2
var cp1 =[-752.65576171875+4, 213.56027221679688+4, 0]
var cp2 =controlsPointTranslation([[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]],4,4,0)
var cp3 =controlsPointTranslation([[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]],4,4,0)
var cp4 =controlsPointTranslation([[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]],4,4,0)
var cp5 =[-749.0326538085938+4, 213.43087768554688+4, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));

//Synapsy 3
var cp1 =[-752.65576171875-8, 213.56027221679688+8, 0]
var cp2 =controlsPointTranslation([[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]],-8,8,0)
var cp3 =controlsPointTranslation([[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]],-8,8,0)
var cp4 =controlsPointTranslation([[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]],-8,8,0)
var cp5 =[-749.03265380859388-8, 213.430877685546888+8, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));

//Synapsy 4
var cp1 =[-752.65576171875-18, 213.56027221679688+10, 0]
var cp2 =controlsPointTranslation([[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]],-18,10,0)
var cp3 =controlsPointTranslation([[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]],-18,10,0)
var cp4 =controlsPointTranslation([[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]],-18,10,0)
var cp5 =[-749.03265380859388-18, 213.430877685546888+10, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));

//Synapsy 5
var cp1 =[-752.65576171875-14, 213.56027221679688+4, 0]
var cp2 =controlsPointTranslation([[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]],-14,4,0)
var cp3 =controlsPointTranslation([[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]],-14,4,0)
var cp4 =controlsPointTranslation([[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]],-14,4,0)
var cp5 =[-749.03265380859388-14, 213.430877685546888+4, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));

//Synapsy 6
var cp1 =[-752.65576171875-22, 213.56027221679688+6, 0]
var cp2 =controlsPointTranslation([[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]],-22,6,0)
var cp3 =controlsPointTranslation([[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]],-22,6,0)
var cp4 =controlsPointTranslation([[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]],-22,6,0)
var cp5 =[-749.03265380859388-22, 213.430877685546888+6, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));

//Synapsy 7
var cp1 =[-752.65576171875-14, 213.56027221679688+18, 0]
var cp2 =controlsPointTranslation([[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]],-14,18,0)
var cp3 =controlsPointTranslation([[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]],-14,18,0)
var cp4 =controlsPointTranslation([[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]],-14,18,0)
var cp5 =[-749.03265380859388-14, 213.430877685546888+18, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));

//-------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 2,4,6,8--------------------------------------------------------------------------------------

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 2 DX-----------------------------------------------------------------------


var controlsUpper = [[229.2107391357422,201.80055236816406,0],[229.45013427734375,202.9975128173828,0],[226.33802795410156,204.9126434326172,0],[222.98654174804688,207.06716918945312,0],[223.22593688964844,209.22169494628906,0],[225.1410675048828,211.61561584472656,0],[229.2107391357422,213.29136657714844,0],[232.3228302001953,213.29136657714844,0],[235.19554138183594,211.37623596191406,0],[240.4738311767578,206.58839416503906,0],[244.74537658691406,201.8591766357422,0],[248.71182250976562,197.74017333984375,0],[257.17864990234375,192.40074157714844,0],[259.7720947265625,190.49378967285156,0],[261.5264892578125,189.04452514648438,0],[262.8232116699219,186.83245849609375,0],[263.50970458984375,184.16275024414062,0],[263.7385559082031,181.11163330078125,0]]
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);

var controlsUnder = [[259.4281311035156,266.5321960449219,-70],[258.3470764160156,268.28887939453125,-70],[256.8606262207031,270.18072509765625,-70],[254.96881103515625,272.6130676269531,-70],[253.8877716064453,274.5049133300781,-70],[254.83367919921875,276.5318603515625,-70],[256.7254943847656,278.018310546875,-70],[256.8606262207031,278.018310546875,-70],[259.0227355957031,278.4236755371094,-70],[259.2929992675781,278.4236755371094,-70],[263.07666015625,278.1534118652344,-70],[269.42779541015625,275.1805419921875,-70],[274.022216796875,272.0725402832031,-70],[276.5896911621094,270.18072509765625,-70],[279.4274597167969,268.42401123046875,-70],[281.04901123046875,267.2078552246094,-70],[283.07598876953125,265.4511413574219,-70],[286.1584167480469,262.3100280761719,-70],[289.0361633300781,257.27398681640625,-70],[288.31671142578125,254.57611083984375,-70]];
var nubsUnder = createNubs(controlsUnder);
var Dx2 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);

var pointsLateral1 = [[229.2107391357422,201.80055236816406,0],[239,222,-60], [249,243,-68],[259.4281311035156,266.5321960449219,-70]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

var pointsLateral2 = [[263.7385559082031,181.11163330078125,0],[271,205,-60],[279,229,-68],[288.31671142578125,254.57611083984375,-70]];
var bLateral2 = BEZIER(S1)(pointsLateral2);
var bL1Dx = bLateral1;
var bL2Dx = bLateral2;

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));


//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 2 SX-----------------------------------------------------------------------

var controlsUpper = [[263.7385559082031,181.11163330078125,0],[262.13671875,178.44192504882812,0],[258.6279296875,175.4670867919922,0],[256.9498291015625,174.62803649902344,0],[254.8903350830078,174.62803649902344,0],[253.2884979248047,175.6959228515625,0],[250.38995361328125,177.45030212402344,0],[245.58445739746094,179.58609008789062,0],[238.6431884765625,182.3320770263672,0],[232.46469116210938,185.00180053710938,0],[225.14202880859375,187.90036010742188,0], [225.1410675048828,187.91580200195312,0],[220.3532257080078,188.6339874267578,0],[214.8472137451172,189.11276245117188,0],[208.1442413330078,189.83094787597656,0],[201.44125366210938,190.5491180419922,0],[196.1746368408203,193.4218292236328,0],[194.02011108398438,195.57635498046875,0],[193.06253051757812,198.92784118652344,0],[195.45645141601562,202.75811767578125,0],[198.80795288085938,205.15203857421875,0],[203.59579467773438,205.6308135986328,0],[206.94728088378906,205.6308135986328,0],[212.21389770507812,205.6308135986328,0],[215.80477905273438,204.9126434326172,0],[219.39566040039062,203.955078125,0],[223.46533203125,202.5187225341797,0],[227.05621337890625,201.80055236816406,0],[229.2107391357422,201.80055236816406,0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);

var controlsUnder = reverseR([[259.4281311035156,266.5321960449219,-80],[257.2896728515625,267.1700134277344,-80],[254.72218322753906,268.52130126953125,-80],[252.56008911132812,269.73748779296875,-80],[249.85748291015625,271.2239074707031,-80],[247.4251251220703,271.7644348144531,-80],[244.45225524902344,272.4400939941406,-80],[242.9658203125,270.54827880859375,-80],[242.155029296875,267.84564208984375,-80],[242.155029296875,264.3322448730469,-80],[242.695556640625,262.170166015625,-80],[243.3712158203125,260.8188781738281,-80],[244.72251892089844,259.4675598144531,-80],[246.47921752929688,257.9811096191406,-80],[248.91156005859375,256.08929443359375,-80],[250.85350036621094,255.5808868408203,-80],[253.48680114746094,255.82028198242188,-80],[256.1201171875,256.0596618652344,-80],[258.274658203125,255.34149169921875,-80],[260.4291687011719,254.38392639160156,-80],[261.86553955078125,254.38392639160156,-80],[262.8230895996094,254.14453125,-80],[267.13214111328125,253.42636108398438,-80],[270.9624328613281,251.51121520996094,-80],[275.0321044921875,250.3142547607422,-80],[278.1441955566406,250.0748748779297,-80],[281.7350769042969,248.87791442871094,-80],[286.04412841796875,251.03244018554688,-80],[288.31671142578125,254.57611083984375,-80]])
var nubsUnder = createNubs(controlsUnder);
var Sx2 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);

var pointsLateral1 = [[263.7385559082031,181.11163330078125,0],[239,222,-68.6], [249,243,-77.7],[259.4281311035156,266.5321960449219,-80]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

var pointsLateral2 = [[229.2107391357422,201.80055236816406,0],[271,205,-68.6],[279,229,-77.7],[288.31671142578125,254.57611083984375,-80]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

var bL1Sx = bLateral1;
var bL2Sx = bLateral2;

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));

var controlsContourEx2 = [[229.2107391357422,201.80055236816406,0],[229.45013427734375,202.9975128173828,0],[226.33802795410156,204.9126434326172,0],[222.98654174804688,207.06716918945312,0],[223.22593688964844,209.22169494628906,0],[225.1410675048828,211.61561584472656,0],[229.2107391357422,213.29136657714844,0],[232.3228302001953,213.29136657714844,0],[235.19554138183594,211.37623596191406,0],[240.4738311767578,206.58839416503906,0],[244.74537658691406,201.8591766357422,0],[248.71182250976562,197.74017333984375,0],[257.17864990234375,192.40074157714844,0],[259.7720947265625,190.49378967285156,0],[261.5264892578125,189.04452514648438,0],[262.8232116699219,186.83245849609375,0],[263.50970458984375,184.16275024414062,0],[263.7385559082031,181.11163330078125,0],[262.13671875,178.44192504882812,0],[258.6279296875,175.4670867919922,0],[256.9498291015625,174.62803649902344,0],[254.8903350830078,174.62803649902344,0],[253.2884979248047,175.6959228515625,0],[250.38995361328125,177.45030212402344,0],[245.58445739746094,179.58609008789062,0],[238.6431884765625,182.3320770263672,0],[232.46469116210938,185.00180053710938,0],[225.14202880859375,187.90036010742188,0], [225.1410675048828,187.91580200195312,0],[220.3532257080078,188.6339874267578,0],[214.8472137451172,189.11276245117188,0],[208.1442413330078,189.83094787597656,0],[201.44125366210938,190.5491180419922,0],[196.1746368408203,193.4218292236328,0],[194.02011108398438,195.57635498046875,0],[193.06253051757812,198.92784118652344,0],[195.45645141601562,202.75811767578125,0],[198.80795288085938,205.15203857421875,0],[203.59579467773438,205.6308135986328,0],[206.94728088378906,205.6308135986328,0],[212.21389770507812,205.6308135986328,0],[215.80477905273438,204.9126434326172,0],[219.39566040039062,203.955078125,0],[223.46533203125,202.5187225341797,0],[227.05621337890625,201.80055236816406,0],[229.2107391357422,201.80055236816406,0]];
var nubsContourEx2 = createNubs(controlsContourEx2);
var controlsRerInPart2 = reverseR([[232.180908203125,199.8025360107422,0],[229.06881713867188,199.32374572753906,0],[222.12644958496094,201.2388916015625,0],[213.98712158203125,202.9146270751953,0],[204.1720428466797,202.9146270751953,0],[197.94784545898438,202.1964569091797,0],[196.51148986816406,200.76010131835938,0],[196.27210998535156,197.8874053955078,0],[198.66603088378906,194.53590393066406,0],[202.73568725585938,192.86016845703125,0],[208.24169921875,192.6207733154297,0],[216.38104248046875,192.6207733154297,0],[224.9991455078125,191.42381286621094,0],[231.70213317871094,189.74806213378906,0],[238.4051055908203,187.35414123535156,0],[241.51719665527344,185.19961547851562,0],[246.30503845214844,182.56629943847656,0],[248.9383544921875,180.6511688232422,0],[252.52923583984375,178.9754180908203,0],[255.64134216308594,177.53907775878906,0],[257.55645751953125,178.01785278320312,0],[258.274658203125,179.693603515625,0],[260.1897888183594,181.60873413085938,0],[260.1897888183594,183.0450897216797,0],[259.2322082519531,185.67840576171875,0],[257.55645751953125,187.35414123535156,0],[255.64134216308594,188.79049682617188,0],[252.2898406982422,190.46624755859375,0],[250.85350036621094,191.90260314941406,0],[247.9807891845703,194.05712890625,0],[246.30503845214844,195.97225952148438,0],[244.38990783691406,197.8874053955078,0],[241.99598693847656,200.5207061767578,0],[240.3202362060547,202.43585205078125,0],[238.16571044921875,204.5903778076172,0],[236.96875,206.26611328125,0],[235.05361938476562,208.18125915527344,0],[231.46273803710938,210.57518005371094,0],[228.35064697265625,210.8145751953125,0],[226.91429138183594,208.89942932128906,0],[228.1112518310547,206.9842987060547,0],[231.2233428955078,205.3085479736328,0],[232.42030334472656,203.15402221679688,0],[232.65969848632812,201.95706176757812,0],[232.6884765625,201.0287628173828,0],[232.1717987060547,199.86622619628906,0]])
var nubsRerInPart2 = createNubs(controlsRerInPart2);
var boundaryPart2 = createBezierS1([nubsContourEx2, nubsRerInPart2]);
var boundaryPart2Map = MAP(boundaryPart2)(domain2);
DRAW(COLOR(mattLightYellow)(boundaryPart2Map));
var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 4 DX-----------------------------------------------------------------------


var controlsUpper = [[342.0715637207031,231.03759765625,0],[342.0738525390625,231.11387634277344,0],[343.2900390625,228.6815185546875,0],[343.1549072265625,225.97891235351562,0],[342.208984375,223.9519500732422,0],[340.7225646972656,221.78985595703125,0],[339.2361145019531,218.95211791992188,0],[337.61456298828125,216.1143798828125,0],[336.66864013671875,214.49281311035156,0],[336.12811279296875,212.33071899414062,0],[335.72271728515625,209.89837646484375,0],[335.72271728515625,208.0065460205078,0],[337.20916748046875,206.7903594970703,0],[339.5063781738281,206.11471557617188,0],[342.0738525390625,207.1957550048828,0],[344.6413269042969,208.68218994140625,0],[347.0736999511719,210.3037567138672,0],[348.96551513671875,213.14151000976562,0],[351.9383850097656,215.979248046875,0],[355.1815185546875,219.49264526367188,0],[357.8841247558594,222.60064697265625,0],[362.61370849609375,226.92481994628906,0],[370.1810302734375,233.4110870361328,0],[375.72137451171875,239.22171020507812,0],[377.3429260253906,241.5189208984375,0],[378.2888488769531,244.35667419433594,0],[378.0185852050781,246.3836212158203,0],[377.07269287109375,248.54571533203125,0],[374.77545166015625,249.6267547607422,0],[372.0728454589844,250.4375457763672,0],[369.50537109375,249.35650634765625,0],[365.9919738769531,247.3295440673828,0],[363.28936767578125,245.57284545898438,0],[360.85699462890625,243.68101501464844,0],[358.2895202636719,241.92431640625,0],[355.7220458984375,240.03248596191406,0],[354.19970703125,238.74163818359375,0]]
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);

var controlsUnder = [[313.7228088378906,264.1996765136719,-60],[313.90264892578125,264.01983642578125,-60],[314.80194091796875,262.5809631347656,-60],[314.6221008300781,260.2427978515625,-60],[314.2623596191406,258.26434326171875,-60],[313.00335693359375,256.8254699707031,-60],[311.7443542480469,255.5664520263672,-60],[310.8450622558594,253.94772338867188,-60],[310.6651916503906,252.32899475097656,-60],[310.8450622558594,251.0699920654297,-60],[312.10406494140625,250.1707000732422,-60],[315.3415222167969,250.89013671875,-60],[317.85955810546875,253.04843139648438,-60],[320.55743408203125,255.3865966796875,-60],[323.7948913574219,258.6240539550781,-60],[326.4927673339844,261.5018005371094,-60],[326.4927673339844,261.86151123046875,-60],[328.4712219238281,263.8399658203125,-60],[330.4496765136719,266.537841796875,-60],[332.0683898925781,268.6961364746094,-60],[332.0683898925781,268.8760070800781,-60],[334.58642578125,270.6745910644531,-60],[334.7662658691406,270.8544616699219,-60],[335.30584716796875,271.9336242675781,-60],[336.385009765625,273.192626953125,-60],[338.36346435546875,274.81134033203125,-60],[339.4425964355469,276.60992431640625,-60],[341.2411804199219,279.4876708984375,-60],[341.78076171875,281.64599609375,-60],[342.3203430175781,283.444580078125,-60],[342.3203430175781,283.6244201660156,-60],[342.1404724121094,283.6244201660156,-60],[341.96063232421875,285.7827453613281,-60],[339.6224670410156,286.5021667480469,-60],[337.8238830566406,285.7827453613281,-60],[336.7447204589844,284.5237121582031,-60],[335.8454284667969,283.26470947265625,-60],[334.2266845703125,281.2862548828125,-60],[332.60797119140625,278.4085388183594,-60],[330.80938720703125,276.4300842285156,-60],[330.4496765136719,276.2502136230469,-60],[329.730224609375,275.3509216308594,-60],[329.1906433105469,275.3509216308594,-60],[327.75177001953125,275.3509216308594,-60],[326.3128967285156,276.4300842285156,-60],[325.95318603515625,276.96966552734375,-60]]
var nubsUnder = createNubs(controlsUnder);
var Dx4 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);

var pointsLateral1 = [[342.0715637207031,231.03759765625,0],[333,242,-48],[324,253,-57.8],[313.7228088378906,264.1996765136719,-60]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

var pointsLateral2 = [[354.19970703125,238.74163818359375,0],[354,250,-48],[336,262,-57.8],[325.95318603515625,276.96966552734375,-60]];
var bLateral2 = BEZIER(S1)(pointsLateral2);
var bL1Dx = bLateral1;
var bL2Dx = bLateral2;

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));


//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 4 SX-----------------------------------------------------------------------



var controlsUpper = [[354.19970703125,238.74163818359375,0],[353.0194396972656,240.57301330566406,0],[353.5599670410156,243.14048767089844,0],[355.5869140625,245.84310913085938,0],[357.3436279296875,248.54571533203125,0],[360.7218933105469,251.38345336914062,0],[365.8568420410156,258.0048522949219,0],[369.50537109375,262.73443603515625,0],[372.4782409667969,269.220703125,0],[375.31597900390625,275.43670654296875,0],[376.53216552734375,280.4365234375,0],[376.53216552734375,283.8147888183594,0],[375.99163818359375,285.5715026855469,0],[374.37005615234375,287.19305419921875,0],[373.0187683105469,288.40924072265625,0],[370.58642578125,288.40924072265625,0],[368.154052734375,287.46331787109375,0],[365.8568420410156,284.8958435058594,0],[359.6408386230469,273.54486083984375,0],[352.4789123535156,260.43719482421875,0],[346.9385681152344,252.73477172851562,0],[340.8576965332031,245.30258178710938,0],[334.2362976074219,239.08657836914062,0],[325.8581848144531,233.00570678710938,0],[320.5881042480469,228.816650390625,0],[317.615234375,225.97891235351562,0],[315.99365234375,222.73577880859375,0],[315.5882568359375,219.22238159179688,0],[317.885498046875,216.65489196777344,0],[320.9934997558594,216.3846435546875,0],[325.3176574707031,217.73594665527344,0],[330.45263671875,221.1142120361328,0],[335.04705810546875,225.84378051757812,0],[338.6955871582031,229.357177734375,0],[340.1820373535156,230.97874450683594,0],[342.0715637207031,231.03759765625,0]]
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);

var controlsUnder = reverseR([[315.881103515625,262.4010925292969,-50],[313.7228088378906,262.0413818359375,-50],[310.8450622558594,261.3219299316406,-50],[308.3270263671875,260.4226379394531,-50],[306.34857177734375,259.343505859375,-50],[304.3701477050781,258.08447265625,-50],[302.3916931152344,257.0053405761719,-50],[300.4132385253906,256.6455993652344,-50],[298.974365234375,258.26434326171875,-50],[298.4347839355469,260.96221923828125,-50],[299.5139465332031,263.1205139160156,-50],[299.6938171386719,263.3003845214844,-50],[301.3125305175781,264.01983642578125,-50],[304.3701477050781,265.9982604980469,-50],[304.54998779296875,265.9982604980469,-50],[306.1687316894531,267.2572937011719,-50],[307.0680236816406,268.1565856933594,-50],[307.427734375,268.8760070800781,-50],[308.3270263671875,269.7752990722656,-50],[309.226318359375,270.6745910644531,-50],[310.6651916503906,272.4731750488281,-50],[311.7443542480469,273.192626953125,-50],[312.4637756347656,274.9912109375,-50],[312.4637756347656,275.17108154296875,-50],[314.08251953125,277.3293762207031,-50],[315.5213928222656,279.4876708984375,-50],[315.70123291015625,279.4876708984375,-50],[317.6796875,282.0057067871094,-50],[318.75885009765625,284.3438720703125,-50],[318.75885009765625,284.7035827636719,-50],[320.0178527832031,286.5021667480469,-50],[320.0178527832031,286.6820373535156,-50],[321.0970153808594,287.9410400390625,-50],[321.0970153808594,288.3007507324219,-50],[321.27685546875,289.91949462890625,-50],[321.27685546875,290.0993347167969,-50],[321.45672607421875,290.0993347167969,-50],[321.45672607421875,290.2792053222656,-50],[321.76434326171875,291.863525390625,-50],[322.1654968261719,293.3535461425781,-50],[323.0251159667969,294.4424133300781,-50],[324.4005432128906,294.4424133300781,-50],[325.66131591796875,294.4424133300781,-50],[327.3232727050781,294.0985412597656,-50],[329.8448486328125,293.86932373046875,-50],[331.907958984375,293.582763671875,-50],[333.5126037597656,293.0096740722656,-50],[334.1429748535156,291.7489013671875,-50],[332.2518005371094,287.79461669921875,-50],[329.78753662109375,284.9291687011719,-50],[328.0109558105469,281.433349609375,-50],[326.86480712890625,279.1983337402344,-50],[325.54669189453125,276.61944580078125,-50]]);
var nubsUnder = createNubs(controlsUnder);
var Sx4 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);

var pointsLateral1 = [[354.19970703125,238.74163818359375,0], [341,246,-40],[328,254,-48],[315.881103515625,262.4010925292969,-50]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

var pointsLateral2 = [[342.0715637207031,231.03759765625,0],[337,246,-40],[332,261,-48],[325.54669189453125,276.61944580078125,-50]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));

var bL1Sx = bLateral1;
var bL2Sx = bLateral2;

var controlsContourEx4 = [[342.0715637207031,231.03759765625,0],[342.0738525390625,231.11387634277344,0],[343.2900390625,228.6815185546875,0],[343.1549072265625,225.97891235351562,0],[342.208984375,223.9519500732422,0],[340.7225646972656,221.78985595703125,0],[339.2361145019531,218.95211791992188,0],[337.61456298828125,216.1143798828125,0],[336.66864013671875,214.49281311035156,0],[336.12811279296875,212.33071899414062,0],[335.72271728515625,209.89837646484375,0],[335.72271728515625,208.0065460205078,0],[337.20916748046875,206.7903594970703,0],[339.5063781738281,206.11471557617188,0],[342.0738525390625,207.1957550048828,0],[344.6413269042969,208.68218994140625,0],[347.0736999511719,210.3037567138672,0],[348.96551513671875,213.14151000976562,0],[351.9383850097656,215.979248046875,0],[355.1815185546875,219.49264526367188,0],[357.8841247558594,222.60064697265625,0],[362.61370849609375,226.92481994628906,0],[370.1810302734375,233.4110870361328,0],[375.72137451171875,239.22171020507812,0],[377.3429260253906,241.5189208984375,0],[378.2888488769531,244.35667419433594,0],[378.0185852050781,246.3836212158203,0],[377.07269287109375,248.54571533203125,0],[374.77545166015625,249.6267547607422,0],[372.0728454589844,250.4375457763672,0],[369.50537109375,249.35650634765625,0],[365.9919738769531,247.3295440673828,0],[363.28936767578125,245.57284545898438,0],[360.85699462890625,243.68101501464844,0],[358.2895202636719,241.92431640625,0],[355.7220458984375,240.03248596191406,0],[354.19970703125,238.74163818359375,0],[353.0194396972656,240.57301330566406,0],[353.5599670410156,243.14048767089844,0],[355.5869140625,245.84310913085938,0],[357.3436279296875,248.54571533203125,0],[360.7218933105469,251.38345336914062,0],[365.8568420410156,258.0048522949219,0],[369.50537109375,262.73443603515625,0],[372.4782409667969,269.220703125,0],[375.31597900390625,275.43670654296875,0],[376.53216552734375,280.4365234375,0],[376.53216552734375,283.8147888183594,0],[375.99163818359375,285.5715026855469,0],[374.37005615234375,287.19305419921875,0],[373.0187683105469,288.40924072265625,0],[370.58642578125,288.40924072265625,0],[368.154052734375,287.46331787109375,0],[365.8568420410156,284.8958435058594,0],[359.6408386230469,273.54486083984375,0],[352.4789123535156,260.43719482421875,0],[346.9385681152344,252.73477172851562,0],[340.8576965332031,245.30258178710938,0],[334.2362976074219,239.08657836914062,0],[325.8581848144531,233.00570678710938,0],[320.5881042480469,228.816650390625,0],[317.615234375,225.97891235351562,0],[315.99365234375,222.73577880859375,0],[315.5882568359375,219.22238159179688,0],[317.885498046875,216.65489196777344,0],[320.9934997558594,216.3846435546875,0],[325.3176574707031,217.73594665527344,0],[330.45263671875,221.1142120361328,0],[335.04705810546875,225.84378051757812,0],[338.6955871582031,229.357177734375,0],[340.1820373535156,230.97874450683594,0],[342.0715637207031,231.03759765625,0]]
var nubsContourEx4 = createNubs(controlsContourEx4);
var controlsRerInPart4 = [[344.5744323730469,233.39242553710938,0],[345.3852233886719,232.71676635742188,0],[346.06085205078125,231.36546325683594,0],[346.46624755859375,228.39259338378906,0],[345.2500915527344,224.3386688232422,0],[343.4933776855469,221.2306671142578,0],[341.871826171875,217.58213806152344,0],[339.8448486328125,214.20387268066406,0],[339.8448486328125,212.71743774414062,0],[341.06103515625,211.0958709716797,0],[342.5474853515625,211.2310028076172,0],[344.0339050292969,211.5012664794922,0],[345.92572021484375,213.52822875976562,0],[351.6012268066406,220.28475952148438,0],[358.7631530761719,227.44667053222656,0],[364.9791564941406,233.39242553710938,0],[369.8438415527344,237.9868621826172,0],[372.27618408203125,240.14895629882812,0],[374.03289794921875,241.63539123535156,0],[374.43829345703125,243.39208984375,0],[374.30316162109375,245.28392028808594,0],[374.43829345703125,247.0406036376953,0],[372.81671142578125,247.3108673095703,0],[370.6546325683594,247.4459991455078,0],[368.2222900390625,246.63522338867188,0],[365.3845520019531,244.60826110839844,0],[362.4116516113281,242.4461669921875,0],[359.70904541015625,239.33816528320312,0],[356.4659118652344,236.50042724609375,0],[353.628173828125,234.6085968017578,0],[351.1958312988281,234.8788604736328,0],[350.3850402832031,235.68963623046875,0],[349.3039855957031,237.04095458984375,0],[349.4391174316406,239.47329711914062,0],[350.5201721191406,242.31103515625,0],[351.6012268066406,245.28392028808594,0],[353.4930419921875,248.2567901611328,0],[359.43878173828125,254.20252990722656,0],[363.8981018066406,260.1482849121094,0],[366.73583984375,263.25628662109375,0],[368.4925537109375,266.4994201660156,0],[369.7087097167969,269.4722900390625,0],[371.0600280761719,272.9856872558594,0],[372.0059509277344,275.55316162109375,0],[372.81671142578125,278.3908996582031,0],[372.81671142578125,280.2827453613281,0],[372.0059509277344,282.3096923828125,0],[370.3843688964844,282.5799560546875,0],[369.5735778808594,281.4989013671875,0],[367.2763671875,278.7962951660156,0],[361.33062744140625,270.418212890625,0],[356.8713073730469,263.12115478515625,0],[354.43896484375,258.2564392089844,0],[350.2499084472656,252.58096313476562,0],[346.87164306640625,248.2567901611328,0],[340.5205078125,241.50025939941406,0],[334.03424072265625,235.2842559814453,0],[329.1695556640625,231.63572692871094,0],[325.9264221191406,228.39259338378906,0],[323.8994445800781,226.63589477539062,0],[322.54815673828125,225.0143280029297,0],[321.60223388671875,223.39276123046875,0],[320.65631103515625,220.55502319335938,0],[321.06170654296875,219.74423217773438,0],[323.0886535644531,220.14962768554688,0],[325.5210266113281,221.5009307861328,0],[329.9803161621094,224.7440643310547,0],[334.98016357421875,228.93310546875,0],[339.439453125,232.58163452148438,0],[341.7366943359375,233.66268920898438,0],[344.5744323730469,233.39242553710938,0]]
var nubsRerInPart4 = createNubs(controlsRerInPart4);
var boundaryPart4 = createBezierS1([nubsContourEx4, nubsRerInPart4]);
var boundaryPart4Map = MAP(boundaryPart4)(domain2);
DRAW(COLOR(mattLightYellow)(boundaryPart4Map));
var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 6 DX-----------------------------------------------------------------------


var controlsUpper = [[393.90081787109375,338.36712646484375,0],[395.1975402832031,340.12152099609375,0],[395.1648864746094,342.2424011230469,0],[393.9058837890625,346.0194396972656,0],[393.006591796875,351.4151916503906,0],[390.6684265136719,355.55194091796875,0],[389.4093933105469,358.4296875,0],[387.7906799316406,361.6671447753906,0],[387.43096923828125,364.3650207519531,0],[389.0496826171875,364.7247619628906,0],[391.3878479003906,363.8254699707031,0],[394.0857238769531,361.1275634765625,0],[396.603759765625,355.3721008300781,0],[399.3016357421875,347.2784423828125,0],[402.3592529296875,339.3646545410156,0],[406.3161315917969,332.530029296875,0],[409.0140075683594,330.0119934082031,0],[412.25146484375,328.3932800292969,0],[415.30908203125,328.2134094238281,0],[417.2875061035156,329.472412109375,0],[418.5465393066406,332.35015869140625,0],[419.08612060546875,335.40777587890625,0],[419.4458312988281,337.92578125,0],[417.4673767089844,342.9618225097656,0],[410.0931701660156,355.55194091796875,0],[404.5175476074219,363.285888671875,0],[404.1578369140625,365.4441833496094,0],[404.6974182128906,366.3434753417969,0],[406.3161315917969,365.80389404296875,0],[407.93487548828125,364.1851806640625,0],[411.7118835449219,360.5879821777344,0],[414.5896301269531,357.35052490234375,0],[417.4673767089844,353.9332275390625,0],[419.98541259765625,352.3144836425781,0],[422.50341796875,351.4151916503906,0],[423.58258056640625,352.1346435546875,0],[425.0214538574219,353.9332275390625,0],[425.0214538574219,356.9908142089844,0],[425.0214538574219,359.50885009765625,0],[422.3235778808594,365.08447265625,0],[418.90625,368.681640625,0],[412.25146484375,377.4947204589844,0],[405.5967102050781,384.8689270019531,0],[400.38079833984375,392.78271484375,0],[396.2440490722656,400.15692138671875,0],[392.4670104980469,407.5311584472656,0],[388.150390625,410.9484558105469,0],[384.1935119628906,412.3873291015625,0],[380.2366027832031,412.7470397949219,0],[376.4595642089844,410.5887451171875,0],[375.2005615234375,407.890869140625,0],[376.4595642089844,403.5742492675781,0],[377.7185974121094,400.15692138671875,0],[380.9560546875,397.638916015625,0],[383.8337707519531,394.041748046875,0],[386.8913879394531,391.16400146484375,0],[388.6899719238281,389.185546875,0],[390.4885559082031,387.386962890625,0],[390.8482666015625,385.7682189941406,0],[390.4885559082031,383.789794921875,0],[389.7691345214844,382.53076171875,0],[387.97052001953125,382.8905029296875,0],[385.63238525390625,384.1495056152344,0],[382.9344787597656,387.9265441894531,0],[376.4595642089844,396.55975341796875,0],[366.2076110839844,407.5311584472656,0],[358.1139831542969,413.28662109375,0],[352,409,0],[350,408,0],[349.6606140136719,410.76861572265625,0],[352,406,0],[351.4591979980469,403.7541198730469,0],[353.79736328125,400.6965026855469,0],[358.8334045410156,395.4805908203125,0],[363.86944580078125,391.3438415527344,0],[367.646484375,386.6675109863281,0],[370.7041015625,383.2502136230469,0],[370.8839416503906,381.2717590332031,0],[369.8048095703125,380.732177734375,0],[367.2867736816406,381.9911804199219,0],[359.9068603515625,388.282470703125,0],[349.7720642089844,397.4713439941406,0],[342.4750061035156,404.2278747558594,0],[335.8536071777344,409.22772216796875,0],[331.6645812988281,411.6600646972656,0],[327.47552490234375,413.4167785644531,0],[321.800048828125,415.7139892578125,0],[316.3948059082031,417.0652770996094,0],[313.69219970703125,416.3896484375,0],[311.2920837402344,414.49224853515625,0]]
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);

var controlsUnder = [[328.6385192871094,309.61920166015625,-60],[329.1790466308594,310.15972900390625,-60],[329.1790466308594,311.1056213378906,-60],[328.7736511230469,312.3218078613281,-60],[328.2331237792969,313.1325988769531,-60],[327.42236328125,314.6190185546875,-60],[326.071044921875,315.9703369140625,-60],[325.26025390625,317.1865234375,-60],[324.7197265625,318.1324157714844,-60],[324.7197265625,318.6729431152344,-60],[324.7197265625,320.2945251464844,-60],[324.7197265625,321.37554931640625,-60],[325.530517578125,321.51068115234375,-60],[326.4764404296875,321.51068115234375,-60],[327.2872314453125,321.24041748046875,-60],[328.0979919433594,320.1593933105469,-60],[329.4493103027344,319.2134704589844,-60],[329.8547058105469,318.4026794433594,-60],[330.5303649902344,317.456787109375,-60],[331.34112548828125,316.2406005859375,-60],[332.42218017578125,315.0244140625,-60],[332.69244384765625,313.9433898925781,-60],[333.90863037109375,312.9974670410156,-60],[334.8545227050781,311.7812805175781,-60],[335.9355773925781,310.97052001953125,-60],[339.0435791015625,310.29486083984375,-60],[339.989501953125,310.02459716796875,-60],[340.1246337890625,310.70025634765625,-60],[340.1246337890625,311.1056213378906,-60],[339.8543701171875,312.4569396972656,-60],[339.3138427734375,313.6731262207031,-60],[338.7733154296875,315.1595458984375,-60],[338.2327880859375,315.835205078125,-60],[337.827392578125,317.0513916015625,-60],[336.4761047363281,318.6729431152344,-60],[335.8004455566406,319.8891296386719,-60],[335.5301818847656,320.8350524902344,-60],[334.5842590332031,322.05120849609375,-60],[334.4491271972656,322.86199951171875,-60],[334.7193908691406,323.94305419921875,-60],[336.7463684082031,323.13226318359375,-60],[337.4219970703125,322.45660400390625,-60],[338.5030517578125,321.64581298828125,-60],[339.1787109375,320.4296569824219,-60],[340.9353942871094,319.2134704589844,-60],[342.2867126464844,318.5378112792969,-60],[343.90826416015625,318.1324157714844,-60],[344.58392333984375,318.4026794433594,-60],[345.12445068359375,319.6188659667969,-60],[344.44879150390625,321.37554931640625,-60],[343.7731628417969,322.72686767578125,-60],[343.2326354980469,324.4835510253906,-60],[342.5569763183594,325.4294738769531,-60],[341.4759216308594,326.6456604003906,-60],[339.989501953125,327.9969482421875,-60],[337.4219970703125,330.02392578125,-60],[333.90863037109375,332.7265319824219,-60],[332.4222106933594,334.61834716796875,-60],[329.9898376464844,336.9155578613281,-60],[327.962890625,337.7263488769531,-60],[325.1251525878906,339.4830322265625,-60],[322.15228271484375,340.2938232421875,-60],[321.07122802734375,339.6181640625,-60],[321.47662353515625,338.1317443847656,-60],[322.55767822265625,336.3750305175781,-60],[324.4494934082031,334.61834716796875,-60],[325.9359436035156,333.80755615234375,-60],[326.8818359375,332.99676513671875,-60],[327.962890625,332.0508728027344,-60],[328.9088134765625,331.3752136230469,-60],[329.7195739746094,330.4292907714844,-60],[329.8547058105469,329.4833679199219,-60],[329.314208984375,328.40234375,-60],[328.233154296875,328.40234375,-60],[326.7467041015625,328.8077392578125,-60],[317.4402770996094,337.6546630859375,-60],[315.1051940917969,337.8576965332031,-60],[312.6685791015625,337.2485656738281,-60],[312.3639831542969,335.82720947265625,-60],[315.1051940917969,331.8677062988281,-60],[317.3387451171875,329.1264953613281,-60],[320.18145751953125,324.8624267578125,-60],[319.57232666015625,324.1517639160156,-60],[317.84637451171875,324.1517639160156,-60],[315.71435546875,325.37005615234375,-60],[313.48077392578125,328.8219299316406,-60],[311.8563537597656,330.9539794921875,-60],[310.43499755859375,332.578369140625,-60],[307.6938171386719,334.81195068359375,-60],[304.8511047363281,335.9287109375,-60],[302.6175231933594,335.82720947265625,-60]]
var nubsUnder = createNubs(controlsUnder);
var Dx6 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);

var pointsLateral1 = [[393.90081787109375,338.36712646484375,0],[372,329,-48],[351,320,-57.8],[328.6385192871094,309.61920166015625,-60]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

var pointsLateral2 = [[311.2920837402344,414.49224853515625,0],[308,388,-48],[305,362,-57.8],[302.6175231933594,335.82720947265625,-60]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));
var bL1Dx = bLateral1;
var bL2Dx = bLateral2;

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 6 SX-----------------------------------------------------------------------

var controlsUpper = [[311.2920837402344,414.49224853515625,0],[311.1247253417969,412.3357238769531,0],[311.6652526855469,410.3087463378906,0],[314.23272705078125,406.1197204589844,0],[317.0704650878906,404.0927429199219,0],[323.5567321777344,400.0388488769531,0],[333.1510009765625,394.63360595703125,0],[344.7722473144531,388.9581298828125,0],[356.3934631347656,380.0395202636719,0],[359.9068603515625,376.1207275390625,0],[360.852783203125,374.7694091796875,0],[360.4473876953125,373.5532531738281,0],[358.5555725097656,373.4181213378906,0],[355.8529357910156,374.2288818359375,0],[351.9341735839844,377.3369140625,0],[346.2586669921875,382.06646728515625,0],[340.85345458984375,386.3906555175781,0],[336.3941345214844,390.444580078125,0],[332.74560546875,392.3363952636719,0],[329.7727355957031,392.6066589355469,0],[327.47552490234375,392.0661315917969,0],[326.39447021484375,389.6337890625,0],[327.74578857421875,386.5257873535156,0],[330.8537902832031,383.55291748046875,0],[336.3941345214844,379.2287292480469,0],[341.79937744140625,375.5802001953125,0],[346.7991943359375,372.4721984863281,0],[352.74493408203125,365.9859313964844,0],[354.09625244140625,362.7427978515625,0],[353.96112060546875,360.4455871582031,0],[353.01519775390625,359.4996643066406,0],[351.3936462402344,359.0942687988281,0],[349.6369323730469,359.0942687988281,0],[346.6640625,361.6617431640625,0],[342.8804016113281,364.6346130371094,0],[332.6104736328125,375.1748046875,0],[326.25933837890625,382.06646728515625,0],[321.800048828125,388.9581298828125,0],[317.3407287597656,392.3363952636719,0],[315.31378173828125,393.6877136230469,0],[312.4760437011719,393.1471862792969,0],[309.7734069824219,391.3904724121094,0],[310.4490661621094,388.6878662109375,0],[311.2598571777344,384.6339416503906,0],[314.77325439453125,379.0935974121094,0],[323.0162048339844,370.31011962890625,0],[339.09674072265625,356.25653076171875,0],[344.9073791503906,350.1756591796875,0],[347.8802490234375,345.9866027832031,0],[347.8620300292969,346.0194396972656,0],[350.7397766113281,340.6236572265625,0],[353.07794189453125,337.5660705566406,0],[354.6966552734375,334.14874267578125,0],[358.47369384765625,328.2134094238281,0],[359.37298583984375,324.79608154296875,0],[361.17156982421875,320.4794921875,0],[362.7903137207031,316.3427429199219,0],[364.22918701171875,312.3858337402344,0],[365.3083190917969,308.968505859375,0],[365.12847900390625,305.55120849609375,0],[365.4881896972656,301.774169921875,0],[365.66802978515625,298.5367126464844,0],[366.7471923828125,296.5582580566406,0],[369.9846496582031,292.9610900878906,0],[371.42352294921875,291.522216796875,0],[373.7616882324219,290.0833435058594,0],[376.099853515625,289.7236328125,0],[378.4380187988281,289.54376220703125,0],[380.4164733886719,290.80279541015625,0],[381.8553466796875,292.9610900878906,0],[383.2942199707031,294.7596740722656,0],[383.6539306640625,296.7381286621094,0],[383.6539306640625,299.4360046386719,0],[382.3948974609375,302.85333251953125,0],[380.77618408203125,307.34979248046875,0],[378.7977294921875,310.7671203613281,0],[377.17901611328125,312.9254150390625,0],[376.099853515625,315.80316162109375,0],[374.4811096191406,319.5802001953125,0],[374.30126953125,322.09820556640625,0],[374.6609802246094,326.4148254394531,0],[375.91998291015625,329.472412109375,0],[378.07830810546875,328.75299072265625,0],[380.2366027832031,326.95440673828125,0],[381.1358947753906,322.99749755859375,0],[381.1358947753906,318.3211669921875,0],[382.0351867675781,314.00457763671875,0],[383.47406005859375,309.5080871582031,0],[385.8122253417969,307.169921875,0],[388.5101013183594,306.45050048828125,0],[390.6684265136719,306.63037109375,0],[393.546142578125,307.169921875,0],[396.0641784667969,310.2275390625,0],[397.32318115234375,312.026123046875,0],[396.78363037109375,315.0837097167969,0],[395.52459716796875,318.680908203125,0],[393.72601318359375,322.99749755859375,0],[391.3878479003906,326.4148254394531,0],[389.4093933105469,330.0119934082031,0],[386.7115173339844,333.9689025878906,0],[382.57476806640625,338.8250732421875,0],[378.97760009765625,345.1201477050781,0],[376.27972412109375,348.7173156738281,0],[374.8408508300781,351.95477294921875,0],[375.02069091796875,354.1130676269531,0],[377.3588562011719,352.85406494140625,0],[380.4164733886719,349.4367370605469,0],[383.2942199707031,346.55902099609375,0],[386.351806640625,343.50140380859375,0],[388.6899719238281,341.52294921875,0],[391.3878479003906,339.5445251464844,0],[393.90081787109375,338.36712646484375,0]]
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);

var controlsUnder = [[302.6175231933594,335.82720947265625,-50],[301.7843322753906,335.7137756347656,-50],[301.5140686035156,335.17327880859375,-50],[301.6492004394531,334.36248779296875,-50],[302.1897277832031,333.82196044921875,-50],[303.541015625,332.74090576171875,-50],[304.7572021484375,331.5247497558594,-50],[305.5679626464844,330.4436950683594,-50],[306.1084899902344,329.7680358886719,-50],[307.1895446777344,328.957275390625,-50],[308.5408630371094,327.876220703125,-50],[309.62188720703125,326.9302978515625,-50],[310.70294189453125,326.1195068359375,-50],[311.64886474609375,324.7682189941406,-50],[312.4596252441406,323.4169006347656,-50],[312.3244934082031,322.7412414550781,-50],[311.24346923828125,322.33587646484375,-50],[309.89215087890625,323.1466369628906,-50],[308.5408630371094,324.4979553222656,-50],[307.0544128417969,325.8492431640625,-50],[305.9733581542969,327.2005615234375,-50],[305.2977294921875,328.146484375,-50],[304.4869384765625,328.8221435546875,-50],[303.1356201171875,329.6329040527344,-50],[302.0545959472656,329.7680358886719,-50],[301.1086730957031,329.7680358886719,-50],[301.3789367675781,328.5518798828125,-50],[301.9194641113281,327.2005615234375,-50],[302.8653564453125,326.1195068359375,-50],[303.9464111328125,325.0384826660156,-50],[305.2977294921875,324.0925598144531,-50],[306.6490173339844,323.1466369628906,-50],[307.7300720214844,322.6061096191406,-50],[308.5408630371094,321.93048095703125,-50],[309.08135986328125,321.52508544921875,-50],[309.21649169921875,320.84942626953125,-50],[308.94622802734375,320.03863525390625,-50],[308.2705993652344,319.76837158203125,-50],[307.0544128417969,319.76837158203125,-50],[305.8382263183594,320.57916259765625,-50],[304.08154296875,321.66021728515625,-50],[302.5950927734375,322.7412414550781,-50],[300.9735412597656,324.0925598144531,-50],[300.5681457519531,325.1736145019531,-50],[299.2168273925781,325.8492431640625,-50],[297.46014404296875,326.6600341796875,-50],[295.83856201171875,327.60595703125,-50],[294.3521423339844,328.416748046875,-50],[292.3251953125,329.0923767089844,-50],[291.3792724609375,331.3896179199219,-50],[290.1630859375,332.2004089355469,-50],[288.1361389160156,333.14630126953125,-50],[286.2442932128906,333.95709228515625,-50],[283.81195068359375,334.22735595703125,-50],[282.0552673339844,333.82196044921875,-50],[282.0552673339844,332.3355407714844,-50],[283.13629150390625,330.1734313964844,-50],[283.54168701171875,329.2275085449219,-50],[284.62274169921875,328.2816162109375,-50],[285.29840087890625,327.60595703125,-50],[286.5145568847656,326.795166015625,-50],[288.2712707519531,325.3087463378906,-50],[289.352294921875,324.2276916503906,-50],[291.3792724609375,323.1466369628906,-50],[292.5954284667969,322.33587646484375,-50],[294.3521423339844,320.84942626953125,-50],[296.24395751953125,319.63323974609375,-50],[298.67633056640625,318.0116882324219,-50],[301.9194641113281,315.30908203125,-50],[304.2166748046875,313.14697265625,-50],[305.8382263183594,311.2551574707031,-50],[307.3246765136719,308.82281494140625,-50],[308.5408630371094,306.66070556640625,-50],[310.16241455078125,304.2283630371094,-50],[311.24346923828125,301.5257568359375,-50],[312.7298889160156,299.0934143066406,-50],[314.2163391113281,297.6069641113281,-50],[315.4324951171875,296.3907775878906,-50],[317.4594421386719,294.76922607421875,-50],[319.0810241699219,293.2828063964844,-50],[321.24310302734375,293.1476745605469,-50],[322.45928955078125,293.41790771484375,-50],[323.5403137207031,294.22869873046875,-50],[323.9457092285156,295.44488525390625,-50],[323.9457092285156,297.2015686035156,-50],[323.8105773925781,298.8231506347656,-50],[322.9997863769531,299.6339416503906,-50],[321.64849853515625,300.85009765625,-50],[320.02691650390625,302.201416015625,-50],[319.4864196777344,303.9580993652344,-50],[320.02691650390625,305.9850769042969,-50],[321.78363037109375,305.7148132324219,-50],[323.2700500488281,304.2283630371094,-50],[324.7565002441406,302.4716796875,-50],[326.1078186035156,301.390625,-50],[328.134765625,301.390625,-50],[329.0806884765625,302.6068115234375,-50],[328.405029296875,304.0932312011719,-50],[327.0537109375,305.3094177246094,-50],[325.1618957519531,306.66070556640625,-50],[323.6754455566406,308.14715576171875,-50],[322.45928955078125,310.4443664550781,-50],[321.24310302734375,313.2821044921875,-50],[321.78363037109375,315.038818359375,-50],[322.72955322265625,314.7685546875,-50],[324.3511047363281,313.6875,-50],[325.2970275878906,312.3362121582031,-50],[326.242919921875,310.9848937988281,-50],[326.783447265625,310.1741027832031,-50],[327.7293701171875,309.49847412109375,-50],[328.405029296875,309.49847412109375,-50],[328.6385192871094,309.61920166015625,-50]]
var nubsUnder = createNubs(controlsUnder);
var Sx6 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);

var pointsLateral1 = [[311.2920837402344,414.49224853515625,0],[308,388,-40],[305,362,-48],[302.6175231933594,335.82720947265625,-50]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

var pointsLateral2 = [[393.90081787109375,338.36712646484375,0], [372,329,-40],[351,320,-48],[328.6385192871094,309.61920166015625,-50]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));
var bL1Sx = bLateral1;
var bL2Sx = bLateral2;


var controlsContourEx6 = [[347.8620300292969,346.0194396972656,0],[350.7397766113281,340.6236572265625,0],[353.07794189453125,337.5660705566406,0],[354.6966552734375,334.14874267578125,0],[358.47369384765625,328.2134094238281,0],[359.37298583984375,324.79608154296875,0],[361.17156982421875,320.4794921875,0],[362.7903137207031,316.3427429199219,0],[364.22918701171875,312.3858337402344,0],[365.3083190917969,308.968505859375,0],[365.12847900390625,305.55120849609375,0],[365.4881896972656,301.774169921875,0],[365.66802978515625,298.5367126464844,0],[366.7471923828125,296.5582580566406,0],[369.9846496582031,292.9610900878906,0],[371.42352294921875,291.522216796875,0],[373.7616882324219,290.0833435058594,0],[376.099853515625,289.7236328125,0],[378.4380187988281,289.54376220703125,0],[380.4164733886719,290.80279541015625,0],[381.8553466796875,292.9610900878906,0],[383.2942199707031,294.7596740722656,0],[383.6539306640625,296.7381286621094,0],[383.6539306640625,299.4360046386719,0],[382.3948974609375,302.85333251953125,0],[380.77618408203125,307.34979248046875,0],[378.7977294921875,310.7671203613281,0],[377.17901611328125,312.9254150390625,0],[376.099853515625,315.80316162109375,0],[374.4811096191406,319.5802001953125,0],[374.30126953125,322.09820556640625,0],[374.6609802246094,326.4148254394531,0],[375.91998291015625,329.472412109375,0],[378.07830810546875,328.75299072265625,0],[380.2366027832031,326.95440673828125,0],[381.1358947753906,322.99749755859375,0],[381.1358947753906,318.3211669921875,0],[382.0351867675781,314.00457763671875,0],[383.47406005859375,309.5080871582031,0],[385.8122253417969,307.169921875,0],[388.5101013183594,306.45050048828125,0],[390.6684265136719,306.63037109375,0],[393.546142578125,307.169921875,0],[396.0641784667969,310.2275390625,0],[397.32318115234375,312.026123046875,0],[396.78363037109375,315.0837097167969,0],[395.52459716796875,318.680908203125,0],[393.72601318359375,322.99749755859375,0],[391.3878479003906,326.4148254394531,0],[389.4093933105469,330.0119934082031,0],[386.7115173339844,333.9689025878906,0],[382.57476806640625,338.8250732421875,0],[378.97760009765625,345.1201477050781,0],[376.27972412109375,348.7173156738281,0],[374.8408508300781,351.95477294921875,0],[375.02069091796875,354.1130676269531,0],[377.3588562011719,352.85406494140625,0],[380.4164733886719,349.4367370605469,0],[383.2942199707031,346.55902099609375,0],[386.351806640625,343.50140380859375,0],[388.6899719238281,341.52294921875,0],[391.3878479003906,339.5445251464844,0],[393.90081787109375,338.36712646484375,0],[395.1975402832031,340.12152099609375,0],[395.1648864746094,342.2424011230469,0],[393.9058837890625,346.0194396972656,0],[393.006591796875,351.4151916503906,0],[390.6684265136719,355.55194091796875,0],[389.4093933105469,358.4296875,0],[387.7906799316406,361.6671447753906,0],[387.43096923828125,364.3650207519531,0],[389.0496826171875,364.7247619628906,0],[391.3878479003906,363.8254699707031,0],[394.0857238769531,361.1275634765625,0],[396.603759765625,355.3721008300781,0],[399.3016357421875,347.2784423828125,0],[402.3592529296875,339.3646545410156,0],[406.3161315917969,332.530029296875,0],[409.0140075683594,330.0119934082031,0],[412.25146484375,328.3932800292969,0],[415.30908203125,328.2134094238281,0],[417.2875061035156,329.472412109375,0],[418.5465393066406,332.35015869140625,0],[419.08612060546875,335.40777587890625,0],[419.4458312988281,337.92578125,0],[417.4673767089844,342.9618225097656,0],[410.0931701660156,355.55194091796875,0],[404.5175476074219,363.285888671875,0],[404.1578369140625,365.4441833496094,0],[404.6974182128906,366.3434753417969,0],[406.3161315917969,365.80389404296875,0],[407.93487548828125,364.1851806640625,0],[411.7118835449219,360.5879821777344,0],[414.5896301269531,357.35052490234375,0],[417.4673767089844,353.9332275390625,0],[419.98541259765625,352.3144836425781,0],[422.50341796875,351.4151916503906,0],[423.58258056640625,352.1346435546875,0],[425.0214538574219,353.9332275390625,0],[425.0214538574219,356.9908142089844,0]]
var nubsContourEx6 = createNubs(controlsContourEx6);
var controlsRerInPart6 = [[352.58819580078125,346.321533203125,0],[354.0270690917969,343.9833679199219,0],[355.28607177734375,341.8250732421875,0],[357.8040771484375,338.5876159667969,0],[360.3221130371094,334.09112548828125,0],[361.9408264160156,330.3141174316406,0],[363.1998596191406,327.07666015625,0],[364.4588623046875,324.19891357421875,0],[364.9984436035156,320.421875,0],[366.9768981933594,313.94696044921875,0],[368.0560302734375,310.34979248046875,0],[368.955322265625,307.29217529296875,0],[369.13519287109375,302.0762634277344,0],[370.7539367675781,299.3783874511719,0],[372.3726501464844,296.6805114746094,0],[373.8115234375,294.34234619140625,0],[375.43023681640625,293.6229248046875,0],[376.68927001953125,293.6229248046875,0],[379.0274353027344,295.061767578125,0],[380.28643798828125,296.8603820800781,0],[380.28643798828125,298.2992248535156,0],[379.5670166015625,301.5367126464844,0],[378.6676940917969,304.59429931640625,0],[376.1496887207031,309.2706298828125,0],[373.99139404296875,312.6879577636719,0],[372.73236083984375,316.64483642578125,0],[371.6532287597656,320.7815856933594,0],[370.93377685546875,325.817626953125,0],[371.1136474609375,330.3141174316406,0],[373.2719421386719,332.29254150390625,0],[375.610107421875,333.0119934082031,0],[377.40869140625,332.29254150390625,0],[380.8260192871094,331.7529602050781,0],[382.08502197265625,329.2349548339844,0],[383.3440246582031,325.09820556640625,0],[384.9627685546875,319.5225830078125,0],[386.58148193359375,316.2851257324219,0],[388.0203552246094,311.78863525390625,0],[389.2793884277344,310.34979248046875,0],[391.0779724121094,309.99005126953125,0],[392.8765563964844,310.34979248046875,0],[393.23626708984375,311.78863525390625,0],[393.4161376953125,315.2059631347656,0],[392.6966857910156,318.8031311035156,0],[390.53839111328125,323.6593322753906,0],[381.7253112792969,335.7098693847656,0],[377.58856201171875,342.724365234375,0],[373.8115234375,347.0409851074219,0],[370.7539367675781,350.99786376953125,0],[369.8546142578125,354.2353210449219,0],[370.5740661621094,357.65264892578125,0],[372.1927795410156,360.170654296875,0],[375.43023681640625,359.8109436035156,0],[377.40869140625,358.0123596191406,0],[379.9267272949219,355.1346130371094,0],[382.264892578125,352.0770263671875,0],[385.5023498535156,349.19927978515625,0],[388.5599365234375,346.321533203125,0],[389.9988098144531,344.52294921875,0],[391.6175537109375,344.1632385253906,0],[391.6175537109375,345.7819519042969,0],[390.1786804199219,348.4798278808594,0],[386.58148193359375,354.95477294921875,0],[383.5238952636719,361.4296875,0],[381.9051818847656,365.74627685546875,0],[382.08502197265625,367.90460205078125,0],[383.3440246582031,368.9837341308594,0],[386.04193115234375,368.9837341308594,0],[389.9988098144531,368.9837341308594,0],[393.0564270019531,366.825439453125,0],[395.2147216796875,364.1275634765625,0],[401.1500549316406,356.39361572265625,0],[405.28680419921875,347.5805358886719,0],[407.44512939453125,341.1056213378906,0],[408.7041320800781,337.14874267578125,0],[409.7832946777344,335.7098693847656,0],[412.1214599609375,334.27099609375,0],[413.3804626464844,333.7314147949219,0],[414.9991760253906,334.6307067871094,0],[415.3589172363281,336.24945068359375,0],[414.2797546386719,341.1056213378906,0],[409.7832946777344,349.7388610839844,0],[404.0278015136719,359.0915222167969,0],[400.0708923339844,364.6671447753906,0],[398.6320495605469,369.1636047363281,0],[399.3514709472656,370.7823486328125,0],[402.0493469238281,371.3218994140625,0],[404.5673828125,370.60247802734375,0],[407.8048400878906,368.9837341308594,0],[409.4235534667969,367.1851501464844,0],[410.6825866699219,365.3865661621094,0],[413.560302734375,362.6886901855469,0],[416.43804931640625,358.9116516113281,0],[418.9560852050781,356.9331970214844,0],[420.9345397949219,356.573486328125,0],[422.3733825683594,358.1922302246094,0],[420.7546691894531,361.0699462890625,0],[414.9991760253906,367.1851501464844,0],[409.7832946777344,373.1204833984375,0],[400.79034423828125,386.6098937988281,0]]
var nubsRerInPart6 = createNubs(controlsRerInPart6);
var boundaryPart6 = createBezierS1([nubsContourEx6, nubsRerInPart6]);
var boundaryPart6Map = MAP(boundaryPart6)(domain2);
DRAW(COLOR(mattLightYellow)(boundaryPart6Map));

var controlsContourEx6 = [[425.0214538574219,356.9908142089844,0],[425.0214538574219,359.50885009765625,0],[422.3235778808594,365.08447265625,0],[418.90625,368.681640625,0],[412.25146484375,377.4947204589844,0],[405.5967102050781,384.8689270019531,0],[400.38079833984375,392.78271484375,0],[396.2440490722656,400.15692138671875,0],[392.4670104980469,407.5311584472656,0],[388.150390625,410.9484558105469,0],[384.1935119628906,412.3873291015625,0],[380.2366027832031,412.7470397949219,0],[376.4595642089844,410.5887451171875,0],[375.2005615234375,407.890869140625,0],[376.4595642089844,403.5742492675781,0],[377.7185974121094,400.15692138671875,0],[380.9560546875,397.638916015625,0],[383.8337707519531,394.041748046875,0],[386.8913879394531,391.16400146484375,0],[388.6899719238281,389.185546875,0],[390.4885559082031,387.386962890625,0],[390.8482666015625,385.7682189941406,0],[390.4885559082031,383.789794921875,0],[389.7691345214844,382.53076171875,0],[387.97052001953125,382.8905029296875,0],[385.63238525390625,384.1495056152344,0],[382.9344787597656,387.9265441894531,0],[376.4595642089844,396.55975341796875,0],[366.2076110839844,407.5311584472656,0],[358.1139831542969,413.28662109375,0],[352,409,0],[350,408,0],[352,406,0],[350.02032470703125,407.5311584472656,0],[351.4591979980469,403.7541198730469,0],[353.79736328125,400.6965026855469,0],[358.8334045410156,395.4805908203125,0],[363.86944580078125,391.3438415527344,0],[367.646484375,386.6675109863281,0],[370.7041015625,383.2502136230469,0],[370.8839416503906,381.2717590332031,0],[369.8048095703125,380.732177734375,0],[367.2867736816406,381.9911804199219,0],[359.9068603515625,388.282470703125,0],[349.7720642089844,397.4713439941406,0],[342.4750061035156,404.2278747558594,0],[335.8536071777344,409.22772216796875,0],[331.6645812988281,411.6600646972656,0],[327.47552490234375,413.4167785644531,0],[321.800048828125,415.7139892578125,0],[316.3948059082031,417.0652770996094,0],[313.69219970703125,416.3896484375,0],[311.2920837402344,414.49224853515625,0],[311.1247253417969,412.3357238769531,0],[311.6652526855469,410.3087463378906,0],[314.23272705078125,406.1197204589844,0],[317.0704650878906,404.0927429199219,0],[323.5567321777344,400.0388488769531,0],[333.1510009765625,394.63360595703125,0],[344.7722473144531,388.9581298828125,0],[356.3934631347656,380.0395202636719,0],[359.9068603515625,376.1207275390625,0],[360.852783203125,374.7694091796875,0],[360.4473876953125,373.5532531738281,0],[358.5555725097656,373.4181213378906,0],[355.8529357910156,374.2288818359375,0],[351.9341735839844,377.3369140625,0],[346.2586669921875,382.06646728515625,0],[340.85345458984375,386.3906555175781,0],[336.3941345214844,390.444580078125,0],[332.74560546875,392.3363952636719,0],[329.7727355957031,392.6066589355469,0],[327.47552490234375,392.0661315917969,0],[326.39447021484375,389.6337890625,0],[327.74578857421875,386.5257873535156,0],[330.8537902832031,383.55291748046875,0],[336.3941345214844,379.2287292480469,0],[341.79937744140625,375.5802001953125,0],[346.7991943359375,372.4721984863281,0],[352.74493408203125,365.9859313964844,0],[354.09625244140625,362.7427978515625,0],[353.96112060546875,360.4455871582031,0],[353.01519775390625,359.4996643066406,0],[351.3936462402344,359.0942687988281,0],[349.6369323730469,359.0942687988281,0],[346.6640625,361.6617431640625,0],[342.8804016113281,364.6346130371094,0],[332.6104736328125,375.1748046875,0],[326.25933837890625,382.06646728515625,0],[321.800048828125,388.9581298828125,0],[317.3407287597656,392.3363952636719,0],[315.31378173828125,393.6877136230469,0],[312.4760437011719,393.1471862792969,0],[309.7734069824219,391.3904724121094,0],[310.4490661621094,388.6878662109375,0],[311.2598571777344,384.6339416503906,0],[314.77325439453125,379.0935974121094,0],[323.0162048339844,370.31011962890625,0],[339.09674072265625,356.25653076171875,0],[344.9073791503906,350.1756591796875,0],[347.8802490234375,345.9866027832031,0],[347.8620300292969,346.0194396972656,0]]
var nubsContourEx6 = createNubs(controlsContourEx6);
var controlsRerInPart6 = [[400.79034423828125,386.6098937988281,0],[393.23626708984375,399.55975341796875,0],[389.459228515625,405.6749267578125,0],[386.4016418457031,408.1929626464844,0],[383.88360595703125,409.2721252441406,0],[381.18572998046875,409.6318359375,0],[380.28643798828125,408.0130920410156,0],[380.8260192871094,404.5957946777344,0],[384.0634765625,399.3798828125,0],[386.4016418457031,396.1424255371094,0],[389.9988098144531,391.6459655761719,0],[393.4161376953125,388.04876708984375,0],[394.3154296875,384.9911804199219,0],[394.4952697753906,382.1134338378906,0],[393.4161376953125,380.1349792480469,0],[391.0779724121094,378.5162658691406,0],[387.4808044433594,378.5162658691406,0],[385.3224792480469,381.3940124511719,0],[381.7253112792969,384.9911804199219,0],[376.68927001953125,391.4660949707031,0],[370.7539367675781,398.1208801269531,0],[363.0199890136719,404.775634765625,0],[358.3436584472656,408.9123840332031,0],[355.4659118652344,409.9915466308594,0],[353.6673278808594,409.45196533203125,0],[351.8687438964844,408.1929626464844,0],[351.8687438964844,406.2145080566406,0],[353.48748779296875,403.6965026855469,0],[356.7249450683594,401.178466796875,0],[361.0415344238281,397.581298828125,0],[367.6963195800781,392.72509765625,0],[373.4518127441406,389.30780029296875,0],[375.9698181152344,385.53076171875,0],[377.9482727050781,382.1134338378906,0],[377.40869140625,379.05584716796875,0],[375.78997802734375,377.6169738769531,0],[373.4518127441406,376.89752197265625,0],[370.21435546875,377.077392578125,0],[367.6963195800781,378.5162658691406,0],[364.27899169921875,381.0342712402344,0],[360.5019836425781,384.45159912109375,0],[354.9263610839844,389.1279296875,0],[347.1924133300781,396.8618469238281,0],[340.53765869140625,401.7180480957031,0],[333.3432922363281,407.1138000488281,0],[325.0697937011719,411.25054931640625,0],[320.2135925292969,412.6894226074219,0],[316.2567138671875,412.14984130859375,0],[315.357421875,410.71099853515625,0],[315.8970031738281,409.2721252441406,0],[317.6955871582031,408.0130920410156,0],[322.9114685058594,404.775634765625,0],[332.4440002441406,399.3798828125,0],[341.07720947265625,394.8834228515625,0],[349.3507385253906,389.6675109863281,0],[357.4443664550781,382.8328857421875,0],[362.1206970214844,378.69610595703125,0],[364.0991516113281,374.7392272949219,0],[365.358154296875,370.60247802734375,0],[363.9192810058594,369.1636047363281,0],[362.3005676269531,368.4441833496094,0],[359.6026916503906,370.2427673339844,0],[352.9479064941406,372.5809326171875,0],[344.4945373535156,379.4155578613281,0],[338.37933349609375,384.8113098144531,0],[334.4224548339844,388.04876708984375,0],[331.18499755859375,389.4876403808594,0],[329.92596435546875,388.94805908203125,0],[331.18499755859375,386.7897644042969,0],[334.4224548339844,384.45159912109375,0],[340.53765869140625,379.95513916015625,0],[348.9909973144531,373.6600646972656,0],[353.12774658203125,369.8830261230469,0],[355.6457824707031,365.74627685546875,0],[356.5450744628906,363.228271484375,0],[356.5450744628906,361.4296875,0],[356.5450744628906,359.2713623046875,0],[355.4659118652344,358.1922302246094,0],[352.7680358886719,356.9331970214844,0],[350.2500305175781,356.9331970214844,0],[346.4729919433594,358.7317810058594,0],[344.13482666015625,360.170654296875,0],[341.07720947265625,361.7893981933594,0],[336.40087890625,364.3074035644531,0],[329.92596435546875,370.7823486328125,0],[324.7100830078125,377.6169738769531,0],[322.1920471191406,383.1925964355469,0],[319.13446044921875,386.6098937988281,0],[317.156005859375,388.40850830078125,0],[315.17755126953125,389.30780029296875,0],[313.1990966796875,388.5883483886719,0],[313.558837890625,385.8904724121094,0],[314.9977111816406,381.5738525390625,0],[321.83233642578125,374.7392272949219,0],[326.8683776855469,370.60247802734375,0],[331.3648376464844,366.64556884765625,0],[336.7606201171875,362.14910888671875,0],[340.17791748046875,358.9116516113281,0],[345.3938293457031,353.3360290527344,0],[350.2500305175781,348.29998779296875,0],[352.58819580078125,346.321533203125,0]]
var nubsRerInPart6 = createNubs(controlsRerInPart6);
var boundaryPart6 = createBezierS1([nubsContourEx6, nubsRerInPart6]);
var boundaryPart6Map = MAP(boundaryPart6)(domain2);
DRAW(COLOR(mattLightYellow)(boundaryPart6Map));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);


//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 8 DX-----------------------------------------------------------------------


var controlsUpper = [[187.3293914794922,291.7502136230469,0],[188.2753143310547,290.6691589355469,0],[189.08609008789062,288.77734375,0],[191.11305236816406,277.8317565917969,0],[196.24801635742188,264.3186950683594,0],[198.95062255859375,260.39990234375,0],[200.8424530029297,258.5080871582031,0],[202.86941528320312,258.3729553222656,0],[204.35585021972656,258.9134826660156,0],[206.653076171875,260.39990234375,0],[208.00437927246094,261.8863525390625,0],[206.653076171875,280.26409912109375,0],[206.2476806640625,305.5335388183594,0],[207.86924743652344,316.3439636230469,0],[211.6529083251953,329.0462341308594,0],[221.24717712402344,343.37005615234375,0],[233.0035400390625,356.0723571777344,0],[245.5706787109375,365.6666259765625,0],[248.67868041992188,369.31512451171875,0],[249.35433959960938,370.93670654296875,0],[249.8948516845703,373.0987854003906,0],[249.4894561767578,375.2608947753906,0],[248.54354858398438,376.747314453125,0],[247.05711364746094,377.6932373046875,0],[245.165283203125,378.5040283203125,0],[242.86807250976562,378.5040283203125,0],[240.4357147216797,378.368896484375,0],[236.3817901611328,375.6662902832031,0],[229.76040649414062,369.1800231933594,0],[227.5983123779297,368.5043640136719,0],[226.51727294921875,368.9097595214844,0]]
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);

var controlsUnder = [[253.835693359375,292.292236328125,-50],[254.11618041992188,289.2857666015625,-50],[254.11618041992188,289.271728515625,-50],[254.43479919433594,282.89910888671875,-50],[255.3907012939453,277.16375732421875,-50],[257.302490234375,270.15386962890625,-50],[259.8515319824219,266.3302917480469,-50],[262.7192077636719,265.6930236816406,-50],[265.5868835449219,267.9234619140625,-50],[265.905517578125,272.7029113769531,-50],[265.26824951171875,278.4382629394531,-50],[263.037841796875,281.62457275390625,-50],[261.4446716308594,286.0854187011719,-50],[261.12603759765625,291.1835021972656,-50],[260.80743408203125,296.9188537597656,-50],[263.67510986328125,302.3355712890625,-50],[265.26824951171875,307.11505126953125,-50],[267.1800537109375,310.3013610839844,-50],[270.6849670410156,314.44354248046875,-50],[272.9154052734375,318.58575439453125,-50],[276.1017150878906,320.816162109375,-50],[280.243896484375,324.32110595703125,-50],[281.1997985839844,326.551513671875,-50],[283.74884033203125,331.33099365234375,-50],[284.0674743652344,335.1545715332031,-50],[284.0674743652344,338.65948486328125,-50],[283.111572265625,340.5712890625,-50],[280.5625305175781,340.8899230957031,-50],[277.376220703125,340.8899230957031,-50],[274.8271789550781,338.65948486328125,-50],[273.2340393066406,337.3849792480469,-50],[269.0918273925781,334.5173034667969,-50],[266.8995666503906,335.3074035644531,-50]]
var nubsUnder = createNubs(controlsUnder);
var Dx8 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);

var pointsLateral1 = [[187.3293914794922,291.7502136230469,0],[209,291.1,-40],[231,291.9,-48],[253.835693359375,292.292236328125,-50]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

var pointsLateral2 = [[226.51727294921875,368.9097595214844,0],[239,357,-40],[242,346,-48],[266.8995666503906,335.3074035644531,-50]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));

var bL1Dx = bLateral1;
var bL2Dx = bLateral2;

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 8 SX-----------------------------------------------------------------------



var controlsUpper = reverseR([[226.51727294921875,368.9097595214844,0],[227.0577850341797,369.99078369140625,0],[228.27395629882812,372.15289306640625,0],[230.03065490722656,374.7203674316406,0],[231.6522216796875,377.1527099609375,0],[233.13865661621094,379.0445556640625,0],[234.48997497558594,382.1525573730469,0],[234.08457946777344,384.99029541015625,0],[233.2738037109375,386.8821105957031,0],[230.57118225097656,387.4226379394531,0],[227.3280487060547,385.93621826171875,0],[223.27413940429688,382.2876892089844,0],[219.6256103515625,377.828369140625,0],[214.8960418701172,367.5584411621094,0],[210.03134155273438,361.0721740722656,0],[204.89637756347656,357.69390869140625,0],[203.54507446289062,357.69390869140625,0],[201.6532440185547,358.09930419921875,0],[200.16680908203125,360.5316467285156,0],[200.03167724609375,362.9640197753906,0],[201.6532440185547,366.7476501464844,0],[207.3287353515625,374.8554992675781,0],[215.5717010498047,382.1525573730469,0],[230.97657775878906,389.584716796875,0],[233.81431579589844,391.206298828125,0],[235.70614624023438,393.2332458496094,0],[236.92233276367188,396.07098388671875,0],[236.92233276367188,398.77362060546875,0],[235.57101440429688,400.5303039550781,0],[232.327880859375,403.23291015625,0],[229.62527465820312,403.3680419921875,0],[223.13900756835938,402.1518859863281,0],[210.84213256835938,394.1791687011719,0],[185.3024444580078,368.5043640136719,0],[181.65391540527344,362.8288879394531,0],[170.84347534179688,344.45111083984375,0],[169.35704040527344,339.856689453125,0],[169.49217224121094,336.0730285644531,0],[170.30294799804688,333.23529052734375,0],[171.7893829345703,331.34344482421875,0],[174.49200439453125,330.3975524902344,0],[177.32974243164062,330.3975524902344,0],[180.437744140625,331.74884033203125,0],[184.7619171142578,335.6676330566406,0],[186.78887939453125,340.126953125,0],[190.30227661132812,344.85650634765625,0],[193.1400146484375,346.61322021484375,0],[193.54541015625,345.80242919921875,0],[193.9508056640625,344.04571533203125,0],[192.32923889160156,338.0999755859375,0],[187.05914306640625,325.938232421875,0],[182.32955932617188,314.7223815917969,0],[181.11338806152344,310.938720703125,0],[180.437744140625,309.1820373535156,0],[178.95130920410156,307.8307189941406,0],[177.46485900878906,306.88482666015625,0],[176.31564331054688,306.900390625,0],[176.2087860107422,306.8954772949219,0],[174.2969970703125,309.44451904296875,0],[172.70384216308594,313.9053649902344,0],[172.70384216308594,320.59661865234375,0],[172.06658935546875,325.6947021484375,0],[170.4734344482422,329.19964599609375,0],[168.88027954101562,331.4300537109375,0],[165.05670166015625,329.5182800292969,0],[162.18902587890625,325.6947021484375,0],[157.09092712402344,307.214111328125,0],[157.09092712402344,273.75787353515625,0],[160.5958709716797,254.64002990722656,0],[161.5517578125,249.54193115234375,0],[164.73806762695312,246.35562133789062,0],[167.92437744140625,245.0811004638672,0],[170.79205322265625,244.76246643066406,0],[172.3852081298828,246.35562133789062,0],[174.61563110351562,250.8164520263672,0],[174.93426513671875,281.0863952636719,0],[175.57151794433594,282.36090087890625,0],[176.5274200439453,281.405029296875,0],[178.27565002441406,273.77783203125,0],[178.27565002441406,268.77801513671875,0],[178.68104553222656,264.8592224121094,0],[181.38365173339844,259.3188781738281,0],[184.0862579345703,256.8865051269531,0],[185.3024444580078,256.48114013671875,0],[187.5996551513672,257.0216369628906,0],[189.22122192382812,258.2378234863281,0],[190.70765686035156,260.670166015625,0],[190.84278869628906,262.1566162109375,0],[187.1942596435547,281.21002197265625,0],[186.24835205078125,289.5881042480469,0],[187.3293914794922,291.7502136230469,0]])
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);

var controlsUnder = reverseR([[266.8995666503906,335.3074035644531,-60],[267.4986572265625,338.0222473144531,-60],[268.4545593261719,340.5712890625,-60],[271.640869140625,342.4830627441406,-60],[272.9154052734375,344.7134704589844,-60],[274.1899108886719,349.4929504394531,-60],[272.27813720703125,353.3165283203125,-60],[268.773193359375,354.27239990234375,-60],[263.3564758300781,352.9978942871094,-60],[259.2142639160156,349.17431640625,-60],[259.2142639160156,341.8457946777344,-60],[258.5769958496094,338.0222473144531,-60],[257.302490234375,334.5173034667969,-60],[253.1602783203125,334.19866943359375,-60],[248.69944763183594,336.7477111816406,-60],[249.3367156982422,340.5712890625,-60],[252.5230255126953,346.6252746582031,-60],[256.3465881347656,350.1302185058594,-60],[258.25836181640625,352.9978942871094,-60],[262.0819396972656,356.1842041015625,-60],[262.40057373046875,359.0518798828125,-60],[262.40057373046875,360.64501953125,-60],[259.53289794921875,361.6009216308594,-60],[256.0279541015625,360.9636535644531,-60],[253.1602783203125,359.0518798828125,-60],[249.6553497314453,354.5910339355469,-60],[245.83177185058594,350.1302185058594,-60],[243.28273010253906,345.0321044921875,-60],[240.41505432128906,338.0222473144531,-60],[238.18463134765625,333.2427673339844,-60],[236.27284240722656,328.7819519042969,-60],[235.9542236328125,324.9583740234375,-60],[236.27284240722656,323.0466003417969,-60],[239.4591522216797,322.0906982421875,-60],[241.05230712890625,323.3652038574219,-60],[243.91998291015625,327.18878173828125,-60],[248.06219482421875,328.1446838378906,-60],[249.3367156982422,325.9142761230469,-60],[248.3808135986328,322.0906982421875,-60],[244.5572509765625,317.31121826171875,-60],[243.28273010253906,313.4876708984375,-60],[241.37094116210938,310.6199951171875,-60],[238.8218994140625,309.0268249511719,-60],[235.9542236328125,314.44354248046875,-60],[235.9542236328125,317.948486328125,-60],[232.76791381835938,318.58575439453125,-60],[231.1747589111328,314.7621765136719,-60],[230.21885681152344,307.7523193359375,-60],[229.90023803710938,293.7325439453125,-60],[229.58160400390625,288.3158264160156,-60],[231.49339294433594,281.62457275390625,-60],[234.0424346923828,273.9774475097656,-60],[235.63558959960938,267.6048278808594,-60],[237.86599731445312,264.7371520996094,-60],[239.7777862548828,264.7371520996094,-60],[241.6895751953125,267.9234619140625,-60],[241.05230712890625,273.3401794433594,-60],[239.7777862548828,277.16375732421875,-60],[239.14051818847656,282.5804748535156,-60],[242.00820922851562,287.35992431640625,-60],[243.28273010253906,287.6785583496094,-60],[245.1945037841797,281.9432067871094,-60],[245.83177185058594,278.4382629394531,-60],[248.3808135986328,273.6588134765625,-60],[249.97396850585938,273.3401794433594,-60],[251.24850463867188,274.61468505859375,-60],[252.2043914794922,280.3500671386719,-60],[251.24850463867188,286.404052734375,-60],[250.92987060546875,289.5903625488281,-60],[252.2043914794922,292.4580383300781,-60],[253.835693359375,292.292236328125,-60]]);
var nubsUnder = createNubs(controlsUnder);
var Sx8 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);

var pointsLateral2 = [[226.51727294921875,368.9097595214844,0],[239,357,-48],[252,346,-57.8],[266.8995666503906,335.3074035644531,-60]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

var pointsLateral1 = [[187.3293914794922,291.7502136230469,0], [209,291.9,-48],[231,291.1,-57.8],[253.835693359375,292.292236328125,-60]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));

var bL1Sx = bLateral1;
var bL2Sx = bLateral2;

var controlsContourEx8 = [[176.2087860107422,306.8954772949219,0],[174.2969970703125,309.44451904296875,0],[172.70384216308594,313.9053649902344,0],[172.70384216308594,320.59661865234375,0],[172.06658935546875,325.6947021484375,0],[170.4734344482422,329.19964599609375,0],[168.88027954101562,331.4300537109375,0],[165.05670166015625,329.5182800292969,0],[162.18902587890625,325.6947021484375,0],[157.09092712402344,307.214111328125,0],[157.09092712402344,273.75787353515625,0],[160.5958709716797,254.64002990722656,0],[161.5517578125,249.54193115234375,0],[164.73806762695312,246.35562133789062,0],[167.92437744140625,245.0811004638672,0],[170.79205322265625,244.76246643066406,0],[172.3852081298828,246.35562133789062,0],[174.61563110351562,250.8164520263672,0],[174.93426513671875,281.0863952636719,0],[175.57151794433594,282.36090087890625,0],[176.5274200439453,281.405029296875,0],[178.27565002441406,273.77783203125,0],[178.27565002441406,268.77801513671875,0],[178.68104553222656,264.8592224121094,0],[181.38365173339844,259.3188781738281,0],[184.0862579345703,256.8865051269531,0],[185.3024444580078,256.48114013671875,0],[187.5996551513672,257.0216369628906,0],[189.22122192382812,258.2378234863281,0],[190.70765686035156,260.670166015625,0],[190.84278869628906,262.1566162109375,0],[187.1942596435547,281.21002197265625,0],[186.24835205078125,289.5881042480469,0],[187.3293914794922,291.7502136230469,0],[188.2753143310547,290.6691589355469,0],[189.08609008789062,288.77734375,0],[191.11305236816406,277.8317565917969,0],[196.24801635742188,264.3186950683594,0],[198.95062255859375,260.39990234375,0],[200.8424530029297,258.5080871582031,0]]
var nubsContourEx8 = createNubs(controlsContourEx8);

var controlsRerInPart8 = [[174.9972381591797,302.60711669921875,0],[172.11949157714844,306.0244140625,0],[169.7813262939453,313.9382019042969,0],[168.70217895507812,320.7728576660156,0],[168.70217895507812,325.6290283203125,0],[168.52230834960938,326.1686096191406,0],[167.80287170410156,327.2477722167969,0],[165.82443237304688,327.4276123046875,0],[164.7452850341797,325.6290283203125,0],[160.4286651611328,306.9237060546875,0],[159.5293731689453,273.8296813964844,0],[163.12655639648438,254.94451904296875,0],[164.56541442871094,250.8077392578125,0],[165.64456176757812,248.46957397460938,0],[167.98272705078125,247.21055603027344,0],[169.42160034179688,247.92999267578125,0],[170.32089233398438,248.82928466796875,0],[171.759765625,251.70703125,0],[172.53427124023438,284.67388916015625,0],[174.05714416503906,287.5166320800781,0],[176.5952911376953,287.8211975097656,0],[178.32122802734375,286.6028747558594,0],[181.2922821044922,268.61376953125,0],[182.37144470214844,264.6568603515625,0],[183.45059204101562,262.67840576171875,0],[184.7095947265625,260.6999816894531,0],[185.78875732421875,259.4409484863281,0],[187.04776000976562,259.4409484863281,0],[187.9470672607422,259.98052978515625,0],[188.48663330078125,261.77911376953125,0],[188.12692260742188,263.03814697265625,0],[184.5297393798828,281.2038879394531,0],[183.810302734375,290.73638916015625,0],[184.10818481445312,293.81121826171875,0],[186.5447998046875,296.6539306640625,0],[189.48904418945312,296.3493347167969,0],[191.7226104736328,291.8822326660156,0],[193.95616149902344,278.5823669433594,0],[200.17745971679688,264.2971496582031,0],[201.4364776611328,263.5777282714844,0]]
var nubsRerInPart8 = createNubs(controlsRerInPart8);

var boundaryPart8 = createBezierS1([nubsContourEx8, nubsRerInPart8]);
var boundaryPart8Map = MAP(boundaryPart8)(domain2);
DRAW(COLOR(mattLightYellow)(boundaryPart8Map));

var controlsContourEx8 = [[200.8424530029297,258.5080871582031,0],[202.86941528320312,258.3729553222656,0],[204.35585021972656,258.9134826660156,0],[206.653076171875,260.39990234375,0],[208.00437927246094,261.8863525390625,0],[206.653076171875,280.26409912109375,0],[206.2476806640625,305.5335388183594,0],[207.86924743652344,316.3439636230469,0],[211.6529083251953,329.0462341308594,0],[221.24717712402344,343.37005615234375,0],[233.0035400390625,356.0723571777344,0],[245.5706787109375,365.6666259765625,0],[248.67868041992188,369.31512451171875,0],[249.35433959960938,370.93670654296875,0],[249.8948516845703,373.0987854003906,0],[249.4894561767578,375.2608947753906,0],[248.54354858398438,376.747314453125,0],[247.05711364746094,377.6932373046875,0],[245.165283203125,378.5040283203125,0],[242.86807250976562,378.5040283203125,0],[240.4357147216797,378.368896484375,0],[236.3817901611328,375.6662902832031,0],[229.76040649414062,369.1800231933594,0],[227.5983123779297,368.5043640136719,0],[226.51727294921875,368.9097595214844,0],[227.0577850341797,369.99078369140625,0],[228.27395629882812,372.15289306640625,0],[230.03065490722656,374.7203674316406,0],[231.6522216796875,377.1527099609375,0],[233.13865661621094,379.0445556640625,0],[234.48997497558594,382.1525573730469,0],[234.08457946777344,384.99029541015625,0],[233.2738037109375,386.8821105957031,0],[230.57118225097656,387.4226379394531,0],[227.3280487060547,385.93621826171875,0],[223.27413940429688,382.2876892089844,0],[219.6256103515625,377.828369140625,0],[214.8960418701172,367.5584411621094,0],[210.03134155273438,361.0721740722656,0],[204.89637756347656,357.69390869140625,0],[203.54507446289062,357.69390869140625,0],[201.6532440185547,358.09930419921875,0],[200.16680908203125,360.5316467285156,0],[200.03167724609375,362.9640197753906,0],[201.6532440185547,366.7476501464844,0],[207.3287353515625,374.8554992675781,0],[215.5717010498047,382.1525573730469,0],[230.97657775878906,389.584716796875,0],[233.81431579589844,391.206298828125,0],[235.70614624023438,393.2332458496094,0]]
var nubsContourEx8 = createNubs(controlsContourEx8);

var controlsRerInPart8 = [[201.4364776611328,263.5777282714844,0],[203.05520629882812,263.3978576660156,0],[204.1343536376953,263.757568359375,0],[204.4940643310547,264.2971496582031,0],[204.314208984375,266.0957336425781,0],[203.2350616455078,280.3045959472656,0],[203.4149169921875,305.1250915527344,0],[203.2350616455078,305.1250915527344,0],[205.0336456298828,317.1756286621094,0],[209.17041015625,330.4851989746094,0],[218.88278198242188,345.2336120605469,0],[232.1923370361328,358.3633117675781,0],[243.5234375,368.79510498046875,0],[245.322021484375,370.59368896484375,0],[246.0414581298828,372.0325622558594,0],[246.40118408203125,372.9318542480469,0],[246.40118408203125,373.1117248535156,0],[246.2213134765625,374.19085693359375,0],[246.2213134765625,375.27001953125,0],[245.86160278320312,375.8096008300781,0],[244.96231079101562,375.8096008300781,0],[242.4442901611328,375.27001953125,0],[240.64569091796875,374.19085693359375,0],[239.02696228027344,373.1117248535156,0],[231.83261108398438,367.5361022949219,0],[227.25656127929688,364.3714599609375,0],[224.45840454101562,364.4784851074219,0],[223.09400939941406,365.8943176269531,0],[223.1993865966797,370.0541076660156,0],[225.89727783203125,373.65130615234375,0],[227.15628051757812,375.44989013671875,0],[228.59515380859375,378.3276062011719,0],[228.77500915527344,378.5074768066406,0],[230.03402709960938,380.3060607910156,0],[230.39373779296875,382.2845153808594,0],[230.39373779296875,383.54351806640625,0],[229.8541717529297,383.3636779785156,0],[228.23544311523438,383.1838073730469,0],[225.7174072265625,381.3852233886719,0],[223.37925720214844,376.5290222167969,0],[230.03402709960938,380.3060607910156,0],[230.39373779296875,382.2845153808594,0],[230.39373779296875,383.54351806640625,0],[229.8541717529297,383.3636779785156,0],[228.23544311523438,383.1838073730469,0],[225.7174072265625,381.3852233886719,0],[223.37925720214844,376.5290222167969,0],[223.37925720214844,376.5290222167969,0],[217.08419799804688,366.816650390625,0],[212.5877227783203,359.9820251464844,0],[205.21351623535156,355.3056945800781,0],[203.59478759765625,354.94598388671875,0],[203.4149169921875,354.94598388671875,0],[201.7961883544922,354.94598388671875,0],[199.9976043701172,355.84527587890625,0],[197.30650329589844,357.2646484375,0],[195.88514709472656,359.9043273925781,0],[195.58056640625,363.6607666015625,0],[198.22023010253906,368.1278991699219,0],[207.05296325683594,379.60028076171875,0],[216.59637451171875,386.199462890625,0],[232.3721923828125,394.3350524902344,0]]
var nubsRerInPart8 = createNubs(controlsRerInPart8);

var boundaryPart8 = createBezierS1([nubsContourEx8, nubsRerInPart8]);
var boundaryPart8Map = MAP(boundaryPart8)(domain2);
DRAW(COLOR(mattLightYellow)(boundaryPart8Map));

var controlsContourEx8 = [[235.70614624023438,393.2332458496094,0],[236.92233276367188,396.07098388671875,0],[236.92233276367188,398.77362060546875,0],[235.57101440429688,400.5303039550781,0],[232.327880859375,403.23291015625,0],[229.62527465820312,403.3680419921875,0],[223.13900756835938,402.1518859863281,0],[210.84213256835938,394.1791687011719,0],[185.3024444580078,368.5043640136719,0],[181.65391540527344,362.8288879394531,0],[170.84347534179688,344.45111083984375,0],[169.35704040527344,339.856689453125,0],[169.49217224121094,336.0730285644531,0],[170.30294799804688,333.23529052734375,0],[171.7893829345703,331.34344482421875,0],[174.49200439453125,330.3975524902344,0],[177.32974243164062,330.3975524902344,0],[180.437744140625,331.74884033203125,0],[184.7619171142578,335.6676330566406,0],[186.78887939453125,340.126953125,0],[190.30227661132812,344.85650634765625,0],[193.1400146484375,346.61322021484375,0],[193.54541015625,345.80242919921875,0],[193.9508056640625,344.04571533203125,0],[192.32923889160156,338.0999755859375,0],[187.05914306640625,325.938232421875,0],[182.32955932617188,314.7223815917969,0],[181.11338806152344,310.938720703125,0],[180.437744140625,309.1820373535156,0],[178.95130920410156,307.8307189941406,0],[177.46485900878906,306.88482666015625,0],[176.31564331054688,306.900390625,0],[176.2087860107422,306.8954772949219,0]]
var nubsContourEx8 = createNubs(controlsContourEx8);

var controlsRerInPart8 = [[232.3721923828125,394.3350524902344,0],[232.91177368164062,395.77392578125,0],[232.5520477294922,397.2127990722656,0],[232.5520477294922,398.1120910644531,0],[231.6527557373047,399.1912536621094,0],[230.93331909179688,399.55096435546875,0],[229.67430114746094,400.0905456542969,0],[223.7389678955078,398.8315124511719,0],[212.767578125,392.5364685058594,0],[188.8463592529297,367.5361022949219,0],[185.06932067871094,362.14031982421875,0],[173.3784942626953,343.2551574707031,0],[172.29934692382812,339.83782958984375,0],[171.759765625,336.4205322265625,0],[172.29934692382812,334.44207763671875,0],[173.19863891601562,333.54278564453125,0],[175.53680419921875,332.8233337402344,0],[177.33538818359375,333.18304443359375,0],[179.3138427734375,334.26220703125,0],[181.65200805664062,337.13995361328125,0],[184.34988403320312,341.2767028808594,0],[189.79360961914062,349.4471740722656,0],[192.3317413330078,350.6654968261719,0],[194.46377563476562,350.05633544921875,0],[196.29124450683594,346.6044616699219,0],[195.88516235351562,338.7869873046875,0],[185.78875732421875,314.1180114746094,0],[183.99017333984375,309.4416809082031,0],[183.99017333984375,309.2618103027344,0],[182.7311553955078,306.7437744140625,0],[180.57286071777344,304.4056091308594,0],[177.5152587890625,302.06744384765625,0],[174.9972381591797,302.60711669921875,0]]
var nubsRerInPart8 = createNubs(controlsRerInPart8);

var boundaryPart8 = createBezierS1([nubsContourEx8, nubsRerInPart8]);
var boundaryPart8Map = MAP(boundaryPart8)(domain2);
DRAW(COLOR(mattLightYellow)(boundaryPart8Map));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);

var point = BEZIER(S1)([[285, 297, -79]]);
var closure2 = createBezierS2([Dx2, point], mattDarkOrchid);
var closure2 = createBezierS2([Sx2, point], mattDarkOrchid);
var closure2 = createBezierS2([Dx4, point], mattDarkOrchid);
var closure2 = createBezierS2([Dx6, point], mattDarkOrchid);
var closure2 = createBezierS2([Dx8, point], mattDarkOrchid);
var closure2 = createBezierS2([Sx4, point], mattDarkOrchid);
var closure2 = createBezierS2([Sx6, point], mattDarkOrchid);
var closure2 = createBezierS2([Sx8, point], mattDarkOrchid);


//---------------------------------------------------------------------------MITOCHONDRION 1-------------------------------------------------------------------



var controlsMitoBottom1 = [[278.3294677734375,92.87374877929688,0],[275.994384765625,95.2088394165039,0],[274.0653991699219,96.4271469116211,0],[271.7303161621094,97.44239807128906,0],[269.3952331542969,96.93477630615234,0],[268.07537841796875,95.91951751708984,0],[267.5677795410156,93.7874755859375,0],[268.3799743652344,91.452392578125,0],[267.8723449707031,90.4371337890625,0],[266.8570861816406,89.52339935302734,0],[265.232666015625,89.62493133544922,0],[264.11590576171875,91.85848999023438,0],[262.2884216308594,94.70121002197266,0],[261.37469482421875,96.32562255859375,0],[258.8365478515625,96.32562255859375,0],[255.58773803710938,95.61493682861328,0],[253.86180114746094,93.99053192138672,0],[253.25265502929688,92.0615463256836,0],[254.3694305419922,89.52339935302734,0],[256.1968994140625,87.59441375732422,0],[257.4151916503906,85.4623794555664,0],[257.6182556152344,83.22881317138672,0],[256.50146484375,82.21356201171875,0],[255.181640625,81.7059326171875,0],[253.3541717529297,82.51813507080078,0],[252.23739624023438,84.34559631347656,0],[251.12062072753906,85.36085510253906,0],[249.19163513183594,86.57916259765625,0],[246.6534881591797,87.39136505126953,0],[244.3184051513672,87.18831634521484,0],[242.2878875732422,85.97000885009766,0],[240.8665313720703,84.65017700195312,0],[240.56195068359375,82.21356201171875,0],[241.98330688476562,79.87847137451172,0],[244.52145385742188,77.74642944335938,0],[245.84127807617188,76.12202453613281,0],[246.34890747070312,73.88845825195312,0],[246.34890747070312,71.45184326171875,0],[244.6229705810547,70.43658447265625,0],[242.2878875732422,69.82743072509766,0],[239.34364318847656,71.24879455566406,0],[237.9222869873047,73.17778015136719,0],[235.99330139160156,74.80219268798828,0],[234.06431579589844,75.41134643554688,0],[230.71397399902344,75.10676574707031,0],[229.59718322753906,74.09150695800781,0],[227.56666564941406,71.75642395019531,0],[227.7697296142578,69.52285766601562,0],[228.988037109375,66.68013763427734,0],[230.5109100341797,64.75115203857422,0],[231.01853942871094,62.00996017456055,0],[229.59718322753906,59.57334518432617,0],[227.36361694335938,58.456565856933594,0],[224.52090454101562,57.44131088256836,0],[221.27207946777344,57.13673400878906,0],[219.546142578125,55.816898345947266,0],[218.226318359375,53.989437103271484,0],[217.2110595703125,51.34977340698242,0],[216.90647888183594,47.999427795410156,0],[217.2110595703125,44.852134704589844,0],[219.4446258544922,42.618568420410156,0],[221.88124084472656,41.19721221923828,0],[224.927001953125,41.60331344604492,0],[227.7697296142578,43.02467346191406,0],[230.1048126220703,43.02467346191406,0]];
var nubscontrolsMitoBottom1 = createNubs(controlsMitoBottom1);

var controlsMitoIn1 = [[276.0959167480469,91.55391693115234,0],[275.0806579589844,92.56916809082031,0],[273.5577697753906,93.7874755859375,0],[271.6287841796875,94.3966293334961,0],[270.81658935546875,94.1935806274414,0],[270.613525390625,93.68595123291016,0],[270.5119934082031,93.1783218383789,0],[270.613525390625,91.0462875366211,0],[270.0043640136719,89.8279800415039,0],[267.8723449707031,87.59441375732422,0],[265.1980895996094,87.59922790527344,0],[262.1410827636719,90.05345916748047,0],[260.4609680175781,93.27985382080078,0],[259.75030517578125,93.7874755859375,0],[259.03961181640625,93.7874755859375,0],[257.5167236328125,93.38137817382812,0],[256.70452880859375,92.97527313232422,0],[256.6029968261719,92.0615463256836,0],[257.212158203125,90.23408508300781,0],[258.531982421875,88.71119689941406,0],[259.851806640625,85.36085510253906,0],[259.75030517578125,82.82271575927734,0],[258.48126220703125,80.27957916259766,0],[255.58773803710938,79.26931762695312,0],[252.0343475341797,80.79219818115234,0],[250.40994262695312,82.21356201171875,0],[249.39468383789062,83.22881317138672,0],[248.27789306640625,83.73644256591797,0],[246.450439453125,84.34559631347656,0],[244.6229705810547,84.24407196044922,0],[243.50619506835938,84.14254760742188,0],[243.81077575683594,82.11203002929688,0],[244.72450256347656,80.79219818115234,0],[245.94281005859375,79.16779327392578,0],[249.3962860107422,75.75862121582031,0],[249.6546173095703,73.47660827636719,0],[249.5977325439453,70.84268951416016,0],[247.5672149658203,68.2030258178711,0],[244.95138549804688,66.7332534790039,0],[241.77523803710938,67.53477478027344,0],[236.19635009765625,71.24879455566406,0],[235.18109130859375,71.95947265625,0],[234.06431579589844,72.26404571533203,0],[232.4398956298828,72.46710205078125,0],[231.01853942871094,71.95947265625,0],[230.61244201660156,71.14727020263672,0],[230.81549072265625,69.42133331298828,0],[231.72921752929688,67.49234771728516,0],[234.26736450195312,65.66488647460938,0],[234.368896484375,61.603858947753906,0],[231.5261688232422,58.35504150390625,0],[230.0637969970703,57.41643524169922,0],[228.1758270263672,56.62910461425781,0],[224.52090454101562,55.004695892333984,0],[222.5919189453125,54.903167724609375,0],[221.67819213867188,54.39554214477539,0],[220.7644500732422,53.1772346496582,0],[219.74920654296875,51.24824523925781,0],[219.64767456054688,47.89790344238281,0],[219.64767456054688,45.46128845214844,0],[220.66293334960938,44.54755783081055,0],[222.28733825683594,44.64908218383789,0],[225.02853393554688,44.852134704589844,0],[230.4082489013672,47.599491119384766,0],[232.5610809326172,46.48001480102539,0]]
var nubsMitoIn1 = createNubs(controlsMitoIn1);
var controlsMitoIn2 = [[232.5610809326172,46.48001480102539,0],[233.96278381347656,39.77585220336914,0],[235.38414001464844,38.760597229003906,0],[236.29788208007812,39.0651741027832,0],[237.41465759277344,40.385005950927734,0],[238.12533569335938,41.90789031982422,0],[238.76126098632812,46.69527816772461,0],[241.2726287841797,48.60858154296875,0],[243.91229248046875,46.88264465332031,0],[245.33364868164062,44.852134704589844,0],[247.16111755371094,44.64908218383789,0],[248.6840057373047,44.95365905761719,0],[250.8160400390625,45.96891403198242,0],[252.8465576171875,47.18722152709961,0],[253.151123046875,48.710105895996094,0],[253.151123046875,50.23299026489258,0],[252.54197692871094,51.14672088623047,0],[252.44044494628906,51.24824523925781,0],[251.42518615722656,51.34977340698242,0],[249.5977325439453,51.65435028076172,0],[247.4656982421875,53.68486022949219,0],[247.36416625976562,55.410797119140625,0],[247.97332763671875,56.832157135009766,0],[251.72976684570312,59.67487335205078,0],[255.42422485351562,59.52619552612305,0],[258.1368103027344,59.009517669677734,0],[260.93548583984375,57.760868072509766,0],[263.6082763671875,57.33978271484375,0],[265.13116455078125,57.5428352355957,0],[266.1463928222656,58.1519889831543,0],[266.6540222167969,58.862667083740234,0],[266.9586181640625,59.97945022583008,0],[266.3494567871094,60.89318084716797,0],[265.74029541015625,61.40080642700195,0],[265.0296325683594,61.9084358215332,0],[262.4914855957031,63.53284454345703,0],[259.2132263183594,64.52078247070312,0],[256.5867614746094,65.81248474121094,0],[256.5006408691406,69.94593811035156,0],[258.9979553222656,71.58209228515625,0],[262.0980224609375,71.0223617553711,0],[265.943359375,69.31980895996094,0],[267.973876953125,69.11675262451172,0],[270.5119934082031,69.11675262451172,0],[272.5425109863281,69.31980895996094,0],[273.5577697753906,69.42133331298828,0],[273.7608337402344,69.82743072509766,0],[274.47149658203125,70.9442138671875,0],[274.0653991699219,71.85794830322266,0],[273.5577697753906,72.26404571533203,0],[272.7455749511719,72.5686264038086,0],[270.3089599609375,72.9747314453125,0],[266.8570861816406,73.27930450439453,0],[264.46612548828125,74.4238510131836,0],[263.6082763671875,78.05101013183594,0],[264.81060791015625,82.0448989868164,0],[266.96343994140625,83.76716613769531,0],[272.1302490234375,82.69075012207031,0],[274.3699951171875,82.21356201171875,0],[276.705078125,82.11203002929688,0],[278.22796630859375,82.21356201171875,0],[278.9386291503906,82.51813507080078,0],[279.3447265625,82.92424011230469,0],[279.54779052734375,83.63491821289062,0],[279.4462585449219,86.071533203125,0],[279.1416931152344,88.00051879882812,0],[277.7203369140625,90.0310287475586,0],[277.6188049316406,90.0310287475586,0],[276.0959167480469,91.55391693115234,0]];
var nubsMitoIn2 = createNubs(controlsMitoIn2);

var boundary1 = createBezierS1([nubscontrolsMitoBottom1, nubsMitoIn1]);
var boundary1Map = MAP(boundary1)(domain2);
DRAW(COLOR(mattCoralRed)(boundary1Map));

var controlsCurveLateral1 = [[278.3294677734375,92.87374877929688,0],[278.3294677734375,92.87374877929688,-5],[278.3294677734375,92.87374877929688,-10]];
var bCurveLateral1 = BEZIER(S1)(controlsCurveLateral1);
var bMapCurveLateral1 = MAP(BEZIER(S0)(controlsCurveLateral1))(domain1);

var controlsCurveLateral12 = [[230.1048126220703,43.02467346191406,0],[230.1048126220703,43.02467346191406,-5],[230.1048126220703,43.02467346191406,-10]];
var bCurveLateral12 = BEZIER(S1)(controlsCurveLateral12);
var bMapCurveLateral12 = MAP(BEZIER(S0)(controlsCurveLateral12))(domain1);

var CurveCentral1 = [[230.1048126220703,43.02467346191406,-10], [232.5397491455078,48.04398727416992,-10], [237.0068817138672,51.69890594482422,-10], [240.56027221679688,58.09502029418945,-10], [248.9868927001953,63.78045654296875,-10], [251.4235076904297,70.78572082519531,-10],[258.2257385253906,74.54216766357422,-10],[262.8959045410156,82.46116638183594,-10],[272.1347351074219,85.40541076660156,-10],[273.0484619140625,89.06033325195312,-10],[278.3294677734375,92.87374877929688,-10]];
var CurveCentralReverse1 = [[278.3294677734375,92.87374877929688,-10], [273.0484619140625,89.06033325195312,-10],[272.1347351074219,85.40541076660156,-10], [262.8959045410156,82.46116638183594,-10],[258.2257385253906,74.54216766357422,-10], [251.4235076904297,70.78572082519531,-10],[248.9868927001953,63.78045654296875,-10], [240.56027221679688,58.09502029418945,-10],[237.0068817138672,51.69890594482422,-10], [232.5397491455078,48.04398727416992,-10],[230.1048126220703,43.02467346191406,-10]];
var nubsCurveCentral1 = createNubs(CurveCentral1);
var nubsCurveCentralReverse1 = createNubs(CurveCentralReverse1);
var mapLateralSx1 = MAP(COONS_PATCH([nubscontrolsMitoBottom1,nubsCurveCentralReverse1,bCurveLateral1,bCurveLateral12]))(domain2);
DRAW(COLOR(mattCoralRed)(mapLateralSx1));


var controlsMitoBottom12 = [[230.1048126220703,43.02467346191406,0],[230.5109100341797,40.99415969848633,0],[230.5109100341797,38.760597229003906,0],[231.3231201171875,37.64381408691406,0],[231.3231201171875,37.54228973388672,0],[234.97804260253906,36.32398223876953,0],[237.11007690429688,37.03466033935547,0],[239.14059448242188,39.3697509765625,0],[239.74974060058594,41.60331344604492,0],[240.66348266601562,43.93840408325195,0],[241.78025817871094,45.15671157836914,0],[243.10009765625,44.750606536865234,0],[244.72450256347656,43.4307746887207,0],[246.95806884765625,42.618568420410156,0],[248.88705444335938,42.82162094116211,0],[251.42518615722656,44.0399284362793,0],[254.1663818359375,46.07044219970703,0],[255.9938507080078,48.4055290222168,0],[256.6029968261719,50.537567138671875,0],[255.79078674316406,51.857398986816406,0],[253.86180114746094,53.38028335571289,0],[251.42518615722656,53.989437103271484,0],[250.71450805664062,55.20774459838867,0],[251.32366943359375,56.12147521972656,0],[252.8465576171875,57.33978271484375,0],[255.3846893310547,57.5428352355957,0],[257.8213195800781,57.238258361816406,0],[260.4609680175781,55.816898345947266,0],[262.8975830078125,54.80164337158203,0],[265.232666015625,54.80164337158203,0],[267.1616516113281,55.71537399291992,0],[268.6845397949219,57.33978271484375,0],[269.49676513671875,59.370296478271484,0],[269.3952331542969,61.40080642700195,0],[268.1769104003906,62.822166442871094,0],[265.943359375,64.24352264404297,0],[263.2021484375,65.15725708007812,0],[260.4609680175781,65.86793518066406,0],[259.75030517578125,67.39081573486328,0],[259.851806640625,69.31980895996094,0],[261.9838562011719,69.72590637207031,0],[263.40521240234375,68.81217956542969,0],[265.5372619628906,67.5938720703125,0],[267.46624755859375,66.88319396972656,0],[270.3089599609375,66.37556457519531,0],[272.7455749511719,66.47708892822266,0],[274.7760925292969,67.1877670288086,0],[276.2989807128906,68.91370391845703,0],[277.4157409667969,70.74116516113281,0],[277.21270751953125,72.77167510986328,0],[276.2989807128906,74.19303894042969,0],[274.16693115234375,74.80219268798828,0],[270.7150573730469,75.20829010009766,0],[267.77081298828125,75.41134643554688,0],[266.75555419921875,76.12202453613281,0],[266.5525207519531,78.05101013183594,0],[267.26318359375,80.690673828125,0],[269.1921691894531,81.50287628173828,0],[271.6287841796875,80.48762512207031,0],[273.86236572265625,79.6754150390625,0],[276.50201416015625,78.76168823242188,0],[278.53253173828125,78.66016387939453,0],[280.2680358886719,79.44512176513672,0],[281.62908935546875,81.31655883789062,0],[282.2123718261719,83.13938903808594,0],[282.7966003417969,85.97000885009766,0],[281.88287353515625,88.40662384033203,0],[279.9538879394531,90.74170684814453,0],[278.3294677734375,92.87374877929688,0]];
var nubscontrolsMitoBottom12 = createNubs(controlsMitoBottom12);

var boundary2 = createBezierS1([nubscontrolsMitoBottom12, nubsMitoIn2]);
var boundary2Map = MAP(boundary2)(domain2);
DRAW(COLOR(mattCoralRed)(boundary2Map));

var mapLateralDx1 = MAP(COONS_PATCH([nubscontrolsMitoBottom12,nubsCurveCentral1,bCurveLateral12,bCurveLateral1]))(domain2);
DRAW(COLOR(mattCoralRed)(mapLateralDx1));


var controls1 = [[210.1256561279297,43.27913284301758,0],[215.26060485839844,38.549560546875,-50],[222.1522674560547,32.06329345703125,-50],[226.20619201660156,28.820159912109375,0]]
var controls2 = [[209.5851287841797,50.84644317626953,0],[215.53086853027344,45.441219329833984,-50],[227.5574951171875,35.03616714477539,-50],[235.3950653076172,28.685028076171875,0]]
var controls3 = [[212.28773498535156,59.35967254638672,0],[218.23348999023438,54.49496841430664,-50],[236.4761199951172,38.6846923828125,-50],[244.04342651367188,31.522769927978516,0]]
var controls4 = [[217.69296264648438,67.6026382446289,0],[221.61175537109375,63.5487174987793,-50],[247.55682373046875,40.57651901245117,-50],[252.28639221191406,35.71181869506836,0]]
var controls5 = [[223.0981903076172,75.3050765991211,0],[224.85488891601562,73.68350982666016,-50],[259.44830322265625,43.68452453613281,-50],[260.79962158203125,42.46834945678711,0]]
var controls6 = [[229.04393005371094,81.25082397460938,0],[230.93576049804688,80.03465270996094,-60],[266.47509765625,50.7113151550293,-60],[268.5020751953125,49.08974838256836,0]]
var controls7 = [[236.4761199951172,88.41275024414062,0],[239.44898986816406,86.25065612792969,-50],[272.69110107421875,59.76506423950195,-50],[275.5288391113281,57.60297393798828,0]]
var controls8 = [[243.50289916992188,94.62875366210938,0],[249.1783905029297,89.89918518066406,-50],[271.3398132324219,69.49446868896484,-50],[279.1773681640625,62.467674255371094,0]]
var controls9 = [[252.55665588378906,101.25015258789062,0],[263.2319641113281,92.87205505371094,-50],[279.1773681640625,80.03465270996094,-50],[286.87982177734375,74.08890533447266,0]]
var controls10 = [[260.52935791015625,104.4932861328125,0],[271.6100769042969,95.57466888427734,-50],[280.2584228515625,88.9532699584961,-50],[289.9878234863281,81.52108764648438,0]]
var controls11 = [[269.1777038574219,105.43920135498047,0],[278.3666076660156,98.95293426513672,-50],[282.6907653808594,95.43953704833984,-50],[288.9067687988281,89.35865783691406,0]]

var curveExMitochondrion = createCurveSurface([217.15243530273438,34.90103530883789+1,0],[281.6097412109375,97.73675537109375-1,0], [controls1, controls2, controls3, controls4, controls5, controls6, controls7, controls8, controls9, controls10, controls11]);
DRAW(COLOR(mattBurgundy)(MAP(curveExMitochondrion)(domain3)));

var controls12 = [[213.774169921875,44.49530792236328,0],[217.28756713867188,40.30625915527344,-15],[220.26043701171875,37.06312561035156,-15],[223.50357055664062,33.95512008666992,0]]
var controls13 = [[213.774169921875,51.386966705322266,0],[218.7740020751953,46.25200271606445,-15],[224.58462524414062,39.49547576904297,-15],[232.4221954345703,32.06329345703125,0]]
var controls14 = [[216.34165954589844,58.684017181396484,0],[221.7468719482422,52.73827362060547,-15],[231.07089233398438,42.873741149902344,-15],[239.58412170410156,33.81999206542969,0]]
var controls15 = [[221.20635986328125,65.84593963623047,0],[225.39540100097656,60.981239318847656,-15],[238.77333068847656,46.79252624511719,-15],[247.42169189453125,37.87390899658203,0]]
var controls16 = [[225.53053283691406,71.92681884765625,0],[229.04393005371094,68.54855346679688,-15],[252.55665588378906,45.711483001708984,-15],[254.85386657714844,43.41426086425781,0]]
var controlss1 = [[232.1519317626953,79.08873748779297,0],[233.63836669921875,78.0076904296875,-15],[262.01580810546875,50.84644317626953,-15],[263.2319641113281,49.76539993286133,0]]
var controlss2 = [[237.28689575195312,83.81830596923828,0],[240.9354248046875,80.3049087524414,-15],[264.8535461425781,57.73810577392578,-15],[268.2318115234375,55.035491943359375,0]]
var controlss3 = [[243.90829467773438,89.35865783691406,0],[249.0432586669922,84.08856964111328,-15],[267.9615478515625,65.98107147216797,-15],[273.23162841796875,61.11636734008789,0]]
var controlss4 = [[250.12429809570312,95.03414916992188,0],[258.6375427246094,87.19657135009766,-15],[272.01544189453125,74.22403717041016,-15],[278.0963439941406,68.27828979492188,0]]
var controlss5 = [[257.1510925292969,98.81780242919922,0],[265.1238098144531,91.6558837890625,-15],[275.12347412109375,82.06160736083984,-15],[283.3664245605469,75.16995239257812,0]]
var controlss6 = [[264.0427551269531,100.84475708007812,0],[270.6641540527344,94.49362182617188,-15],[277.0152893066406,87.87222290039062,-15],[285.39337158203125,80.3049087524414,0]]
var controlss7 = [[269.4479675292969,101.38528442382812,0],[276.0693664550781,95.03414916992188,-15],[278.5017395019531,92.60179138183594,-15],[285.93389892578125,85.57500457763672,0]]

var curveInMitochondrion = createCurveSurface([217.42269897460938,38.414432525634766+1,0],[278.6368408203125,95.16927337646484-1,0], [controls12, controls13, controls14, controls15, controls16, controlss1, controlss2, controlss3, controlss4, controlss5, controlss6, controlss7]);
createBezierS2([curveExMitochondrion, curveInMitochondrion], mattBurgundy);

//---------------------------------------------------------------------------MITOCHONDRION 2-------------------------------------------------------------------

var controlsMitoIn21 = [[275.30682373046875,187.46266174316406,0],[273.8854675292969,185.22909545898438,0],[272.97174072265625,183.7062225341797,0],[272.56561279296875,182.2848663330078,0],[272.3625793457031,180.86349487304688,0],[272.3625793457031,179.84825134277344,0],[272.6671447753906,179.3406219482422,0],[273.4793701171875,179.442138671875,0],[273.783935546875,179.94976806640625,0],[274.49462890625,180.3558807373047,0],[277.23687744140625,181.8302764892578,0],[279.6438293457031,182.1741180419922,0],[281.4776916503906,180.51217651367188,0],[281.1953125,178.2238311767578,0],[279.97698974609375,175.58416748046875,0],[279.4693603515625,174.26434326171875,0],[278.8602294921875,173.04603576660156,0],[278.35260009765625,171.62466430664062,0],[278.8602294921875,170.5078887939453,0],[279.0632629394531,170.20330810546875,0],[279.4693603515625,170.00025939941406,0],[280.3830871582031,170.20330810546875,0],[281.9059753417969,171.11705017089844,0],[283.32733154296875,172.5384063720703,0],[285.6624450683594,174.16281127929688,0],[289.21435546875,174.60939025878906,0],[292.19439697265625,174.32284545898438,0],[293.6829528808594,171.82772827148438,0],[292.5382385253906,169.10777282714844,0],[290.9336242675781,167.27389526367188,0],[288.606689453125,164.41635131835938,0],[288.09906005859375,162.9949951171875,0],[287.7944641113281,161.57363891601562,0],[288.09906005859375,160.8629608154297,0],[288.8097229003906,160.55838012695312,0],[289.5204162597656,160.55838012695312,0],[290.76458740234375,160.96766662597656,0],[291.96148681640625,161.80874633789062,0],[292.6084899902344,162.3263397216797,0],[293.47991943359375,162.69041442871094,0],[294.79974365234375,163.70567321777344,0],[295.7134704589844,164.61940002441406,0],[298.2516174316406,166.2438201904297,0],[298.3531188964844,166.3453369140625,0],[300.78973388671875,166.44686889648438,0],[303.312255859375,165.49732971191406,0],[304.8595886230469,163.26229858398438,0],[304.4446716308594,160.15228271484375,0],[302.82025146484375,158.12176513671875,0],[301.9065246582031,156.09124755859375,0],[300.5867004394531,154.0607452392578,0],[300.18060302734375,153.14700317382812,0],[300.18060302734375,152.33480834960938,0],[300.0790710449219,152.33480834960938,0],[300.2821350097656,151.4210662841797,0],[300.78973388671875,151.218017578125,0],[301.50042724609375,151.218017578125,0],[302.4141540527344,151.4210662841797,0],[303.6324768066406,152.1317596435547,0],[304.4446716308594,152.84243774414062,0],[305.1553649902344,153.55311584472656,0],[306.3736572265625,154.3653106689453,0],[309.55889892578125,157.13027954101562,0],[313.45587158203125,157.93260192871094,0],[315.1048583984375,157.00498962402344,0],[316.32318115234375,153.95921325683594,0],[314.20086669921875,150.8263397216797,0],[312.59625244140625,148.70591735839844,0],[311.8560485839844,147.46157836914062,0],[311.55145263671875,145.43106079101562,0],[311.55145263671875,144.517333984375,0],[311.95758056640625,143.80665588378906,0],[312.769775390625,143.60360717773438,0],[313.58197021484375,143.90817260742188,0],[314.1911315917969,144.41580200195312,0],[314.29266357421875,144.41580200195312,0],[314.4956970214844,144.92343139648438,0],[315.0605163574219,146.52818298339844,0],[318.0978698730469,150.2532501220703,0],[322.8544616699219,150.5970916748047,0],[325.37603759765625,149.96670532226562,0],[325.66351318359375,147.56309509277344,0],[325.56201171875,145.7356414794922,0],[325.05438232421875,144.21275329589844,0],[324.5467529296875,142.18223571777344,0],[324.851318359375,140.2532501220703,0],[325.05438232421875,140.05020141601562,0],[325.8665771484375,140.1517333984375,0],[327.38946533203125,141.4715576171875,0],[329.6230163574219,143.60360717773438,0],[331.6535339355469,146.34478759765625,0]];
var nubsMitoIn21 = createNubs(controlsMitoIn21);

var controlsMitoIn22 = [[331.6535339355469,146.34478759765625,0],[333.78558349609375,149.0859832763672,0],[335.8160705566406,152.0302276611328,0],[336.12066650390625,153.75616455078125,0],[336.12066650390625,155.279052734375,0],[335.9781188964844,156.27064514160156,0],[335.613037109375,157.00498962402344,0],[335.0038757324219,158.22328186035156,0],[334.39471435546875,158.12176513671875,0],[332.6687927246094,157.91871643066406,0],[331.04437255859375,157.00498962402344,0],[329.2169189453125,155.88819885253906,0],[326.4757385253906,155.279052734375,0],[322.82080078125,157.6141357421875,0],[322.7192687988281,157.6141357421875,0],[321.8055419921875,161.1675262451172,0],[322.31317138671875,164.2133026123047,0],[323.1253967285156,166.3453369140625,0],[323.32843017578125,167.96974182128906,0],[323.2268981933594,169.79721069335938,0],[323.2268981933594,171.42161560058594,0],[322.9223327636719,171.82772827148438,0],[322.2116394042969,172.13229370117188,0],[320.3841857910156,172.23382568359375,0],[320.28265380859375,172.33534240722656,0],[319.1658935546875,171.62466430664062,0],[317.8460388183594,170.9139862060547,0],[316.7292785644531,170.00025939941406,0],[312.6682434082031,168.3758544921875,0],[310.53619384765625,169.39111328125,0],[310.028564453125,172.63992309570312,0],[311.0438232421875,175.8887481689453,0],[312.05908203125,177.9192657470703,0],[312.05908203125,178.62994384765625,0],[311.6529846191406,179.74671936035156,0],[311.3484191894531,180.3558807373047,0],[310.7392578125,180.6604461669922,0],[309.5209655761719,180.96502685546875,0],[307.7950134277344,180.96502685546875,0],[306.67822265625,180.6604461669922,0],[305.7644958496094,179.84825134277344,0],[302.9683837890625,176.78712463378906,0],[300.5041198730469,176.27134704589844,0],[297.6960144042969,176.84442138671875,0],[294.2574768066406,179.02215576171875,0],[293.5124816894531,182.1168212890625,0],[297.13482666015625,185.22909545898438,0],[298.65771484375,186.6504669189453,0],[298.65771484375,187.25961303710938,0],[298.2516174316406,187.76724243164062,0],[297.84552001953125,188.0718231201172,0],[297.2363586425781,187.9702911376953,0],[296.7287292480469,187.76724243164062,0],[296.11956787109375,186.853515625,0],[295.10430908203125,186.0413055419922,0],[293.07379150390625,184.41690063476562,0],[290.2310791015625,184.21385192871094,0],[288.40362548828125,184.21385192871094,0],[285.8330993652344,185.2114715576172,0],[284.22845458984375,187.2745819091797,0],[284.34259033203125,190.91453552246094,0],[284.2410583496094,192.0313262939453,0],[283.9364929199219,192.5389404296875,0],[283.32733154296875,192.64047241210938,0],[282.31207275390625,192.64047241210938,0],[280.5861511230469,191.82826232910156,0],[278.2510681152344,190.60995483398438,0],[276.1190185546875,188.68096923828125,0],[276.1190185546875,188.68096923828125,0],[275.30682373046875,187.46266174316406,0]];
var nubsMitoIn22 = createNubs(controlsMitoIn22);

var controlsMitoBottom = [[273.6848449707031,190.0278778076172,0],[272.7711181640625,188.50498962402344,0],[271.2525329589844,186.06837463378906,0],[271.24822998046875,186.06837463378906,0],[270.5375671386719,184.13938903808594,0],[270.0299377441406,182.6165008544922,0],[269.725341796875,180.99209594726562,0],[269.5223083496094,178.45394897460938,0],[270.1314392089844,176.72801208496094,0],[271.55279541015625,176.2203826904297,0],[273.27874755859375,176.32191467285156,0],[274.3955383300781,177.2356414794922,0],[275.91839599609375,178.0478515625,0],[277.64434814453125,178.75852966308594,0],[278.3550109863281,179.2661590576172,0],[278.65960693359375,177.64175415039062,0],[278.0504455566406,176.32191467285156,0],[276.5275573730469,175.20513916015625,0],[275.7153625488281,173.4792022705078,0],[275.61383056640625,171.4486846923828,0],[275.4107666015625,169.62123107910156,0],[276.0199279785156,168.40292358398438,0],[277.7458801269531,167.4891815185547,0],[280.0809631347656,167.2861328125,0],[282.4160461425781,168.19985961914062,0],[284.4465637207031,169.92579650878906,0],[286.1724853515625,171.5502166748047,0],[287.7969055175781,172.05784606933594,0],[289.1167297363281,171.75326538085938,0],[290.03045654296875,170.5349578857422,0],[289.8274230957031,169.21511840820312,0],[288.6091003417969,167.59071350097656,0],[286.4770812988281,164.84951782226562,0],[285.36029052734375,163.52969360351562,0],[284.4465637207031,161.39764404296875,0],[284.8526611328125,159.7732391357422,0],[286.57861328125,158.3518829345703,0],[287.8984375,157.03204345703125,0],[290.03045654296875,156.72747802734375,0],[291.75640869140625,156.72747802734375,0],[292.9747009277344,157.94578552246094,0],[294.2945556640625,159.26560974121094,0],[295.81744384765625,161.09307861328125,0],[297.13726806640625,162.20985412597656,0],[298.3555603027344,163.52969360351562,0],[300.2845458984375,163.63121032714844,0],[301.6044006347656,162.9205322265625,0],[301.50286865234375,160.48391723632812,0],[301.0967712402344,158.45339965820312,0],[299.77691650390625,156.82899475097656,0],[297.8479309082031,155.0015411376953,0],[296.629638671875,153.9862823486328,0],[295.7159118652344,152.0572967529297,0],[295.81744384765625,149.11305236816406,0],[297.3403015136719,147.6916961669922,0],[299.6754150390625,146.87948608398438,0],[302.51812744140625,147.08253479003906,0],[304.54864501953125,147.6916961669922,0],[305.86846923828125,149.0115203857422,0],[307.0867614746094,151.0420379638672,0],[308.4066162109375,152.66644287109375,0],[310.031005859375,154.29086303710938,0],[311.7569580078125,155.20458984375,0],[313.27984619140625,154.69696044921875,0],[313.4828796386719,153.47865295410156,0],[312.3661193847656,151.34661865234375,0],[310.74169921875,149.11305236816406,0],[309.421875,147.793212890625,0],[308.50811767578125,145.5596466064453,0],[308.6096496582031,143.83372497558594,0],[309.0157470703125,142.00625610351562,0],[310.74169921875,140.48336791992188,0],[313.58441162109375,140.0772705078125,0],[315.91949462890625,141.49862670898438,0],[317.3408508300781,143.4276123046875,0],[317.7469482421875,145.35659790039062,0],[319.0668029785156,147.08253479003906,0],[320.99578857421875,147.9962615966797,0],[322.9247741699219,148.6054229736328,0],[323.63543701171875,147.28558349609375,0],[323.63543701171875,145.76271057128906,0],[322.9247741699219,144.34133911132812,0],[321.7064514160156,142.412353515625,0],[321.1988220214844,139.2650604248047,0],[322.4171447753906,137.031494140625,0],[324.9552917480469,136.42234802246094,0],[328.40716552734375,138.35133361816406,0],[331.1483459472656,141.39710998535156,0],[333.9910583496094,143.83372497558594,0]];
var nubscontrolsMitoBottom = createNubs(controlsMitoBottom);

var boundary1Mito2 = createBezierS1([nubsMitoIn21, nubscontrolsMitoBottom]);
var boundary1Mito2Map = MAP(boundary1Mito2)(domain2);
DRAW(COLOR(mattCoralRed)(boundary1Mito2Map));

var controlsCurveLateral = [[273.6848449707031,190.0278778076172,0],[273.6848449707031,190.0278778076172,-8],[273.6848449707031,190.0278778076172,-10]];
var bCurveLateral = BEZIER(S1)(controlsCurveLateral);
var bMapCurveLateral = MAP(BEZIER(S0)(controlsCurveLateral))(domain1);

var controlsCurveLateral2 = [[333.9910583496094,143.83372497558594,0],[333.9910583496094,143.83372497558594,-8],[333.9910583496094,143.83372497558594,-10]];
var bCurveLateral2 = BEZIER(S1)(controlsCurveLateral2);
var bMapCurveLateral2 = MAP(BEZIER(S0)(controlsCurveLateral2))(domain1);

var CurveCentral = [[333.9910583496094,143.83372497558594,-10],[330.0475769042969,147.69461059570312,-10],[328.626220703125,151.55258178710938,-10],[323.245361328125,153.07546997070312,-10],[318.8797607421875,158.15174865722656,-10],[312.1790771484375,162.31430053710938,-10],[309.4378662109375,165.56312561035156,-10],[302.22955322265625,170.33482360839844,-10],[302.0265197753906,170.33482360839844,-10],[293.8029479980469,176.2233123779297,-10],[285.47784423828125,179.87823486328125,-10],[278.9801940917969,186.57891845703125,-1],[273.6848449707031,190.0278778076172,-10]];
var CurveCentralReverse = [[273.6848449707031,190.0278778076172,-10], [278.9801940917969,186.57891845703125,-10],[285.47784423828125,179.87823486328125,-10],[293.8029479980469,176.2233123779297,-10],[302.0265197753906,170.33482360839844,-10],[302.22955322265625,170.33482360839844,-10],[309.4378662109375,165.56312561035156,-10],[312.1790771484375,162.31430053710938,-10],[318.8797607421875,158.15174865722656,-10],[323.245361328125,153.07546997070312,-10],[328.626220703125,151.55258178710938,-10],[330.0475769042969,147.69461059570312,-10],[333.9910583496094,143.83372497558594,-10]];
var nubsCurveCentral = createNubs(CurveCentral);
var nubsCurveCentralReverse = createNubs(CurveCentralReverse);

var mapLateralSx = MAP(COONS_PATCH([nubscontrolsMitoBottom,nubsCurveCentralReverse,bCurveLateral,bCurveLateral2]))(domain2);
DRAW(COLOR(mattCoralRed)(mapLateralSx));

var controlsMitoBottom2 = [[333.9910583496094,143.83372497558594,0],[336.42767333984375,147.793212890625,0],[338.15362548828125,150.8389892578125,0],[339.2703857421875,153.78323364257812,0],[338.9658203125,155.61068725585938,0],[338.3566589355469,158.25035095214844,0],[336.6307373046875,160.7884979248047,0],[335.10784912109375,161.49917602539062,0],[332.36663818359375,161.49917602539062,0],[329.8285217285156,159.7732391357422,0],[327.7980041503906,158.3518829345703,0],[326.4781799316406,158.04730224609375,0],[324.9552917480469,159.26560974121094,0],[324.65069580078125,161.39764404296875,0],[325.36138916015625,163.83425903320312,0],[326.68121337890625,165.66172790527344,0],[326.9858093261719,167.99681091308594,0],[326.5796813964844,170.02732849121094,0],[326.4781799316406,172.4639434814453,0],[324.34613037109375,174.39292907714844,0],[323.02630615234375,175.0020751953125,0],[320.1835632324219,175.40818786621094,0],[317.95001220703125,174.697509765625,0],[316.5286560058594,172.8700408935547,0],[314.90423583984375,171.24563598632812,0],[312.9752502441406,170.23037719726562,0],[312.0615234375,170.94105529785156,0],[312.1630554199219,172.8700408935547,0],[313.6859436035156,175.0020751953125,0],[314.90423583984375,177.13412475585938,0],[315.411865234375,178.55548095703125,0],[314.7012023925781,181.1951446533203,0],[312.9752502441406,182.81954956054688,0],[311.6554260253906,183.5302276611328,0],[309.6249084472656,183.83480834960938,0],[306.9852600097656,183.73329162597656,0],[304.7516784667969,182.71803283691406,0],[303.53338623046875,181.1951446533203,0],[302.3150634765625,179.57073974609375,0],[300.0815124511719,178.65699768066406,0],[298.15252685546875,178.96157836914062,0],[296.9342041015625,180.2814178466797,0],[297.0357360839844,182.4134521484375,0],[299.269287109375,183.83480834960938,0],[301.50286865234375,185.35769653320312,0],[303.53338623046875,186.16990661621094,0],[303.83795166015625,187.69277954101562,0],[302.7211608886719,188.9110870361328,0],[301.0967712402344,190.3324432373047,0],[298.8631896972656,190.84007263183594,0],[296.629638671875,190.63702392578125,0],[294.09149169921875,189.8248291015625,0],[291.9594421386719,188.09889221191406,0],[290.3350524902344,186.88058471679688,0],[288.5075988769531,186.779052734375,0],[287.187744140625,187.38821411132812,0],[286.68011474609375,189.0126190185547,0],[287.7969055175781,190.9416046142578,0],[287.69537353515625,193.07363891601562,0],[287.0862121582031,195.10415649414062,0],[285.5633544921875,196.22093200683594,0],[283.02520751953125,196.42398071289062,0],[279.3702697753906,194.90110778808594,0],[277.33978271484375,193.1751708984375,0],[273.6848449707031,190.0278778076172,0]];
var nubscontrolsMitoBottom2 = createNubs(controlsMitoBottom2);

var boundary2Mito2 = createBezierS1([nubsMitoIn22, nubscontrolsMitoBottom2]);
var boundary2Mito2Map = MAP(boundary2Mito2)(domain2);
DRAW(COLOR(mattCoralRed)(boundary2Mito2Map));

var mapLateralDx = MAP(COONS_PATCH([nubscontrolsMitoBottom2,nubsCurveCentral,bCurveLateral2,bCurveLateral,]))(domain2);
DRAW(COLOR(mattCoralRed)(mapLateralDx));

var p1 = createControls([[320.8990478515625-5,127.97230529785156,0],[329.17254638671875,134.98680114746094,0],[335.82733154296875,141.82142639160156,0],[344.6404113769531+5,150.09494018554688,0]], -50)
var p2 = createControls([[313.8845520019531-5,132.1090545654297,0],[320.5393371582031,138.58396911621094,0],[333.66900634765625,151.5338134765625,0],[343.38140869140625+5,160.886474609375,0]], -50)
var p3 = createControls([[303.6325988769531-5,137.50482177734375,0],[307.5894775390625,142.3610076904297,0],[329.8919982910156,164.483642578125,0],[335.4676208496094+5,170.4189910888672,0]], -50)
var p4 = createControls([[289.6036071777344-5,146.4977569580078,0],[293.2007751464844,150.27479553222656,0],[320.5393371582031,179.23207092285156,0],[322.87750244140625+5,181.390380859375,0]], -60)
var p5 = createControls([[277.73291015625-5,156.38999938964844,0],[284.3876953125,163.94407653808594,0],[305.97076416015625,184.8076934814453,0],[310.6470947265625+5,189.66387939453125,0]], -50)
var p6 = createControls([[270.35870361328125-5,166.82180786132812,0],[278.0926513671875,176.89390563964844,0],[291.04248046875,190.56317138671875,0],[296.9778137207031+5,198.29710388183594,0]], -50)
var p7 = createControls([[265.1427917480469-5,177.97305297851562+7,0],[271.7975769042969,187.32571411132812+7,0],[275.934326171875,191.8221893310547+7,0],[284.9272766113281+5,200.45541381835938+7,0]], -50)
var curveExMitochondrion2 = createCurveSurface([337.446044921875,135.16665649414062+2,0],[270.53857421875,189+7,0], [p1, p2, p3, p4, p5, p6 ,p7]);
DRAW(COLOR(mattBurgundy)(MAP(curveExMitochondrion2)(domain3)));

var p8 = createControls([[321.0788879394531-5,131.56947326660156,0],[328.453125,136.60552978515625,0],[334.7481689453125,141.2818603515625,0],[341.5827941894531+5,147.21719360351562,0]], -15)
var p9 = createControls([[313.52484130859375-5,134.4472198486328,0],[319.999755859375,139.6631317138672,0],[332.23016357421875,150.99423217773438,0],[340.1439514160156+5,158.36843872070312,0]], -15)
var p10 = createControls([[304.5318908691406-5,139.48326110839844,0],[309.9276428222656,145.7783203125,0],[327.9135437011719,163.22463989257812,0],[332.9495849609375+5,168.44053649902344,0]], -15)
var p11 = createControls([[291.2223205566406-5,148.29635620117188,0],[295.3591003417969,152.97268676757812,0],[317.3018798828125,175.81475830078125,0],[320.3594665527344+5,178.69248962402344,0]], -15)
var p12 = createControls([[282.589111328125-5,156.21014404296875,0],[288.16473388671875,165.2030792236328,0],[303.27288818359375,181.390380859375,0],[308.66864013671875+5,187.50558471679688,0]], -15)
var p13 = createControls([[273.95587158203125-5,165.74266052246094,0],[280.0710754394531,178.33277893066406,0],[288.3446044921875,187.86529541015625,0],[295.1792297363281+5,195.0596466064453,0]], -15)
var p14 = createControls([[268.3802490234375-5,179.05221557617188+7,0],[275.7544860839844,187.14585876464844+7,0],[277.5530700683594,189.84375+7,0],[284.9272766113281+5,197.57766723632812+7,0]], -15)
var curveInMitochondrion2 = createCurveSurface([333.66900634765625,137.50482177734375+1.5,0],[273.2364501953125,188+7,0], [p8, p9, p10, p11, p12, p13, p14]);
createBezierS2([curveExMitochondrion2, curveInMitochondrion2], mattBurgundy);



//---------------------------------------------------BIG LYSOSOME BETWEEN MITOCHONDRION1 AND GOLGI--------------------------------------------------------------------------------------

var controls31 = [[375.7725524902344,91.51885223388672,0],[380.6543273925781,91.36629486083984,-4],[386.6802673339844,91.21373748779297,-4],[392.24853515625,91.2900161743164,0]]
var controls32 = [[370.3568420410156,94.7225112915039,0],[378.21343994140625,94.49368286132812,-10],[388.51092529296875,94.41740417480469,-10],[398.1982116699219,94.56996154785156,0]]
var controls33 = [[367.1531677246094,98.68895721435547,0],[376.0776672363281,98.68895721435547,-15],[390.79925537109375,98.30756378173828,-15],[402.6985778808594,98.7652359008789,0]]
var controls34 = [[363.7206726074219,104.2572250366211,0],[373.10284423828125,104.18094635009766,-18],[392.6299133300781,103.87583923339844,-18],[405.5971374511719,103.64700317382812,0]]
var controls35 = [[362.5765075683594,109.97805786132812,0],[369.59405517578125,109.82550048828125,-20],[396.8251953125,109.13899993896484,-20],[407.42779541015625,109.13899993896484,0]]
var controls36 = [[362.3476867675781,115.1649398803711,0],[372.7977294921875,114.93610382080078,-18],[392.55364990234375,114.40216064453125,-18],[407.50408935546875,114.47843933105469,0]]
var controls37 = [[364.40716552734375,122.64015197753906,0],[375.4674377441406,122.2587661743164,-15],[390.9518127441406,122.18248748779297,-15],[404.3004150390625,123.25037384033203,0]]
var controls38 = [[368.8312683105469,128.51353454589844,0],[378.3659973144531,128.74237060546875,-10],[388.8160400390625,128.74237060546875,-10],[399.113525390625,129.27630615234375,0]]
var controls39 = [[374.0181579589844,132.40370178222656,0],[380.1203918457031,132.93763732910156,-4],[387.44305419921875,132.86135864257812,-4],[392.7062072753906,133.013916015625,0]]


var curveExLYSOSOME = createCurveSurface([383.7054443359375,90.45096588134766+0.5,0],[383.7817077636719,134.23435974121094-0.9,0], [controls31, controls32, controls33, controls34, controls35, controls36, controls37, controls38, controls39]);
DRAW(COLOR(mattGold)(MAP(curveExLYSOSOME)(domain3)));

var controlli40 = [[378.6711120605469,94.56996154785156,0],[383.32403564453125,94.56996154785156,-4],[388.0532531738281,94.49368286132812,-4],[392.6299133300781,94.49368286132812,0]]
var controlli41 = [[371.95867919921875,98.23128509521484,0],[381.11199951171875,98.00245666503906,-10],[390.18902587890625,97.69734191894531,-10],[397.5116882324219,97.69734191894531,0]]
var controlli42 = [[368.44989013671875,102.50283813476562,0],[377.9083251953125,102.1977310180664,-15],[393.08758544921875,102.12145233154297,-15],[401.4781494140625,102.42655944824219,0]]
var controlli43 = [[365.7038879394531,110.13060760498047,0],[374.8572082519531,109.59666442871094,-18],[396.0624084472656,109.44410705566406,-18],[404.3766784667969,109.74922180175781,0]]
var controlli44 = [[366.8480529785156,119.20765686035156,0],[377.298095703125,118.90254211425781,-15],[393.2401428222656,118.74999237060547,-15],[403.38507080078125,119.05509948730469,0]]
var controlli45 = [[370.9670715332031,125.4624252319336,0],[380.806884765625,125.15731811523438,-10],[390.7229919433594,124.92848205566406,-10],[399.41864013671875,125.15731811523438,0]]
var controlli46 = [[377.9083251953125,130.191650390625,0],[383.32403564453125,130.11537170410156,-4],[388.3583679199219,129.9628143310547,-4],[392.8587646484375,129.88653564453125,0]]

var curveINLYSOSOME = createCurveSurface([385.5361022949219,93.27323913574219+1,0],[385.91748046875,131.41209411621094-1,0], [controlli40, controlli41,controlli42, controlli43, controlli44, controlli45, controlli46]);


createBezierS2([curveINLYSOSOME, curveExLYSOSOME], mattLightYellow)


//-------------------------------------------------------------SMALL LYSOSOME BETWEEN MITOCHONDRION1 AND GOLGI----------------------------------------------------------------------------

var controls47 = [[321.4823913574219,90.77963256835938,0],[325.32208251953125,90.55039978027344,-2],[330.0213623046875,90.43578338623047,-2],[333.6318054199219,90.43578338623047,0]]
var controls48 = [[317.3561706542969,93.93160247802734,0],[323.25897216796875,93.75968170166016,-5],[331.8552551269531,93.75968170166016,-5],[337.35687255859375,93.75968170166016,0]]
var controls49 = [[315.2930603027344,97.59935760498047,0],[320.794677734375,97.48473358154297,-8],[334.26220703125,97.48473358154297,-8],[339.9357604980469,97.48473358154297,0]]
var controls50 = [[314.2615051269531,102.01211547851562,0],[316.95501708984375,101.95480346679688,-13],[336.9557189941406,101.66825866699219,-13],[340.8526916503906,101.78288269042969,0]]
var controls51 = [[315.4649963378906,106.53948974609375,0],[320.96661376953125,106.65410614013672,-8],[334.491455078125,106.31025695800781,-8],[339.9357604980469,106.25294494628906,0]]
var controls52 = [[318.1011962890625,111.18148040771484,0],[323.3735656738281,111.46802520751953,-5],[332.37103271484375,111.2387924194336,-5],[337.0703125,111.35340881347656,0]]
var controls53 = [[322.2274169921875,113.81768035888672,0],[325.32208251953125,113.81768035888672,-2],[330.30792236328125,113.70306396484375,-2],[333.34527587890625,113.645751953125,0]]

var curveExSmallLYSOSOME1 = createCurveSurface([327.7290344238281,89.92000579833984+0.4,0],[328.5886535644531,114.04691314697266,0], [controls47, controls48, controls49, controls50, controls51, controls52, controls53]);
DRAW(COLOR(mattGold)(MAP(curveExSmallLYSOSOME1)(domain3)));

var controls54 = [[323.07818603515625,94.1949462890625,0],[327.08978271484375,94.25225067138672,-2],[329.03826904296875,94.25225067138672,-2],[333.107177734375,94.1949462890625,0]]
var controls55 = [[319.5823669433594,98.20654296875,0],[324.6255187988281,97.91999816894531,-6],[331.6744689941406,97.80538177490234,-6],[336.8895568847656,97.8626937866211,0]]
var controls56 = [[319.1239013671875,102.10352325439453,0],[322.10394287109375,101.98890686035156,-10],[334.6545104980469,101.8742904663086,-10],[337.6918640136719,101.8742904663086,0]]
var controls57 = [[320.2700500488281,106.6882095336914,0],[324.79742431640625,106.45897674560547,-6],[331.6744689941406,106.22974395751953,-6],[336.94683837890625,106.17243194580078,0]]
var controls58 = [[323.70855712890625,110.52788543701172,0],[327.20440673828125,110.41326904296875,-2],[329.4394226074219,110.41326904296875,-2],[333.27911376953125,110.29865264892578,0]]

var curveInSmallLYSOSOME1 = createCurveSurface([328.2359619140625,93.27800750732422+0.4,0],[328.4651794433594,110.9863510131836-0.2,0], [controls54, controls55, controls56, controls57, controls58]);

createBezierS2([curveExSmallLYSOSOME1, curveInSmallLYSOSOME1], mattLightYellow);

//---------------------------------------------------------BIG LYSOSOME UNDER GOLGI-------------------------------------------------------------------------------------------

var controls54 = [[514.4879760742188,298.7884521484375,0],[522.4208374023438,298.48333740234375,-4],[527.531494140625,298.4070739746094,-4],[534.77783203125,298.48333740234375,0]]
var controls55 = [[509.2248229980469,302.7548828125,0],[520.2088012695312,302.3735046386719,-8],[530.1249389648438,302.1446838378906,-8],[539.1256713867188,302.0683898925781,0]]
var controls56 = [[505.4872131347656,308.24688720703125,0],[516.3948974609375,308.0943298339844,-13],[534.0150756835938,307.8655090332031,-13],[543.7023315429688,307.7892150878906,0]]
var controls57 = [[503.1988830566406,316.5611572265625,0],[510.6741027832031,316.33233642578125,-15],[539.9647216796875,316.25604248046875,-15],[545.9906616210938,316.25604248046875,0]]
var controls58 = [[505.94488525390625,327.16375732421875,0],[516.2423706054688,326.7060852050781,-13],[534.0150756835938,326.0958557128906,-13],[544.083740234375,326.01959228515625,0]]
var controls59 = [[510.82666015625,332.65576171875,0],[520.4376220703125,332.35064697265625,-8],[530.5062866210938,332.0455322265625,-8],[539.6596069335938,332.1217956542969,0]]
var controls60 = [[516.7763061523438,336.1645202636719,0],[522.1920166015625,336.0882568359375,-4],[527.8365478515625,335.9356994628906,-4],[533.9387817382812,335.78314208984375,0]]

var curveExBigLYSOSOMEUnderGolgi = createCurveSurface([524.7091674804688,297.4917297363281,0],[525.2431640625,336.6984558105469,0], [controls54, controls55, controls56, controls57, controls58, controls59, controls60]);
DRAW(COLOR(mattGold)(MAP(curveExBigLYSOSOMEUnderGolgi)(domain3)));

var controls61 = [[516.8480834960938,301.72686767578125,0],[522.5689086914062,301.65057373046875,-1],[526.916748046875,301.65057373046875,-1],[533.3240966796875,301.5743103027344,0]]
var controls62 = [[510.9747009277344,306.6849060058594,0],[518.5261840820312,306.3797912597656,-3],[531.493408203125,306.1509704589844,-3],[539.8839721679688,305.9984130859375,0]]
var controls63 = [[507.4659423828125,317.13494873046875,0],[511.73748779296875,317.0586853027344,-8],[539.8076782226562,316.4484558105469,-8],[543.2401733398438,316.4484558105469,0]]
var controls64 = [[510.7458801269531,327.50872802734375,0],[518.6024780273438,327.50872802734375,-3],[532.2561645507812,327.3561706542969,-3],[540.2653198242188,327.3561706542969,0]]
var controls65 = [[517.2294921875,333.4583740234375,0],[523.4842529296875,333.4583740234375,-1],[527.5269775390625,333.4583740234375,-1],[533.09521484375,333.4583740234375,0]]

var curveInBigLYSOSOMEUnderGolgi = createCurveSurface([524.8572387695312,300.277587890625+0.7,0],[525.4674682617188,334.6025390625-0.7,0], [controls61, controls62, controls63, controls64, controls65]);
createBezierS2([curveExBigLYSOSOMEUnderGolgi, curveInBigLYSOSOMEUnderGolgi], mattLightYellow);

//------------------------------------------------SMALL LYSOSOME UNDER GOLGI-----------------------------------------------------------------------------

var controls61 = [[458.1893005371094,339.0818176269531,0],[463.97625732421875,338.7772521972656,-4],[468.544921875,338.7772521972656,-4],[474.3318786621094,338.8787536621094,0]]
var controls62 = [[451.89471435546875,345.4779357910156,0],[460.32135009765625,345.07183837890625,-9],[472.1998291015625,344.9703063964844,-9],[481.2356262207031,344.8687744140625,0]]
var controls63 = [[449.55963134765625,353.4984436035156,0],[455.5496520996094,353.4984436035156,-15],[480.3218994140625,353.29541015625,-15],[483.5707092285156,353.3969421386719,0]]
var controls64 = [[452.40234375,362.3311767578125,0],[460.1182861328125,361.9250793457031,-9],[472.09832763671875,361.6205139160156,-9],[481.0325622558594,361.6205139160156,0]]
var controls65 = [[458.0877685546875,368.21966552734375,0],[464.2808532714844,368.4227294921875,-4],[469.35711669921875,368.4227294921875,-4],[474.3318786621094,368.3211975097656,0]]

var curveExSmallLYSOSOMEUnderGolgi = createCurveSurface([466.6159362792969,337.2543640136719+1.2,0],[467.5296630859375,369.1333923339844-1,0], [controls61, controls62, controls63, controls64, controls65]);
DRAW(COLOR(mattGold)(MAP(curveExSmallLYSOSOMEUnderGolgi)(domain3)));

var controls66 = [[460.978271484375,341.1583557128906,0],[465.7837829589844,341.1583557128906,-1],[469.1399841308594,341.1583557128906,-1],[473.5640869140625,341.1583557128906,0]]
var controls67 = [[456.9355773925781,345.2010498046875,0],[462.8089599609375,345.04852294921875,-5],[471.4283142089844,344.97222900390625,-5],[478.44586181640625,344.97222900390625,0]]
var controls68 = [[454.1895751953125,353.8204345703125,0],[459.2239074707031,353.6678771972656,-10],[477.5305480957031,353.51531982421875,-10],[481.34442138671875,353.59161376953125,0]]
var controls69 = [[456.9355773925781,362.13470458984375,0],[461.81732177734375,362.13470458984375,-5],[471.5046081542969,361.9058837890625,-5],[478.9798278808594,361.6770324707031,0]]
var controls70 = [[462.8852233886719,366.3299865722656,0],[466.241455078125,366.2536926269531,-1],[469.5213928222656,366.3299865722656,-1],[472.419921875,366.2536926269531,0]]

var curveInSmallLYSOSOMEUnderGolgi = createCurveSurface([467.4618835449219,340.0904541015625+1,0],[468.3009338378906,366.9402160644531-1,0], [controls66, controls67, controls68, controls69, controls70]);
createBezierS2([curveExSmallLYSOSOMEUnderGolgi, curveInSmallLYSOSOMEUnderGolgi], mattLightYellow);


//--------------------------------------------------------------VACUOLE UNDER GOLGI---------------------------------------------------------------------------------------------

var controls71 = [[451.6814880371094,408.321533203125,0],[455.7503967285156,408.26422119140625,-4],[460.2204895019531,408.14959716796875,-4],[464.0028381347656,408.09228515625,0]]
var controls72 = [[448.6441345214844,411.4161682128906,0],[452.7703552246094,411.7027282714844,-7],[462.5128173828125,412.6196594238281,-7],[467.9571228027344,413.25006103515625,0]]
var controls73 = [[446.7529602050781,414.6254577636719,0],[449.9622497558594,415.3704833984375,-13],[463.71630859375,418.9236145019531,-13],[467.44134521484375,419.8978576660156,0]]
var controls74 = [[445.1483154296875,418.1785888671875,0],[447.6698913574219,418.98089599609375,-17],[463.6016845703125,424.42523193359375,-17],[465.72210693359375,425.1129150390625,0]]
var controls75 = [[442.454833984375,421.27325439453125,0],[443.7156066894531,422.0182800292969,-20],[460.73626708984375,429.5830078125,-20],[461.767822265625,430.0987854003906,0]]
var controls76 = [[438.5005187988281,424.6544494628906,0],[442.5121154785156,427.23333740234375,-17],[452.25457763671875,433.9384460449219,-17],[455.8077087402344,436.2308044433594,0]]
var controls77 = [[433.4000549316406,428.3795166015625,0],[438.958984375,432.5057373046875,-13],[444.8617858886719,436.6319580078125,-13],[449.9622497558594,440.414306640625,0]]
var controls78 = [[430.1907958984375,431.8753356933594,0],[435.8070373535156,436.4027099609375,-7],[439.24554443359375,439.0962219238281,-7],[444.34600830078125,442.7066650390625,0]]
var controls79 = [[429.27386474609375,436.1734924316406,0],[433.7439270019531,439.38275146484375,-4],[435.6351013183594,440.6435546875,-4],[439.7613220214844,443.3370666503906,0]]

var curveExVacuoleUnderGolgi = createCurveSurface([457.69891357421875,407.3472595214844,0],[434.0877685546875,440.6435546875,0], [controls71, controls72, controls73, controls74, controls75, controls76, controls77, controls78, controls79]);
DRAW(COLOR(mattDarkOrange)(MAP(curveExVacuoleUnderGolgi)(domain3)));

var controls80 = [[454.0311584472656,410.4419250488281,0],[456.7819519042969,410.4419250488281,-2],[459.0169982910156,410.4419250488281,-2],[461.6531982421875,410.4419250488281,0]]
var controls81 = [[451.62420654296875,412.27581787109375,0],[455.3492431640625,412.9635009765625,-3],[459.1889343261719,413.7085266113281,-3],[464.40399169921875,414.5681457519531,0]]
var controls82 = [[449.33184814453125,415.5423889160156,0],[452.9996032714844,416.28741455078125,-4],[460.5643310546875,417.7201232910156,-4],[464.3466796875,418.5224304199219,0]]
var controls83 = [[447.15411376953125,419.7832336425781,0],[450.30609130859375,420.6428527832031,-5],[460.2204895019531,423.1644287109375,-5],[463.2578430175781,423.9667663574219,0]]
var controls84 = [[444.2886962890625,423.5655822753906,0],[449.21722412109375,425.1129150390625,-6],[456.2088623046875,427.57720947265625,-6],[459.9912414550781,428.9526062011719,0]]
var controls85 = [[441.5378723144531,426.0298767089844,0],[448.24298095703125,429.18182373046875,-5],[452.0826721191406,431.1303405761719,-5],[456.0369567871094,432.9642028808594,0]]
var controls86 = [[438.15667724609375,428.55145263671875,0],[443.37176513671875,431.8180236816406,-4],[446.0079650878906,433.53729248046875,-4],[451.1084289550781,436.46002197265625,0]]
var controls87 = [[435.11932373046875,430.9584045410156,0],[439.5893859863281,434.7407531738281,-3],[441.365966796875,436.1734924316406,-3],[445.1483154296875,439.6693115234375,0]]
var controls88 = [[432.7696838378906,434.28228759765625,0],[435.06201171875,437.376953125,-2],[435.5777893066406,438.1219787597656,-2],[437.010498046875,439.783935546875,0]]

var curveInVacuoleUnderGolgi = createCurveSurface([457.9281311035156,409.86883544921875,0],[434.14508056640625,437.9500427246094-1,0], [controls80, controls81, controls82, controls83, controls84, controls85, controls86, controls87, controls88]);
createBezierS2([curveExVacuoleUnderGolgi, curveInVacuoleUnderGolgi], mattOrange);


//-------------------------------------------------------------------------LYSOSOME UNDER VACUOLE-------------------------------------------------------------------------------------------------

var controls89 = [[406.4684753417969,476.531494140625,0],[412.1993408203125,476.3595886230469,-4],[416.6694030761719,476.3595886230469,-4],[421.25408935546875,476.3595886230469,0]]
var controls90 = [[402.2276306152344,481.6319580078125,0],[407.4427185058594,481.2308044433594,-5],[421.7125549316406,481.0588684082031,-5],[425.26568603515625,481.1161804199219,0]]
var controls91 = [[401.4826354980469,487.76397705078125,0],[403.7176513671875,487.76397705078125,-7],[424.6925964355469,487.99322509765625,-7],[427.1568603515625,487.99322509765625,0]]
var controls92 = [[402.97265625,494.06793212890625,0],[407.1561584472656,493.83868408203125,-5],[421.02484130859375,493.666748046875,-5],[425.4949035644531,493.4948425292969,0]]
var controls93 = [[407.3854064941406,498.07952880859375,0],[412.6004943847656,498.1941223144531,-4],[416.3828430175781,498.1941223144531,-4],[420.91021728515625,498.1941223144531,0]]

var curveExLYSOSOMEUnderVacuole = createCurveSurface([414.20513916015625,475.2707214355469+1,0],[414.6062927246094,499.05377197265625-1,0], [controls89, controls90, controls91, controls92, controls93]);
DRAW(COLOR(mattGold)(MAP(curveExLYSOSOMEUnderVacuole)(domain3)));

var controls94 = [[409.2192687988281,479.0530700683594,0],[412.7151184082031,479.0530700683594,-1],[414.95013427734375,479.0530700683594,-1],[417.8155517578125,478.9384460449219,0]]
var controls95 = [[406.2392272949219,482.3196716308594,0],[410.07891845703125,482.0331115722656,-2],[417.5290222167969,481.91851806640625,-2],[421.4833068847656,481.8612060546875,0]]
var controls96 = [[404.5773010253906,487.0189514160156,0],[406.92694091796875,486.961669921875,-3],[420.91021728515625,486.78973388671875,-3],[423.37451171875,486.8470458984375,0]]
var controls97 = [[405.6088562011719,492.0621337890625,0],[410.2508239746094,491.77557373046875,-2],[417.87286376953125,491.66094970703125,-2],[422.6867980957031,491.89019775390625,0]]
var controls98 = [[408.7034912109375,495.2713928222656,0],[412.8297119140625,495.3860168457031,-1],[415.5805358886719,495.3860168457031,-1],[419.01904296875,495.2713928222656,0]]

var curveInLYSOSOMEUnderVacuole = createCurveSurface([413.86126708984375,478.3080749511719+1,0],[414.3197326660156,496.2456359863281-1,0], [controls94, controls95, controls96, controls97, controls98]);
createBezierS2([curveExLYSOSOMEUnderVacuole, curveInLYSOSOMEUnderVacuole], mattLightYellow);

//---------------------------------------------------------------------LYSOSOME UNDER SMOOTH ENDOPLASMATIC RETICULUM--------------------------------------------------------------------------

var points1 = [[295.6826171875,521.6870727539062,0],[301.3271789550781,521.458251953125,-6],[306.6666259765625,521.3819580078125,-6],[312.2348937988281,521.3819580078125,0]]
var points2 = [[288.28369140625,526.8739624023438,0],[297.13189697265625,526.721435546875,-8],[310.5567932128906,526.6451416015625,-8],[319.0235900878906,526.56884765625,0]]
var points3 = [[285.0037536621094,532.9761962890625,0],[292.2501220703125,532.5947875976562,-12],[316.2013244628906,532.1371459960938,-12],[322.37982177734375,532.1371459960938,0]]
var points4 = [[284.3172607421875,539.0784301757812,0],[287.5209045410156,539.0784301757812,-15],[320.7779846191406,538.6207275390625,-15],[323.2188720703125,538.54443359375,0]]
var points5 = [[284.7749328613281,545.409423828125,0],[292.63153076171875,545.2568969726562,-12],[316.43017578125,544.7992553710938,-12],[322.5323791503906,544.7992553710938,0]]
var points6 = [[289.12274169921875,551.9693603515625,0],[296.8267822265625,552.1218872070312,-8],[311.0144348144531,552.0455932617188,-8],[317.7268981933594,552.1981811523438,0]]
var points7 = [[294.6910095214844,556.4697265625,0],[300.94580078125,556.6222534179688,-6],[306.1326599121094,556.5460205078125,-6],[312.3111572265625,556.6222534179688,0]]

var curveExLYSOSOMEUnderSmoothEndoplasmaticReticulum = createCurveSurface([304.302001953125,520.23779296875+1,0],[303.76806640625,557.7664184570312-1,0], [points1, points2, points3, points4, points5, points6, points7]);
DRAW(COLOR(mattGold)(MAP(curveExLYSOSOMEUnderSmoothEndoplasmaticReticulum)(domain3)));

var points8 = [[297.9248046875,524.202392578125,0],[302.2904052734375,524.202392578125,-1],[306.656005859375,524.100830078125,-1],[310.4124755859375,524.3038940429688,0]]
var points9 = [[292.44244384765625,527.552734375,0],[299.2446594238281,527.3496704101562,-2],[309.2956848144531,527.1466064453125,-2],[315.38720703125,527.0451049804688,0]]
var points10 = [[289.5997009277344,532.0198364257812,0],[296.5034484863281,531.9183349609375,-3],[313.4582214355469,531.9183349609375,-3],[318.63604736328125,531.7152709960938,0]]
var points11 = [[287.4676818847656,539.53271484375,0],[291.934814453125,539.4312133789062,-4],[317.417724609375,539.2281494140625,-4],[320.66656494140625,539.1266479492188,0]]
var points12 = [[289.193603515625,546.6395263671875,0],[296.3004150390625,546.7410278320312,-3],[313.3567199707031,546.5380249023438,-3],[319.0421447753906,546.4364624023438,0]]
var points13 = [[293.5592041015625,551.3096923828125,0],[298.635498046875,551.4112548828125,-2],[309.0926208496094,551.4112548828125,-2],[314.9811096191406,551.4112548828125,0]]
var points14 = [[296.9095458984375,554.2539672851562,0],[302.5950012207031,554.2539672851562,-1],[306.4529724121094,554.35546875,-1],[310.717041015625,554.2539672851562,0]]

var curveInLYSOSOMEUnderSmoothEndoplasmaticReticulum = createCurveSurface([304.6255187988281,523.39013671875+1,0],[304.52398681640625,554.8630981445312-1,0], [points8, points9, points10, points11, points12, points13, points14]);
createBezierS2([curveExLYSOSOMEUnderSmoothEndoplasmaticReticulum, curveInLYSOSOMEUnderSmoothEndoplasmaticReticulum], mattLightYellow);


//--------------------------------------------------------------------------------------CENTRIOLE----------------------------------------------------------------------------------------------

var controlsCentrioleIn1 = [[332.4930725097656,452.826904296875,0],[333.27081298828125,452.9727478027344,0],[333.7812194824219,453.31298828125,0],[333.99993896484375,453.7261657714844,0],[334.1457824707031,454.5525207519531,0],[334.0485534667969,455.1844482421875,0],[333.6353759765625,455.5976257324219,0],[333.02777099609375,455.79205322265625,0],[331.9097595214844,455.9621887207031,0],[331.35076904296875,455.79205322265625,0],[330.9375915527344,455.4031677246094,0],[330.62164306640625,454.7469482421875,0],[330.7917785644531,453.75048828125,0],[331.0348205566406,453.2643737792969,0],[331.5209045410156,452.94842529296875,0],[332.1771240234375,452.8026123046875,0],[332.49139404296875,452.8263854980469,0]]
var nubsCentrioleIn1 = createNubs(controlsCentrioleIn1);
var controlsCentrioleEx1 = [[332.4687805175781,452.3894348144531,0],[333.4166564941406,452.5352478027344,0],[334.09716796875,452.9727478027344,0],[334.5346374511719,453.6046447753906,0],[334.6561584472656,454.5282287597656,0],[334.46173095703125,455.2573547363281,0],[333.829833984375,455.81634521484375,0],[333.0763854980469,456.2052307128906,0],[331.8854675292969,456.30242919921875,0],[331.1563415527344,456.1080017089844,0],[330.4515075683594,455.57330322265625,0],[330.2084655761719,454.7469482421875,0],[330.42718505859375,453.7261657714844,0],[330.8403625488281,452.94842529296875,0],[331.3993835449219,452.6567687988281,0],[332.1042175292969,452.4137268066406,0],[332.4444580078125,452.3894348144531,0]]
var nubsCentrioleEx1 = createNubs(controlsCentrioleEx1);
var controlsCentrioleIn1Under = [[332.4930725097656,452.826904296875,-36],[333.27081298828125,452.9727478027344,-36],[333.7812194824219,453.31298828125,-36],[333.99993896484375,453.7261657714844,-36],[334.1457824707031,454.5525207519531,-36],[334.0485534667969,455.1844482421875,-36],[333.6353759765625,455.5976257324219,-36],[333.02777099609375,455.79205322265625,-36],[331.9097595214844,455.9621887207031,-36],[331.35076904296875,455.79205322265625,-36],[330.9375915527344,455.4031677246094,-36],[330.62164306640625,454.7469482421875,-36],[330.7917785644531,453.75048828125,-36],[331.0348205566406,453.2643737792969,-36],[331.5209045410156,452.94842529296875,-36],[332.1771240234375,452.8026123046875,-36],[332.49139404296875,452.8263854980469,-36]]
var nubsCentrioleIn1Under = createNubs(controlsCentrioleIn1Under);
var controlsCentrioleEx1Under = [[332.4687805175781,452.3894348144531,-36],[333.4166564941406,452.5352478027344,-36],[334.09716796875,452.9727478027344,-36],[334.5346374511719,453.6046447753906,-36],[334.6561584472656,454.5282287597656,-36],[334.46173095703125,455.2573547363281,-36],[333.829833984375,455.81634521484375,-36],[333.0763854980469,456.2052307128906,-36],[331.8854675292969,456.30242919921875,-36],[331.1563415527344,456.1080017089844,-36],[330.4515075683594,455.57330322265625,-36],[330.2084655761719,454.7469482421875,-36],[330.42718505859375,453.7261657714844,-36],[330.8403625488281,452.94842529296875,-36],[331.3993835449219,452.6567687988281,-36],[332.1042175292969,452.4137268066406,-36],[332.4444580078125,452.3894348144531,-36]]

var nubsCentrioleEx1Under = createNubs(controlsCentrioleEx1Under);

var centriole1In = createBezierS1([nubsCentrioleIn1, nubsCentrioleIn1Under]);
var centriole1InMap = MAP(centriole1In)(domain2);

var centriole1Ex = createBezierS1([nubsCentrioleEx1, nubsCentrioleEx1Under]);
var centriole1ExMap = MAP(centriole1Ex)(domain2);
var centriole1 = BEZIER(S2)([centriole1In, centriole1Ex]);
var centriole1Map = MAP(centriole1)(domain3);
DRAW(COLOR(mattAquamarine)(centriole1Map));

var centriole2Map = T([0,1])([4,1])(centriole1Map)
DRAW(COLOR(mattAquamarine)(centriole2Map));

var centriole3Map = T([0,1])([8, 2])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole3Map));

var centriole4Map = T([0,1])([16, 5])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole4Map));

var centriole5Map = T([0,1])([19.5, 3])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole5Map));

var centriole6Map = T([0,1])([23.5, 1.5])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole6Map));

var centriole7Map = T([0,1])([32, -3])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole7Map));

var centriole8Map = T([0,1])([33, -6.5])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole8Map));

var centriole9Map = T([0,1])([34, -10])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole9Map));

var centriole10Map = T([0,1])([38, -17])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole10Map));

var centriole11Map = T([0,1])([36, -20])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole11Map));

var centriole12Map = T([0,1])([34, -23])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole12Map));

var centriole13Map = T([0,1])([35, -32])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole13Map));

var centriole14Map = T([0,1])([31.5, -34])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole14Map));

var centriole15Map = T([0,1])([28, -36])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole15Map));

var centriole16Map = T([0,1])([21, -42])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole16Map));

var centriole17Map = T([0,1])([17, -42])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole17Map));

var centriole18Map = T([0,1])([13, -42])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole18Map));

var centriole19Map = T([0,1])([2, -41])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole19Map));

var centriole20Map = T([0,1])([1, -37.5])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole20Map));

var centriole21Map = T([0,1])([-0.5, -34])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole21Map));

var centriole22Map = T([0,1])([-9, -28])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole22Map));

var centriole23Map = T([0,1])([-8, -24.5])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole23Map));

var centriole24Map = T([0,1])([-7, -21])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole24Map));

var centriole25Map = T([0,1])([-9, -13])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole25Map));

var centriole26Map = T([0,1])([-7, -10])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole26Map));

var centriole27Map = T([0,1])([-5, -7])(centriole1Map);
DRAW(COLOR(mattAquamarine)(centriole27Map));

var unionLine = SIMPLEX_GRID([
  [2],
  [1],
  REPLICA(8)([0.01, -4, 0.01])
]);
var unionLine1 = T([0,1,2])([343.59686279296875,451.5823974609375,-32])(unionLine);

var p1 = POLYLINE([[343.57257080078125-1.5,451.6553039550781+5,-4],[346.2946472167969+0.5,450.51300048828125+10,-4]]);
DRAW(p1);

DRAW(T([2])([-4])(p1));
DRAW(T([2])([-8])(p1));
DRAW(T([2])([-12])(p1));
DRAW(T([2])([-16])(p1));
DRAW(T([2])([-20])(p1));
DRAW(T([2])([-24])(p1));
DRAW(T([2])([-28])(p1));

var p2 = POLYLINE([[358.64129638671875-0.5,452.8705139160156+3,-4],[362.1411437988281+0.5,456.5891113281251-4,-4]]);
DRAW(p2);

DRAW(T([2])([-4])(p2));
DRAW(T([2])([-8])(p2));
DRAW(T([2])([-12])(p2));
DRAW(T([2])([-16])(p2));
DRAW(T([2])([-20])(p2));
DRAW(T([2])([-24])(p2));
DRAW(T([2])([-28])(p2));

var p3 = POLYLINE([[370.44915771484375+1.5,466.7430114746094-28.1,-4],[368.7023010253906-2,469.6221008300781-27.1,-4]]);
DRAW(p3);

DRAW(T([2])([-4])(p3));
DRAW(T([2])([-8])(p3));
DRAW(T([2])([-12])(p3));
DRAW(T([2])([-16])(p3));
DRAW(T([2])([-20])(p3));
DRAW(T([2])([-24])(p3));
DRAW(T([2])([-28])(p3));

var p4 = POLYLINE([[365.164306640625,481.4428405761719-51.6,0],[369.51214599609375,484.9516296386719-62,0]]);
DRAW(p4);
DRAW(T([2])([-4])(p4));
DRAW(T([2])([-8])(p4));
DRAW(T([2])([-12])(p4));
DRAW(T([2])([-16])(p4));
DRAW(T([2])([-20])(p4));
DRAW(T([2])([-24])(p4));
DRAW(T([2])([-28])(p4));

var p5 = POLYLINE([[353.32830810546875+2.3,493.5585632324219-81.2,-4],[358.7335205078125,493.6936950683594-76.4,-4]]);
DRAW(p5);
DRAW(T([2])([-4])(p5));
DRAW(T([2])([-8])(p5));
DRAW(T([2])([-12])(p5));
DRAW(T([2])([-16])(p5));
DRAW(T([2])([-20])(p5));
DRAW(T([2])([-24])(p5));
DRAW(T([2])([-28])(p5));

var p6 = POLYLINE([[337.92340087890625-3.5,494.369354248046-83,-4],[341.5719299316406+3,496.80169677734375-83,-4]]);
DRAW(p6);
DRAW(T([2])([-4])(p6));
DRAW(T([2])([-8])(p6));
DRAW(T([2])([-12])(p6));
DRAW(T([2])([-16])(p6));
DRAW(T([2])([-20])(p6));
DRAW(T([2])([-24])(p6));
DRAW(T([2])([-28])(p6));

var p7 = POLYLINE([[328.8696594238281+3,482.88323974609375-60.8,-4],[326.30218505859375-3.8,486.5317687988281-61.9,-4]]);
DRAW(p7);
DRAW(T([2])([-4])(p7));
DRAW(T([2])([-8])(p7));
DRAW(T([2])([-12])(p7));
DRAW(T([2])([-16])(p7));
DRAW(T([2])([-20])(p7));
DRAW(T([2])([-24])(p7));
DRAW(T([2])([-28])(p7));

var p8 = POLYLINE([[321.8428649902344+2,469.09991455078125-34.3,-4],[325.35626220703125,471.39715576171875-31,-4]]);
DRAW(p8);
DRAW(T([2])([-4])(p8));
DRAW(T([2])([-8])(p8));
DRAW(T([2])([-12])(p8));
DRAW(T([2])([-16])(p8));
DRAW(T([2])([-20])(p8));
DRAW(T([2])([-24])(p8));
DRAW(T([2])([-28])(p8));

var p9 = POLYLINE([[329.0047912597656-2,455.58685302734375-6.3,0],[330.761474609375+3,459.1002502441406-6.3,0]]);
DRAW(p9);
DRAW(T([2])([-4])(p9));
DRAW(T([2])([-8])(p9));
DRAW(T([2])([-12])(p9));
DRAW(T([2])([-16])(p9));
DRAW(T([2])([-20])(p9));
DRAW(T([2])([-24])(p9));
DRAW(T([2])([-28])(p9));

//----------------------------------------------- GOLGI APPARATUS PART 1 -------------------------------------------------------------------

var points15 = [[467.215087890625,153.9337615966797,0],[470.1879577636719,151.23114013671875,-20],[471.5392761230469,150.2852325439453,-20],[475.5931701660156,147.31236267089844,0]]
var points16 = [[470.0528259277344,158.93359375,0],[473.16082763671875,156.36610412597656,+16],[475.9985656738281,154.2040252685547,+16],[481.40380859375,150.6906280517578,0]]
var points17 = [[475.18780517578125,163.5280303955078,0],[476.9444885253906,161.90646362304688,-20],[481.2686767578125,158.7984619140625,-20],[486.80902099609375,155.42019653320312,0]]
var points18 = [[478.7012023925781,167.7170867919922,0],[480.593017578125,166.5009002685547,-82],[485.59283447265625,162.58212280273438,-82],[491.5386047363281,159.0687255859375,0]]
var points19 = [[483.5658874511719,173.25743103027344,0],[484.7820739746094,172.4466552734375,+10],[491.5386047363281,167.98733520507812,+10],[497.0789489746094,165.28472900390625,0]]
var points20 = [[487.89007568359375,178.66265869140625,0],[489.1062316894531,177.7167510986328,-82],[500.05181884765625,172.1763916015625,-82],[502.4841613769531,170.96022033691406,0]]
var points21 = [[490.9980773925781,184.06788635253906,0],[492.889892578125,183.12196350097656,-10],[499.37615966796875,179.4734344482422,-10],[506.6732177734375,176.3654327392578,0]]
var points22 = [[494.511474609375,190.0136260986328,0],[496.2681579589844,189.20285034179688,-93],[502.6192932128906,186.63536071777344,-93],[511.6730651855469,183.93275451660156,0]]
var points23 = [[497.3492126464844,196.09449768066406,0],[500.45721435546875,194.87832641601562,+20],[506.6732177734375,192.8513641357422,+20],[514.7810668945312,190.2838897705078,0]]
var points24 = [[500.45721435546875,202.44564819335938,0],[505.727294921875,200.55381774902344,-15],[508.8352966308594,199.60789489746094,-15],[516.5377807617188,197.44581604003906,0]]
var points25 = [[502.4841613769531,208.12112426757812,0],[507.889404296875,206.3644256591797,-82],[511.1325378417969,205.14825439453125,-82],[517.483642578125,203.9320831298828,0]]
var points26 = [[506.267822265625,212.0399169921875,0],[511.1325378417969,211.093994140625,-8],[512.4838256835938,210.68861389160156,-8],[517.483642578125,209.74269104003906,0]]

var curveExGolgiApparatusPart1 = createCurveSurface([468.9717712402344,149.47445678710938+1,0],[512.8892211914062,212.71556091308594-1,0], [points15, points16, points17, points18, points19, points20, points21, points22, points23, points24, points25, points26]);
DRAW(COLOR(mattForestGreen)(MAP(curveExGolgiApparatusPart1)(domain3)));

var points27 = [[471.4041442871094,156.36610412597656,0],[472.89056396484375,154.87966918945312,-2],[473.56622314453125,154.2040252685547,-2],[474.91754150390625,152.9878387451172,0]]
var points28 = [[473.43109130859375,158.663330078125,0],[474.37701416015625,157.58229064941406,-4],[476.6742248535156,155.55532836914062,-4],[478.1606750488281,154.2040252685547,0]]
var points29 = [[477.0796203613281,161.50106811523438,0],[478.1606750488281,160.42002868652344,-5],[481.40380859375,158.122802734375,-5],[482.8902282714844,157.04176330566406,0]]
var points30 = [[481.9443359375,166.3657684326172,0],[483.1604919433594,165.69012451171875,-6],[486.80902099609375,163.2577667236328,-6],[488.70086669921875,161.77133178710938,0]]
var points31 = [[486.67388916015625,170.82508850097656,0],[488.29547119140625,169.74403381347656,-7],[490.9980773925781,167.98733520507812,-7],[492.889892578125,166.9062957763672,0]]
var points32 = [[489.5116271972656,174.06822204589844,0],[491.1332092285156,172.98716735839844,-8],[493.2952880859375,171.9061279296875,-8],[495.7276306152344,170.55482482910156,0]]
var points33 = [[492.349365234375,179.4734344482422,0],[493.8358154296875,178.93292236328125,-9],[499.24102783203125,175.82492065429688,-9],[500.59234619140625,175.01412963867188,0]]
var points34 = [[495.7276306152344,185.0137939453125,0],[497.7546081542969,183.66249084472656,-8],[501.53826904296875,181.50039672851562,-8],[504.5111389160156,180.1490936279297,0]]
var points35 = [[498.2951354980469,190.5541534423828,0],[501.26800537109375,188.79745483398438,-7],[503.7003479003906,187.58128356933594,-7],[507.4840087890625,185.2840576171875,0]]
var points36 = [[500.86260986328125,195.68911743164062,0],[504.2408752441406,193.9324188232422,-6],[505.727294921875,193.2567596435547,-6],[510.1866149902344,190.9595489501953,0]]
var points37 = [[502.4841613769531,200.68894958496094,0],[506.267822265625,198.52685546875,-5],[508.429931640625,197.8511962890625,-5],[512.4838256835938,195.82424926757812,0]]
var points38 = [[504.2408752441406,205.14825439453125,0],[507.4840087890625,203.9320831298828,-4],[510.0514831542969,202.5807647705078,-4],[513.8351440429688,201.22946166992188,0]]
var points39 = [[506.9434814453125,207.98599243164062,0],[509.7812194824219,207.3103485107422,-2],[512.0784301757812,206.2292938232422,-2],[513.9702758789062,205.55364990234375,0]]


var curveInGolgiApparatusPart1 = createCurveSurface([470.9987487792969,153.6634979248047+1,0],[511.1325378417969,208.66165161132812-1,0], [points27, points28, points29, points30, points31, points32, points33, points34, points35, points36, points37, points38, points39]);
createBezierS2([curveExGolgiApparatusPart1, curveInGolgiApparatusPart1], mattLimeGreen);

//----------------------------------------------------------------GOLGI APPARATUS PART 2-------------------------------------------------------------------------------

var points40 = [[426.540771484375,138.7991180419922,0],[430.0541687011719,135.5559844970703,-20],[434.91888427734375,132.17771911621094,-20],[438.5674133300781,130.01564025878906,0]]
var points41 = [[429.1082458496094,143.3935546875,0],[432.75677490234375,141.23147583007812,+20],[438.4322814941406,137.31268310546875,+20],[444.6482849121094,134.06954956054688,0]]
var points42 = [[434.64862060546875,148.25827026367188,0],[438.1620178222656,145.96104431152344,-100],[443.2969665527344,142.31251525878906,-100],[449.5129699707031,138.6639862060547,0]]
var points43 = [[440.18896484375,152.9878387451172,0],[445.3239440917969,150.28521728515625,+20],[448.83734130859375,147.85287475585938,+20],[454.918212890625,144.3394775390625,0]]
var points44 = [[448.70220947265625,157.4471435546875,0],[451.9453430175781,155.14991760253906,-80],[455.7289733886719,153.1229705810547,-80],[459.51263427734375,151.09600830078125,0]]
var points45 = [[454.377685546875,162.1767120361328,0],[456.9451599121094,160.14974975585938,+20],[459.64776611328125,158.66331481933594,+20],[464.1070861816406,156.50123596191406,0]]
var points46 = [[458.7018737792969,166.3657684326172,0],[461.67474365234375,164.87933349609375,+20],[464.2422180175781,162.5821075439453,+20],[467.4853515625,160.55514526367188,0]]
var points47 = [[463.2962951660156,170.8250732421875,0],[465.3232727050781,169.74403381347656,-50],[468.4312744140625,167.85220336914062,-80],[471.9446716308594,165.9603729248047,0]]
var points48 = [[467.4853515625,175.6897735595703,0],[470.3230895996094,173.66281127929688,-100],[471.5392761230469,172.58177185058594,-100],[474.78240966796875,170.2845458984375,0]]
var points49 = [[471.1338806152344,179.3383026123047,0],[473.02569580078125,177.85186767578125,-40],[474.64727783203125,177.04107666015625,-40],[478.8363037109375,174.60873413085938,0]]
var points50 = [[473.16082763671875,182.58143615722656,0],[475.7283020019531,181.09500122070312,+20],[477.3498840332031,180.14907836914062,+20],[481.2686767578125,178.2572479248047,0]]
var points51 = [[476.1336975097656,185.41917419433594,0],[478.4309387207031,184.7435302734375,-50],[480.7281494140625,183.52734375,-50],[483.8361511230469,181.63551330566406,0]]
var points52 = [[479.6470947265625,188.5271759033203,0],[481.8092041015625,187.44613647460938,-20],[483.0253601074219,186.50021362304688,-20],[484.7820739746094,185.41917419433594,0]]
var curveExGolgiApparatusPart2 = createCurveSurface([430.4595642089844,132.31285095214844+1,0],[482.8902282714844,188.9325714111328-1,0], [points40, points41, points42, points43, points44, points45, points46, points47, points48, points49, points50, points51, points52]);
DRAW(COLOR(mattForestGreen)(MAP(curveExGolgiApparatusPart2)(domain3)));

var points53 = [[430.4595642089844,138.5288543701172,0],[433.29730224609375,136.6370391845703,-20],[435.45941162109375,135.5559844970703,-20],[438.0268859863281,133.93441772460938,0]]
var points54 = [[432.48651123046875,142.71791076660156,0],[434.64862060546875,141.23147583007812,-20],[439.918701171875,138.39373779296875,-20],[443.0267028808594,136.3667755126953,0]]
var points55 = [[437.2160949707031,146.36643981933594,0],[439.6484375,145.01513671875,-20],[443.1618347167969,143.12330627441406,-20],[447.21575927734375,140.42068481445312,0]]
var points56 = [[442.7564392089844,150.42034912109375,0],[445.5942077636719,149.2041778564453,-20],[447.48602294921875,147.31234741210938,-20],[450.5940246582031,145.28538513183594,0]]
var points57 = [[448.43194580078125,153.66348266601562,0],[450.7291564941406,151.9067840576172,-20],[452.3507080078125,150.82574462890625,-20],[453.9722900390625,149.6095733642578,0]]
var points58 = [[451.6750793457031,155.55531311035156,0],[453.9722900390625,154.20401000976562,-20],[454.7830810546875,153.52835083007812,-20],[456.2695007324219,152.5824432373047,0]]
var points59 = [[454.7830810546875,158.2579345703125,0],[456.2695007324219,157.582275390625,-20],[457.7559509277344,156.771484375,-20],[458.97210693359375,156.09584045410156,0]]
var points60 = [[457.8910827636719,160.96054077148438,0],[458.97210693359375,160.28488159179688,-20],[460.32342529296875,159.47410583496094,-20],[461.40447998046875,158.79844665527344,0]]
var points61 = [[460.72882080078125,163.52801513671875,0],[461.26934814453125,162.9875030517578,-20],[462.6206359863281,162.1767120361328,-20],[463.9719543457031,161.50106811523438,0]]
var points62 = [[463.1611633300781,166.2306365966797,0],[463.9719543457031,165.5549774169922,-20],[465.1881408691406,164.87933349609375,-20],[465.9989013671875,164.33880615234375,0]]
var points63 = [[465.1881408691406,168.66297912597656,0],[466.2691650390625,167.98733520507812,-20],[466.8096923828125,167.58193969726562,-20],[467.8907470703125,166.90628051757812,0]]
var points64 = [[467.3502197265625,171.0953369140625,0],[468.8366394042969,170.1494140625,-20],[469.3771667480469,169.47377014160156,-20],[470.0528259277344,169.06837463378906,0]]
var points65 = [[469.3771667480469,173.79794311523438,0],[470.7284851074219,173.39254760742188,-20],[471.6744079589844,172.98716735839844,-20],[472.48516845703125,172.31150817871094,0]]
var points66 = [[471.5392761230469,176.3654327392578,0],[472.89056396484375,175.5546417236328,-20],[473.56622314453125,175.2843780517578,-20],[474.51214599609375,174.8789825439453,0]]
var points67 = [[473.56622314453125,178.5275115966797,0],[474.51214599609375,177.85186767578125,-20],[475.7283020019531,177.31134033203125,-20],[476.2688293457031,176.77081298828125,0]]
var points68 = [[474.91754150390625,180.28421020507812,0],[475.9985656738281,179.7436981201172,-20],[476.8093566894531,179.2031707763672,-20],[478.0255432128906,178.7977752685547,0]]
var points69 = [[476.4039611816406,182.31117248535156,0],[477.4850158691406,181.90577697753906,-20],[478.4309387207031,181.50038146972656,-20],[479.511962890625,180.95986938476562,0]]
var points70 = [[478.0255432128906,183.6624755859375,0],[478.8363037109375,183.257080078125,-20],[479.7822265625,182.85169982910156,-20],[480.32275390625,182.44630432128906,0]]
var points71 = [[478.5652770996094,184.66648864746094,0],[479.21112060546875,184.4942626953125,-20],[479.7708435058594,184.2789764404297,-20],[480.8042297363281,183.89146423339844,0]]
var curveInGolgiApparatusPart2 = createCurveSurface([432.7698974609375,134.91896057128906+1,0],[480.4324645996094,185.45928955078125-1,0], [points53, points54, points55, points56, points57, points58, points59, points60, points61, points62, points63, points64, points65, points66, points67, points68, points69, points70, points71]);
createBezierS2([curveExGolgiApparatusPart2, curveInGolgiApparatusPart2], mattLimeGreen);

//---------------------------------------------------------GOLGI APPARATUS PART 3 ----------------------------------------------------------------------------------------------

var points72 = createControls([[482.74884033203125,195.28854370117188,0],[485.3885192871094,194.27328491210938,0],[487.3175048828125,193.35955810546875,0],[489.652587890625,192.75039672851562,0]], -20)
var points73 = createControls([[484.1701965332031,198.2327880859375,0],[486.09918212890625,197.72515869140625,0],[489.44952392578125,196.2022705078125,0],[491.7846374511719,194.9839630126953,0]], +30)
var points74 = createControls([[485.9976806640625,202.8014373779297,0],[488.0281677246094,202.19227600097656,0],[492.49530029296875,200.66940307617188,0],[495.23651123046875,199.85719299316406,0]], -80)
var points75 = createControls([[487.82513427734375,206.9639892578125,0],[490.0586853027344,206.55789184570312,0],[495.1349792480469,204.9334716796875,0],[497.6731262207031,203.918212890625,0]], +30)
var points76 = createControls([[489.5510559082031,212.3448486328125,0],[491.9876708984375,211.63417053222656,0],[497.87615966796875,209.90823364257812,0],[500.61737060546875,208.89297485351562,0]], -110)
var points77 = createControls([[490.972412109375,217.62417602539062,0],[494.1197204589844,216.9134979248047,0],[500.21124267578125,215.18756103515625,0],[503.7646484375,214.17230224609375,0]], -70)
var points78 = createControls([[492.49530029296875,222.70045471191406,0],[494.9319152832031,222.2943572998047,0],[502.3432922363281,220.36537170410156,0],[506.9119567871094,219.35011291503906,0]],+30)
var points79 = createControls([[493.3075256347656,228.08131408691406,0],[495.9471740722656,227.6752166748047,0],[505.795166015625,226.35537719726562,0],[508.63787841796875,225.84774780273438,0]], -80)
var points80 = createControls([[494.1197204589844,233.66522216796875,0],[496.353271484375,233.56370544433594,0],[507.31805419921875,232.9545440673828,0],[509.5516052246094,232.75149536132812,0]], -100)
var points81 = createControls([[494.52581787109375,238.5384521484375,0],[497.06396484375,238.3354034423828,0],[505.3890686035156,238.3354034423828,0],[509.34857177734375,237.92930603027344,0]], +30)
var points82 = createControls([[494.32275390625,243.41168212890625,0],[497.87615966796875,243.61473083496094,0],[504.0692138671875,243.31015014648438,0],[508.7394104003906,243.41168212890625,0]], -80)
var points83 = createControls([[495.23651123046875,247.2696533203125,0],[499.3990478515625,247.37118530273438,0],[503.0539855957031,247.0666046142578,0],[507.5210876464844,247.1681365966797,0]], -50)
var points84 = createControls([[496.7593688964844,250.6199951171875,0],[500.0082092285156,250.6199951171875,0],[501.6325988769531,250.5184783935547,0],[504.6783752441406,250.72152709960938,0]], -20)
var curveExGolgiApparatusPart3 = createCurveSurface([484.0686950683594,193.5,0],[500.92193603515625,250,0], [points72, points73, points74, points75, points76, points77, points78, points79, points80, points81, points82, points83, points84]);
DRAW(COLOR(mattForestGreen)(MAP(curveExGolgiApparatusPart3)(domain3)));

var points116 = createControls([[486.4919128417969,198.13888549804688,0],[487.02874755859375,197.70831298828125,0],[487.5454406738281,197.49302673339844,0],[488.2343444824219,197.2346954345703,0]], -20)
var points117 = createControls([[487.9715576171875,201.3240966796875,0],[488.91748046875,200.918701171875,0],[489.728271484375,200.37818908691406,0],[490.8092956542969,199.97279357910156,0]], -20)
var points118 = createControls([[489.4580078125,204.70236206054688,0],[490.268798828125,204.29696655273438,0],[491.6200866699219,203.89158630371094,0],[492.9714050292969,203.48619079589844,0]], -20)
var points119 = createControls([[490.9444274902344,208.21575927734375,0],[491.8903503417969,207.81036376953125,0],[493.2416687011719,207.2698516845703,0],[494.86322021484375,206.4590606689453,0]], -20)
var points120 = createControls([[492.5660095214844,212.53993225097656,0],[493.7821960449219,211.99942016601562,0],[496.21453857421875,211.05349731445312,0],[497.7009582519531,210.3778533935547,0]], -20)
var points121 = createControls([[494.18756103515625,216.86412048339844,0],[495.67401123046875,216.45872497558594,0],[497.9712219238281,215.64794921875,0],[500.4035949707031,214.7020263671875,0]], -20)
var points122 = createControls([[494.99835205078125,221.59368896484375,0],[497.4306945800781,220.6477813720703,0],[500.4035949707031,219.4315948486328,0],[502.4305419921875,218.75595092773438,0]], -20)
var points123 = createControls([[496.07940673828125,226.32325744628906,0],[498.2414855957031,225.64761352539062,0],[502.025146484375,224.56655883789062,0],[504.1872253417969,223.8909149169922,0]], -20)
var points124 = createControls([[496.61993408203125,231.18795776367188,0],[498.9171447753906,230.91769409179688,0],[502.9710693359375,230.10691833496094,0],[505.4034118652344,229.83665466308594,0]], -20)
var points125 = createControls([[497.02532958984375,236.99856567382812,0],[499.5928039550781,236.5931854248047,0],[503.646728515625,236.0526580810547,0],[505.9439392089844,236.0526580810547,0]], -20)
var points126 = createControls([[497.16046142578125,241.99839782714844,0],[499.8630676269531,241.86326599121094,0],[503.9169921875,241.593017578125,0],[506.2142028808594,241.1876220703125,0]], -20)
var points127 = createControls([[497.70098876953125,245.6469268798828,0],[499.8630676269531,245.6469268798828,0],[503.7818603515625,245.1063995361328,0],[505.8088073730469,244.83615112304688,0]], -20)
var points128 = createControls([[498.7820129394531,247.67388916015625,0],[501.2143859863281,247.53875732421875,0],[503.5115966796875,247.40362548828125,0],[504.8628845214844,247.26849365234375,0]], -20)
var curveInGolgiApparatusPart3 = createCurveSurface([486.7553405761719,196.3242645263672+1,0],[501.2143249511719,249.0251922607422-1,0], [points116, points117, points118, points119, points120, points121, points122, points123, points124, points125, points126, points127, points128])
createBezierS2([curveExGolgiApparatusPart3, curveInGolgiApparatusPart3], mattLimeGreen);



//---------------------------------------------------------------------------GOLGI APPARATUS PART 4-----------------------------------------------------------------------------------

var points129 = createControls([[406.5442199707031,140.69677734375,0],[409.8957214355469,138.3028564453125,0],[413.0078125,135.908935546875,0],[414.44415283203125,134.4725799560547,0]], -20)
var points130 = createControls([[408.9381408691406,145.484619140625,0],[412.2896423339844,143.80886840820312,0],[414.9229431152344,141.89373779296875,0],[419.7107849121094,138.3028564453125,0]], -40)
var points131 = createControls([[414.20477294921875,150.99063110351562,0],[417.3168640136719,149.07550048828125,0],[421.62591552734375,146.20278930664062,0],[425.4562072753906,143.33009338378906,0]], -80)
var points132 = createControls([[419.9501953125,156.4966583251953,0],[422.58349609375,153.86334228515625,0],[427.371337890625,150.51185607910156,0],[430.2440490722656,148.11793518066406,0]], -45)
var points133 = createControls([[425.6955871582031,160.32693481445312,0],[429.0470886230469,157.93301391601562,0],[432.6379699707031,155.53909301757812,0],[435.5106506347656,153.6239471435547,0]], +10)
var points134 = createControls([[430.96221923828125,164.635986328125,0],[434.0743103027344,162.96023559570312,0],[437.6651916503906,161.2845001220703,0],[440.53790283203125,158.8905792236328,0]], -90)
var points135 = createControls([[435.98944091796875,168.94503784179688,0],[439.580322265625,166.79051208496094,0],[442.2136535644531,165.11477661132812,0],[445.32574462890625,162.2420654296875,0]], -100)
var points136 = createControls([[440.53790283203125,173.4934844970703,0],[443.4106140136719,171.8177490234375,0],[446.7620849609375,169.18443298339844,0],[449.6347961425781,166.55111694335938,0]], +40)
var points137 = createControls([[446.0439147949219,178.0419464111328,0],[449.3954162597656,176.36619567871094,0],[452.2680969238281,173.97227478027344,0],[455.3802185058594,172.53591918945312,0]], -100)
var points138 = createControls([[452.50750732421875,184.02674865722656,0],[455.3802185058594,181.87220764160156,0],[458.9710998535156,180.4358673095703,0],[462.5619812011719,178.52072143554688,0]], -80)
var points139 = createControls([[458.731689453125,190.49032592773438,0],[462.8013610839844,188.5751953125,0],[465.4346618652344,187.37823486328125,0],[468.5467834472656,185.94187927246094,0]], -60)
var points140 = createControls([[463.0407409667969,196.95391845703125,0],[466.1528625488281,195.7569580078125,0],[468.7861633300781,193.84181213378906,0],[473.5740051269531,191.44789123535156,0]], -100)
var points141 = createControls([[467.5892028808594,202.938720703125,0],[470.2225036621094,201.9811553955078,0],[473.5740051269531,200.78419494628906,0],[477.883056640625,198.86904907226562,0]], -80)
var points142 = createControls([[470.9407043457031,209.64169311523438,0],[475.0103454589844,207.9659423828125,0],[478.3618469238281,207.0083770751953,0],[482.6708984375,205.572021484375,0]], -60)
var points143 = createControls([[473.5740051269531,216.82345581054688,0],[476.44671630859375,215.62649536132812,0],[481.47393798828125,213.95074462890625,0],[484.5860290527344,212.99317932128906,0]], +40)
var points144 = createControls([[475.0103454589844,225.92034912109375,0],[478.3618469238281,225.68096923828125,0],[482.9103088378906,224.723388671875,0],[487.6981506347656,223.52642822265625,0]], -30)
var points145 = createControls([[475.9679260253906,234.299072265625,0],[479.5588073730469,233.82029724121094,0],[485.5436096191406,232.8627166748047,0],[489.1344909667969,231.9051513671875,0]], -40)
var points146 = createControls([[476.6861267089844,240.28387451171875,0],[480.5163879394531,239.56570434570312,0],[485.3042297363281,238.84751892089844,0],[489.8526916503906,237.6505584716797,0]], -50)
var points147 = createControls([[475.4891662597656,246.02928161621094,0],[480.03759765625,246.02928161621094,0],[486.2618103027344,246.02928161621094,0],[491.2890319824219,245.55050659179688,0]], -60)
var points148 = createControls([[474.7709655761719,254.64739990234375,0],[480.99517822265625,253.68983459472656,0],[486.7405700683594,252.97164916992188,0],[492.4859924316406,252.0140838623047,0]], -50)
var points149 = createControls([[474.7709655761719,260.87158203125,0],[480.2770080566406,259.9140319824219,0],[487.2193603515625,259.43524169921875,0],[494.6405334472656,258.7170715332031,0]], -40)
var points150 = createControls([[477.404296875+3,267.0957946777344+4,0],[482.9103088378906,267.0957946777344+5,0],[489.8526916503906,266.37762451171875+5,0],[492.96478271484375-3,266.1382141113281+4,0]], -20)
var curveExGolgiApparatusPart4 = createCurveSurface([411,139,0],[485.30419921875,266.5+1,0], [points129, points130, points131, points132, points133, points134, points135, points136, points137, points138, points139, points140,
  points141, points142, points143, points144, points145, points146, points147, points148, points149, points150]);
DRAW(COLOR(mattForestGreen)(MAP(curveExGolgiApparatusPart4)(domain3)));

var points85 = createControls([[410.42730712890625+2,143.07171630859375-1,0],[412.40576171875+1,141.81271362304688,0],[414.5640869140625,140.01412963867188,0],[416.0029296875-4,139.29469299316406-2,0]],-20)
var points86 = createControls([[414.5640869140625,147.748046875,0],[416.3626708984375,146.48904418945312,0],[418.3410949707031,145.0501708984375,0],[420.3195495605469,143.2515869140625,0]], -20)
var points87 = createControls([[419.060546875,151.16537475585938,0],[421.03900146484375,149.90635681152344,0],[423.3771667480469,148.10777282714844,0],[424.9958801269531,147.0286102294922,0]], -20)
var points88 = createControls([[423.3771667480469,155.1222686767578,0],[424.8160400390625,153.14381408691406,0],[426.43475341796875,151.8848114013672,0],[428.23333740234375,150.62579345703125,0]], -20)
var points89 = createControls([[427.33404541015625,157.46043395996094,0],[428.7729187011719,156.0215606689453,0],[430.03192138671875,154.94239807128906,0],[431.83050537109375,153.32366943359375,0]], -20)
var points90 = createControls([[431.111083984375,160.5180206298828,0],[432.3700866699219,158.8992919921875,0],[433.2693786621094,157.64028930664062,0],[435.0679931640625,156.74099731445312,0]], -20)
var points91 = createControls([[434.5284118652344,163.21591186523438,0],[435.96728515625,162.13674926757812,0],[437.0464172363281,160.5180206298828,0],[438.6651611328125,159.6187286376953,0]], -20)
var points92 = createControls([[438.3054504394531,166.81307983398438,0],[439.7442932128906,165.7339324951172,0],[441.0033264160156,165.01449584960938,0],[442.6220397949219,163.57562255859375,0]], -20)
var points93 = createControls([[441.7227478027344,170.050537109375,0],[442.8019104003906,168.79153442382812,0],[444.0609130859375,167.3526611328125,0],[445.6796569824219,166.09364318847656,0]], -20)
var points94 = createControls([[445.3199157714844,173.64772033691406,0],[446.5789489746094,172.38870239257812,0],[447.6580810546875,171.30955505371094,0],[449.2768249511719,169.51097106933594,0]], -20)
var points95 = createControls([[449.2768249511719,176.8851776123047,0],[449.9962463378906,175.8060302734375,0],[451.614990234375,174.54701232910156,0],[453.23370361328125,172.92828369140625,0]], -20)
var points96 = createControls([[452.56683349609375,180.67404174804688,0],[453.88665771484375,179.65879821777344,0],[455.4095458984375,178.74505615234375,0],[457.74462890625,177.0191192626953,0]], -20)
var points97 = createControls([[456.6278381347656,184.8365936279297,0],[457.4400634765625,183.71981811523438,0],[458.9629211425781,182.5015106201172,0],[461.3995361328125,181.0801544189453,0]], -20)
var points98 = createControls([[460.0797119140625,188.18695068359375,0],[461.5010681152344,187.07015991210938,0],[463.63311767578125,185.8518524169922,0],[465.3590393066406,184.8365936279297,0]], -20)
var points99 = createControls([[462.61785888671875,191.43576049804688,0],[464.1407470703125,190.42050170898438,0],[466.0697326660156,189.30372619628906,0],[467.8971862792969,188.08541870117188,0]], -20)
var points100 = createControls([[464.95294189453125,195.09068298339844,0],[466.1712646484375,194.3800048828125,0],[469.01397705078125,192.75559997558594,0],[470.9429626464844,191.63880920410156,0]], -20)
var points101 = createControls([[468.50634765625,200.26849365234375,0],[470.2322692871094,199.15170288085938,0],[472.05975341796875,198.23797607421875,0],[474.1917724609375,197.22271728515625,0]], -20)
var points102 = createControls([[471.7551574707031,204.83714294433594,0],[473.5826416015625,203.9234161376953,0],[475.917724609375,203.3142547607422,0],[477.1360168457031,202.60357666015625,0]], -20)
var points103 = createControls([[473.37957763671875,209.3042755126953,0],[475.3085632324219,208.6951141357422,0],[477.44061279296875,207.78138732910156,0],[479.26806640625,207.07070922851562,0]], -20)
var points104 = createControls([[475.20703125,213.0607147216797,0],[476.5268859863281,212.55308532714844,0],[478.6589050292969,211.8424072265625,0],[481.09552001953125,211.03021240234375,0]], -20)
var points105 = createControls([[476.3238220214844,216.61412048339844,0],[478.45587158203125,215.9034423828125,0],[479.978759765625,215.49732971191406,0],[482.5168762207031,215.0912322998047,0]], -20)
var points106 = createControls([[477.8467102050781,220.4720916748047,0],[479.77569580078125,220.4720916748047,0],[481.80621337890625,220.26904296875,0],[483.5321350097656,219.96446228027344,0]], -20)
var points107 = createControls([[478.2528076171875,225.04074096679688,0],[480.9939880371094,224.6346435546875,0],[482.82147216796875,224.33006286621094,0],[484.14129638671875,224.12701416015625,0]], -20)
var points108 = createControls([[478.6589050292969,229.40634155273438,0],[481.298583984375,229.40634155273438,0],[482.9230041503906,229.2032928466797,0],[485.0550231933594,229.10177612304688,0]], -20)
var points109 = createControls([[478.9635009765625,234.381103515625,0],[480.8924865722656,234.381103515625,0],[482.9230041503906,234.27957153320312,0],[485.46112060546875,234.27957153320312,0]], -20)
var points110 = createControls([[478.45587158203125,240.9802703857422,0],[480.587890625,240.8787384033203,0],[483.0245056152344,240.8787384033203,0],[486.679443359375,240.8787384033203,0]], -20)
var points111 = createControls([[478.2528076171875,246.6656951904297,0],[479.978759765625,246.6656951904297,0],[483.938232421875,246.3611297607422,0],[487.3901062011719,246.3611297607422,0]], -20)
var points112 = createControls([[477.6436462402344,252.6557159423828,0],[479.0650329589844,252.6557159423828,0],[486.7809753417969,252.45266723632812,0],[488.7099609375,252.45266723632812,0]], -20)
var points113 = createControls([[478.1512756347656,257.93505859375,0],[480.1817932128906,257.93505859375,0],[486.0702819824219,257.73199462890625,0],[490.02978515625,257.5289306640625,0]], -20)
var points114 = createControls([[477.5421447753906,262.40216064453125,0],[482.3138427734375,262.40216064453125,0],[485.5626525878906,262.40216064453125,0],[489.52215576171875,261.9960632324219,0]], -20)
var points115 = createControls([[480.79095458984375,265.75250244140625,0],[483.3291015625,265.8540344238281,0],[485.96875,265.8540344238281,0],[488.7099609375,265.95556640625,0]], -20)
var curveInGolgiApparatusPart4 = createCurveSurface([413.94512939453125,143,0],[484.59295654296875,265,0], [points85, points86, points87,points88, points89, points90, points91, points92, points93, points94, points95, points96, points97, points98, points99, points100, points101, points102, points103, points104, points105, points106, points107, points108, points109, points110, points111, points112, points113, points114, points115]);
createBezierS2([curveExGolgiApparatusPart4, curveInGolgiApparatusPart4], mattLimeGreen);

//-----------------------------------------------------------------------GOLGI APPARATUS PART 5------------------------------------------------------------------------------

var points151 = createControls([[392.65948486328125,156.7360382080078,0],[395.29278564453125,154.82090759277344,0],[398.1654968261719,152.18759155273438,0],[402.47454833984375,149.07550048828125,0]], -20)
var points152 = createControls([[396.48974609375,163.1996307373047,0],[400.08062744140625,160.56631469726562,0],[404.62908935546875,156.0178680419922,0],[408.4593505859375,152.6663818359375,0]], +30)
var points153 = createControls([[404.86846923828125,166.07232666015625,0],[408.69873046875,163.1996307373047,0],[411.0926513671875,159.60874938964844,0],[413.486572265625,157.21482849121094,0]], -100)
var points154 = createControls([[413.9653625488281,168.46624755859375,0],[417.3168640136719,165.35415649414062,0],[418.5138244628906,163.67840576171875,0],[420.6683349609375,162.4814453125,0]], -45)
var points155 = createControls([[420.6683349609375,173.97227478027344,0],[422.8228759765625,172.7753143310547,0],[424.9773864746094,171.0995635986328,0],[427.3713073730469,168.94503784179688,0]], -80)
var points156 = createControls([[427.3713073730469,180.91464233398438,0],[430.004638671875,178.99951171875,0],[431.9197692871094,177.32376098632812,0],[434.0743103027344,174.92984008789062,0]], -90)
var points157 = createControls([[432.1591491699219,186.66004943847656,0],[435.0318603515625,185.4630889892578,0],[437.6651916503906,183.0691680908203,0],[441.7348327636719,180.43585205078125,0]], -160)
var points158 = createControls([[436.9469909667969,193.12364196777344,0],[440.5378723144531,190.96910095214844,0],[443.41058349609375,189.05397033691406,0],[446.7620849609375,187.3782196044922,0]], +40)
var points159 = createControls([[441.2560729980469,199.8266143798828,0],[444.1287536621094,198.3902587890625,0],[448.6772155761719,196.23573303222656,0],[453.2256774902344,193.6024169921875,0]], -100)
var points160 = createControls([[446.0439147949219,206.2902069091797,0],[449.8741760253906,204.1356658935547,0],[453.4650573730469,202.69932556152344,0],[457.77410888671875,200.7841796875,0]], -90)
var points161 = createControls([[450.35296630859375,212.27500915527344,0],[452.74688720703125,210.83865356445312,0],[457.0559387207031,208.9235076904297,0],[461.1256103515625,207.24777221679688,0]], -80)
var points162 = createControls([[454.6620178222656,218.9779815673828,0],[457.77410888671875,216.5840606689453,0],[461.8437805175781,215.38710021972656,0],[464.95587158203125,213.4719696044922,0]], +20)
var points163 = createControls([[456.3377685546875,224.48399353027344,0],[459.92864990234375,223.7658233642578,0],[464.2377014160156,221.85069274902344,0],[468.0679626464844,219.69615173339844,0]], -100)
var points164 = createControls([[459.2104797363281,230.22940063476562,0],[463.9983215332031,229.99002075195312,0],[468.7861633300781,229.03244018554688,0],[471.1800842285156,228.79306030273438,0]], -80)
var points165 = createControls([[459.2104797363281,236.93238830566406,0],[463.2801208496094,237.6505584716797,0],[468.307373046875,237.17178344726562,0],[471.4194641113281,237.17178344726562,0]], -60)
var points166 = createControls([[456.8165588378906,241.24143981933594,0],[461.6044006347656,243.63536071777344,0],[466.3922424316406,243.874755859375,0],[471.4194641113281,244.59292602539062,0]], +40)
var points167 = createControls([[455.38018798828125,249.6201629638672,0],[460.6468200683594,250.33834838867188,0],[466.15283203125,250.57772827148438,0],[473.09521484375,251.0565185546875,0]], -30)
var points168 = createControls([[454.6620178222656,257.5201110839844,0],[460.16802978515625,257.5201110839844,0],[466.15283203125,258.4776611328125,0],[470.7012939453125,260.1534118652344,0]], -40)
var points169 = createControls([[456.5771484375,263.5049133300781,0],[461.1256103515625,264.9412536621094,0],[465.4346618652344,265.1806640625,0],[469.74371337890625,265.1806640625,0]], -20)
var curveExGolgiApparatusPart5 = createCurveSurface([397.6170349121094,153.5118408203125-3,0],[461.8437805175781,267.81396484375-3,0], [points151, points152, points153, points154, points155, points156, points157, points158, points159, points160, points161, points162, points163, points164, points165, points166, points167, points168, points169])
DRAW(COLOR(mattForestGreen)(MAP(curveExGolgiApparatusPart5)(domain3)));

var points170 = createControls([[396.48974609375,156.97543334960938,0],[397.68670654296875,154.82090759277344,0],[399.3624572753906,153.6239471435547,0],[401.7563781738281,152.18759155273438,0]], -20)
var points171 = createControls([[398.4048767089844,160.0875244140625,0],[401.0382080078125,158.89056396484375,0],[403.6715087890625,157.4542236328125,0],[406.7835998535156,155.2996826171875,0]], -20)
var points172 = createControls([[404.1502990722656,162.96023559570312,0],[407.50177001953125,161.76327514648438,0],[409.1775207519531,160.8057098388672,0],[411.5714416503906,159.36935424804688,0]], -20)
var points173 = createControls([[410.1351013183594,165.5935516357422,0],[412.5290222167969,164.8753662109375,0],[413.7259826660156,163.43902587890625,0],[417.07745361328125,162.2420654296875,0]], -20)
var points174 = createControls([[415.64111328125,168.7056427001953,0],[417.5562438964844,167.0299072265625,0],[418.7532043457031,166.07232666015625,0],[419.91668701171875,165.1094207763672,0]], -20)
var points175 = createControls([[420.52691650390625,171.8981475830078,0],[421.5185241699219,171.36419677734375,0],[422.73895263671875,170.37258911132812,0],[424.2645263671875,169.3809814453125,0]], -20)
var points176 = createControls([[425.5612487792969,175.9408721923828,0],[426.24774169921875,175.4832000732422,0],[427.4681701660156,174.79669189453125,0],[428.53607177734375,174.03392028808594,0]], -20)
var points177 = createControls([[431.05322265625,181.35658264160156,0],[431.96856689453125,180.44125366210938,0],[432.6550598144531,179.9073028564453,0],[433.4941101074219,179.06825256347656,0]], -20)
var points178 = createControls([[435.7061767578125,186.16207885742188,0],[437.15545654296875,185.6281280517578,0],[438.0707702636719,185.0941925048828,0],[439.36749267578125,184.40768432617188,0]], -20)
var points179 = createControls([[439.8251647949219,191.3489532470703,0],[440.9693298339844,190.66246032714844,0],[442.9525451660156,189.59457397460938,0],[443.94415283203125,188.90806579589844,0]], -20)
var points180 = createControls([[442.79998779296875,195.01028442382812,0],[443.94415283203125,194.47634887695312,0],[445.77484130859375,193.56101989746094,0],[446.9952697753906,192.87451171875,0]], -20)
var points181 = createControls([[446.53759765625,200.1208953857422,0],[447.5292053222656,199.51068115234375,0],[449.0547790527344,198.51907348632812,0],[450.80914306640625,197.6800079345703,0]], -20)
var points182 = createControls([[449.20733642578125,204.54501342773438,0],[450.88543701171875,203.5533905029297,0],[452.7923889160156,202.56178283691406,0],[454.7756042480469,201.41761779785156,0]], -20)
var points183 = createControls([[452.4109802246094,209.7318878173828,0],[454.7756042480469,208.35888671875,0],[456.1485900878906,207.90122985839844,0],[458.28436279296875,206.6807861328125,0]], -20)
var points184 = createControls([[455.6146545410156,215.98666381835938,0],[457.14019775390625,215.0713348388672,0],[459.9624938964844,213.7746124267578,0],[462.0982666015625,212.7830047607422,0]], -20)
var points185 = createControls([[458.97088623046875,220.94471740722656,0],[460.267578125,220.1819305419922,0],[462.2508239746094,219.41915893554688,0],[464.7679748535156,218.27499389648438,0]], -20)
var points186 = createControls([[461.0303649902344,226.05531311035156,0],[462.93731689453125,225.2162628173828,0],[464.1577453613281,224.52976989746094,0],[465.9121398925781,223.76698303222656,0]], -20)
var points187 = createControls([[462.7847900390625,231.5473175048828,0],[464.2340393066406,231.08966064453125,0],[465.6833190917969,230.7845458984375,0],[466.8274841308594,230.47943115234375,0]], -20)
var points188 = createControls([[461.25921630859375,238.0309295654297,0],[462.7847900390625,237.95465087890625,0],[465.30194091796875,237.80209350585938,0],[468.3530578613281,237.80209350585938,0]], -20)
var points189 = createControls([[459.2760009765625,243.82803344726562,0],[462.2508239746094,243.82803344726562,0],[466.2935485839844,243.82803344726562,0],[469.34466552734375,243.67547607421875,0]], -20)
var points190 = createControls([[458.0555725097656,248.5572509765625,0],[460.5727233886719,248.40469360351562,0],[466.98004150390625,248.5572509765625,0],[469.573486328125,248.40469360351562,0]], -20)
var points191 = createControls([[457.0639343261719,254.81201171875,0],[459.58111572265625,254.58319091796875,0],[467.59027099609375,254.35435485839844,0],[469.8023376464844,254.43063354492188,0]], -20)
var points192 = createControls([[456.8351135253906,260.30401611328125,0],[460.2676086425781,260.30401611328125,0],[465.6833190917969,260.22772216796875,0],[469.1921081542969,260.4565734863281,0]], -20)
var points193 = createControls([[458.8183288574219,263.5839538574219,0],[461.4117736816406,263.8127746582031,0],[464.3865966796875,263.66021728515625,0],[466.8274841308594,263.73651123046875,0]], -20)
var curveInGolgiApparatusPart5 = createCurveSurface([398.0367431640625+3,153.5-1,0],[462.9236755371094,265.392333984375-3,0], [points170, points171, points172, points173, points174, points175, points176, points177, points178, points180, points181, points182, points183, points184, points185, points186, points187, points188, points189, points190, points191, points192, points193])
createBezierS2([curveInGolgiApparatusPart5, curveExGolgiApparatusPart5], mattLimeGreen);

//-------------------------------------------------------------------GOLGI APPARATUS PART 6--------------------------------------------------------------------------------------------------

var points194 = createControls([[384.4259948730469,172.25936889648438,0],[386.99346923828125,170.63780212402344,0],[390.3717346191406,167.9351806640625,0],[394.29052734375,165.36770629882812,0]], -20)
var points195 = createControls([[387.26373291015625,177.5294647216797,0],[391.5879211425781,174.0160675048828,0],[396.8580017089844,171.17831420898438,0],[401.72271728515625,168.2054443359375,0]], -80)
var points196 = createControls([[397.6687927246094,179.15103149414062,0],[401.72271728515625,176.8538055419922,0],[405.5063781738281,174.69171142578125,0],[409.8305358886719,172.12423706054688,0]], -60)
var points197 = createControls([[406.58740234375,183.34007263183594,0],[410.1007995605469,181.04286193847656,0],[413.07366943359375,179.15103149414062,0],[416.4519348144531,176.7186737060547,0]], +40)
var points198 = createControls([[411.5872497558594,188.20477294921875,0],[414.83038330078125,186.1778106689453,0],[417.8032531738281,184.96163940429688,0],[421.316650390625,182.79954528808594,0]], -100)
var points199 = createControls([[418.8843078613281,199.5557403564453,0],[424.1543884277344,197.52879333496094,0],[428.07318115234375,195.636962890625,0],[430.5055236816406,194.555908203125,0]], -120)
var points200 = createControls([[425.91107177734375,210.77159118652344,0],[429.1542053222656,208.6094970703125,0],[433.2081298828125,207.12306213378906,0],[436.7215270996094,204.42044067382812,0]], -80)
var points201 = createControls([[430.6406555175781,218.87942504882812,0],[434.2891845703125,217.2578582763672,0],[438.7485046386719,215.36602783203125,0],[442.8023986816406,213.3390655517578,0]], +20)
var points202 = createControls([[434.8297119140625,227.52777099609375,0],[438.4782409667969,226.0413360595703,0],[443.6131896972656,223.74412536621094,0],[448.613037109375,222.39280700683594,0]], -80)
var points203 = createControls([[437.1269226074219,235.63560485839844,0],[441.72137451171875,234.2843017578125,0],[448.613037109375,232.39247131347656,0],[452.66693115234375,231.58169555664062,0]], -100)
var points204 = createControls([[437.8025817871094,242.93267822265625,0],[441.04571533203125,242.79754638671875,0],[449.2886657714844,242.12188720703125,0],[454.15338134765625,242.12188720703125,0]], -120)
var points205 = createControls([[437.2620544433594,249.0135498046875,0],[442.2618713378906,248.87841796875,0],[448.072509765625,248.87841796875,0],[452.80206298828125,248.87841796875,0]], +20)
var points206 = createControls([[436.5863952636719,254.2836456298828,0],[439.82952880859375,254.4187774658203,0],[445.64013671875,254.68902587890625,0],[451.9913024902344,254.82415771484375,0]], -80)
var points207 = createControls([[436.9917907714844,258.6078186035156,0],[441.72137451171875,259.2834777832031,0],[445.0996398925781,259.1483459472656,0],[448.3427734375,258.8780822753906,0]], -20)
var curveExGolgiApparatusPart6 = createCurveSurface([386.89324951171875,166.71072387695312+1,0],[441.69775390625,261.9813537597656-2,0], [points194, points195, points196, points197, points198, points199, points200, points201, points202, points203, points204, points205, points206, points207]);
DRAW(COLOR(mattForestGreen)(MAP(curveExGolgiApparatusPart6)(domain3)));


var points208 = createControls([[388.22528076171875,172.60269165039062,0],[389.98199462890625,170.7108612060547,0],[392.4143371582031,169.08929443359375,0],[394.7115478515625,168.0082550048828,0]], -20)
var points209 = createControls([[392.1440734863281,176.3863525390625,0],[394.7115478515625,174.49452209472656,0],[397.2790222167969,172.46755981445312,0],[399.0357360839844,170.9811248779297,0]], -20)
var points210 = createControls([[398.7654724121094,177.06199645996094,0],[400.65728759765625,175.5755615234375,0],[402.14373779296875,174.35939025878906,0],[403.49505615234375,173.41346740722656,0]], -20)
var points211 = createControls([[404.0355529785156,179.08895874023438,0],[405.6571350097656,178.68356323242188,0],[406.4679260253906,177.33226013183594,0],[407.8192138671875,176.65660095214844,0]], -20)
var points212 = createControls([[408.494873046875,182.33209228515625,0],[410.38671875,181.52130126953125,0],[411.7380065917969,180.8456573486328,0],[413.4947204589844,180.3051300048828,0]], -20)
var points213 = createControls([[413.6298522949219,187.19679260253906,0],[415.65679931640625,186.25088500976562,0],[416.73785400390625,185.57522583007812,0],[418.3594055175781,184.89956665039062,0]], -20)
var points214 = createControls([[416.33245849609375,190.43992614746094,0],[417.6837463378906,190.03453063964844,0],[419.3053283691406,189.2237548828125,0],[421.06201171875,188.1427001953125,0]], -20)
var points215 = createControls([[419.9809875488281,196.25054931640625,0],[421.872802734375,195.03436279296875,0],[424.9808044433594,193.8181915283203,0],[425.7915954589844,193.4127960205078,0]], -20)
var points216 = createControls([[423.494384765625,200.57472229003906,0],[424.9808044433594,199.76393127441406,0],[426.8726501464844,198.95315551757812,0],[429.57525634765625,197.8721160888672,0]], -20)
var points217 = createControls([[426.6023864746094,205.57455444335938,0],[428.35906982421875,205.03402709960938,0],[431.0616760253906,203.95298767089844,0],[432.5481262207031,203.41246032714844,0]], -20)
var points218 = createControls([[430.5211486816406,211.65542602539062,0],[433.0886535644531,210.4392547607422,0],[434.98046875,210.0338592529297,0],[436.60205078125,209.08795166015625,0]], -20)
var points219 = createControls([[433.7642822265625,218.00656127929688,0],[436.1966552734375,217.06065368652344,0],[439.1695251464844,216.11473083496094,0],[441.06134033203125,215.303955078125,0]], -20)
var points220 = createControls([[436.60205078125,224.0874481201172,0],[439.5749206542969,223.0063934326172,0],[441.73699951171875,222.19561767578125,0],[444.0342102050781,221.38482666015625,0]], -20)
var points221 = createControls([[439.4397888183594,230.57371520996094,0],[441.46673583984375,230.03318786621094,0],[444.5747375488281,228.8170166015625,0],[447.547607421875,227.87109375,0]], -20)
var points222 = createControls([[440.79107666015625,237.87075805664062,0],[443.4936828613281,237.19509887695312,0],[445.7908935546875,236.7897186279297,0],[449.4394226074219,235.9789276123047,0]], -20)
var points223 = createControls([[440.65594482421875,243.81649780273438,0],[442.9531555175781,243.95162963867188,0],[446.8719482421875,244.08676147460938,0],[449.9799499511719,244.22189331054688,0]], -20)
var points224 = createControls([[439.98028564453125,250.1676483154297,0],[443.0882873535156,250.70816040039062,0],[447.1422119140625,251.24868774414062,0],[449.1691589355469,251.51895141601562,0]], -20)
var points225 = createControls([[439.16949462890625,255.3026123046875,0],[442.4126281738281,255.57286071777344,0],[444.4396057128906,255.97825622558594,0],[446.3314208984375,256.1134033203125,0]], -20)
var curveInGolgiApparatusPart6 = createCurveSurface([389.4247741699219,168.7126007080078+1,0],[442.0910339355469,258.9634094238281-2,0], [points208, points209, points210, points211, points212, points213, points214, points215, points216, points217, points218, points219, points220, points221, points222, points223, points224, points225]);
createBezierS2([curveExGolgiApparatusPart6, curveInGolgiApparatusPart6], mattLimeGreen);




